/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
main.py:105: DeprecationWarning: The SafeConfigParser class has been renamed to ConfigParser in Python 3.2. This alias will be removed in future versions. Use ConfigParser directly instead.
  config_parser = configparser.SafeConfigParser()
All parameters:
	total_epoch==>200
	single_workspace==>False
	w2vfile==>../glove/glove.6B.100d.txt
	mnet_training_dir==>../data/train/
	mnet_training_list==>../data/train/workspace_list
	mnet_dev_dir==>../data/dev/
	mnet_dev_list==>../data/dev/workspace_list
	testing_dir==>../data/test/
	testing_list==>../data/test/workspace_list
	model_string==>dummy
	model_dir==>/dccstor/slad/mingtan/offtopic_paper/outputs/models
	batch_size==>10
	max_length==>40
	emb_size==>100
	encoding==>utf-8
	min_ss_size==>100
	hidden_size==>200
	softmax_factor==>10.0
	learning_rate==>0.001
	remove_target_from_support_set==>True
	dropout_keep_prob==>1.0
	vocabulary==>None
	wordvectors==>None
	offtopic_label==>UNCONFIDENT_INTENT_FROM_SLAD
	sampling_classes==>2
	topk_ss==>0
	layer_num==>1
	enable_batchnorm==>True
	mtl_num_tasks==>0
	filter_size==>3
	ood_threshold==>0.6
	ood_threshold_margin==>0.2
	ood_example_size==>1
	alpha_pos==>1.0
	alpha_neg==>1.0
	alpha_indomain==>1.0
	seed==>3143
Parameters: {
    "total_epoch": 200,
    "single_workspace": false,
    "w2vfile": "../glove/glove.6B.100d.txt",
    "mnet_training_dir": "../data/train/",
    "mnet_training_list": "../data/train/workspace_list",
    "mnet_dev_dir": "../data/dev/",
    "mnet_dev_list": "../data/dev/workspace_list",
    "testing_dir": "../data/test/",
    "testing_list": "../data/test/workspace_list",
    "model_string": "test-run",
    "model_dir": "/dccstor/slad/mingtan/offtopic_paper/outputs/models",
    "batch_size": 10,
    "max_length": 40,
    "emb_size": 100,
    "encoding": "utf-8",
    "min_ss_size": 100,
    "hidden_size": 200,
    "softmax_factor": 10.0,
    "learning_rate": 0.001,
    "remove_target_from_support_set": true,
    "dropout_keep_prob": 1.0,
    "vocabulary": null,
    "wordvectors": null,
    "offtopic_label": "UNCONFIDENT_INTENT_FROM_SLAD",
    "sampling_classes": 2,
    "topk_ss": 0,
    "layer_num": 1,
    "enable_batchnorm": true,
    "mtl_num_tasks": 0,
    "filter_size": 3,
    "ood_threshold": 0.6,
    "ood_threshold_margin": 0.2,
    "ood_example_size": 1,
    "alpha_pos": 1.0,
    "alpha_neg": 1.0,
    "alpha_indomain": 1.0,
    "seed": 3143
}
2021-08-25 19:54:12.371324: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-08-25 19:54:12.387876: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2600000000 Hz
2021-08-25 19:54:12.391416: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55945c00da30 executing computations on platform Host. Devices:
2021-08-25 19:54:12.391461: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2021-08-25 19:54:12.513559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:3b:00.0
totalMemory: 15.90GiB freeMemory: 14.50GiB
2021-08-25 19:54:12.513605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2021-08-25 19:54:12.514604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-08-25 19:54:12.514616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2021-08-25 19:54:12.514623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2021-08-25 19:54:12.515035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14104 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 6.0)
2021-08-25 19:54:12.516845: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55945c749a80 executing computations on platform CUDA. Devices:
2021-08-25 19:54:12.516870: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
get_word_info, params["w2vfile"] -> ../glove/glove.6B.100d.txt
Embed Size 100
Skipped -> 0
wdmap 400000
len(W) 400000
0 words taken from BERT
Time Taken = 0.0035 minutes
After combined with train file
word2idx size: 400789
2021-08-25 19:54:27.023185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2021-08-25 19:54:27.023276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-08-25 19:54:27.023284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2021-08-25 19:54:27.023290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2021-08-25 19:54:27.023757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14104 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 6.0)
WARNING:tensorflow:From /home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/raghab-ankan/code/stream/OOD_IBM/src/model.py:62: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.conv2d instead.
batch norm enabled.

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

g_conv_encoder Tensor("losses/g/truediv:0", shape=(?, 200), dtype=float32)
batch norm enabled.
g_conv_encoder Tensor("losses/g_1/truediv:0", shape=(?, 200), dtype=float32)
batch norm enabled.
g_conv_encoder Tensor("losses/g_2/truediv:0", shape=(?, 200), dtype=float32)
batch norm enabled.
g_conv_encoder Tensor("losses/g_3/truediv:0", shape=(?, 200), dtype=float32)
current_learning_rate 0.001
tf.global_variables()--> <tf.Variable 'W:0' shape=(400789, 100) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/conv1/kernel:0' shape=(3, 1, 100, 200) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/beta:0' shape=(200,) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/gamma:0' shape=(200,) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/moving_mean:0' shape=(200,) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/moving_variance:0' shape=(200,) dtype=float32_ref>
WARNING:tensorflow:From /home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
get_data: 1 	workspace SearchCreativeWork                            train_workspace
get_data: 2 	workspace SearchScreeningEvent                          train_workspace
get_data: 3 	workspace BookRestaurant                                train_workspace
get_data: 4 	workspace GetWeather                                    train_workspace
get_data: 5 	workspace PlayMusic                                     train_workspace
get_data: 6 	workspace AddToPlaylist                                 train_workspace
get_data: 1 	workspace Period4                                       valid_workspace
get_data: 1 	workspace Period4                                       test_workspace
Starting epochs, Total = 200
2021-08-25 19:54:43.168633: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
Epoch    1: avg_loss: 0.410671000679334 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9974305629730225 7.002801120448154e-05 0.42745098039215684 0.42738095238095236

 ../data/dev/Period4.test
	Confusion Matrix
	 [217   0   3  20  31   1 232]
	 [  0  99   8   0  49   4 344]
	 [0 0 0 0 0 0 0]
	 [  5   0   1 261  70   7 160]
	 [  3   1   5  15 276  47 157]
	 [  0   1   8  20 111 180 184]
	 [  5   1   9  14 152  37 292]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.43055556 0.19642857        nan 0.51785714 0.54761905 0.35714286
 0.57254902]
	Accuracy = 0.4372937293729373
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9435    0.4306    0.5913       504
	              BookRestaurant     0.9706    0.1964    0.3267       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7909    0.5179    0.6259       504
	          SearchCreativeWork     0.4006    0.5476    0.4627       504
	        SearchScreeningEvent     0.6522    0.3571    0.4615       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2133    0.5725    0.3108       510
	
	                    accuracy                         0.4373      3030
	                   macro avg     0.5673    0.3746    0.3970      3030
	                weighted avg     0.6609    0.4373    0.4629      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.427, 0.427, 0.427, 0.657, 0.410
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.427, 0.657, 0.410
-----------------------------------------------------------------------------------------
Epoch    2: avg_loss: 0.4094238777955373 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9972963333129883 4.6685340802987696e-05 0.4294117647058823 0.42936507936507934

 ../data/dev/Period4.test
	Confusion Matrix
	 [216   0   2  20  33   1 232]
	 [  0  82  10   0  45   5 362]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 275  67   6 152]
	 [  3   0   6  17 275  52 151]
	 [  0   1   8  29 107 174 185]
	 [  3   0  15  17 149  35 291]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.42857143 0.16269841        nan 0.54563492 0.54563492 0.3452381
 0.57058824]
	Accuracy = 0.43333333333333335
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9558    0.4286    0.5918       504
	              BookRestaurant     0.9880    0.1627    0.2794       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7682    0.5456    0.6381       504
	          SearchCreativeWork     0.4068    0.5456    0.4661       504
	        SearchScreeningEvent     0.6374    0.3452    0.4479       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2119    0.5706    0.3091       510
	
	                    accuracy                         0.4333      3030
	                   macro avg     0.5669    0.3712    0.3903      3030
	                weighted avg     0.6604    0.4333    0.4551      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.429, 0.429, 0.429, 0.658, 0.406
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.429, 0.658, 0.406
-----------------------------------------------------------------------------------------
Epoch    3: avg_loss: 0.4184468686580658 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9968323111534119 0.0004901960784313708 0.42549019607843136 0.425

 ../data/dev/Period4.test
	Confusion Matrix
	 [209   0   2  21  31   0 241]
	 [  0  82   9   0  47   4 362]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 293  58   6 140]
	 [  4   0   5  20 275  48 152]
	 [  0   1   7  38 102 180 176]
	 [  3   0  18  19 145  32 293]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.41468254 0.16269841        nan 0.58134921 0.54563492 0.35714286
 0.5745098 ]
	Accuracy = 0.4396039603960396
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9372    0.4147    0.5750       504
	              BookRestaurant     0.9880    0.1627    0.2794       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7494    0.5813    0.6547       504
	          SearchCreativeWork     0.4179    0.5456    0.4733       504
	        SearchScreeningEvent     0.6667    0.3571    0.4651       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2148    0.5745    0.3127       510
	
	                    accuracy                         0.4396      3030
	                   macro avg     0.5677    0.3766    0.3943      3030
	                weighted avg     0.6614    0.4396    0.4597      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.425, 0.425, 0.425, 0.673, 0.412
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.425, 0.673, 0.412
-----------------------------------------------------------------------------------------
Epoch    4: avg_loss: 0.4086054066816966 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9958972930908203 0.00018674136321195078 0.41568627450980394 0.4158730158730159

 ../data/dev/Period4.test
	Confusion Matrix
	 [213   0   2  16  27   0 246]
	 [  0  90   5   0  49   4 356]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 305  54   6 131]
	 [  3   0   2  23 284  43 149]
	 [  0   1   6  36  99 196 166]
	 [  3   0  20  18 144  27 298]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.42261905 0.17857143        nan 0.60515873 0.56349206 0.38888889
 0.58431373]
	Accuracy = 0.45742574257425744
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9383    0.4226    0.5828       504
	              BookRestaurant     0.9890    0.1786    0.3025       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7663    0.6052    0.6763       504
	          SearchCreativeWork     0.4323    0.5635    0.4892       504
	        SearchScreeningEvent     0.7101    0.3889    0.5026       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2214    0.5843    0.3211       510
	
	                    accuracy                         0.4574      3030
	                   macro avg     0.5796    0.3919    0.4106      3030
	                weighted avg     0.6753    0.4574    0.4788      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.416, 0.416, 0.416, 0.701, 0.432
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.416, 0.701, 0.432
-----------------------------------------------------------------------------------------
Epoch    5: avg_loss: 0.36624489227930707 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9953398704528809 0.00018674136321195078 0.41568627450980394 0.4158730158730159

 ../data/dev/Period4.test
	Confusion Matrix
	 [206   0   2  20  27   0 249]
	 [  0  87   5   0  49   3 360]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 323  45   6 122]
	 [  2   0   2  25 286  35 154]
	 [  0   0   7  46  92 196 163]
	 [  2   0  20  15 149  26 298]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.40873016 0.17261905        nan 0.64087302 0.56746032 0.38888889
 0.58431373]
	Accuracy = 0.46072607260726073
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9450    0.4087    0.5706       504
	              BookRestaurant     1.0000    0.1726    0.2944       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7529    0.6409    0.6924       504
	          SearchCreativeWork     0.4414    0.5675    0.4965       504
	        SearchScreeningEvent     0.7368    0.3889    0.5091       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2214    0.5843    0.3211       510
	
	                    accuracy                         0.4607      3030
	                   macro avg     0.5854    0.3947    0.4120      3030
	                weighted avg     0.6820    0.4607    0.4804      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.416, 0.416, 0.416, 0.711, 0.436
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.416, 0.711, 0.436
-----------------------------------------------------------------------------------------
Epoch    6: avg_loss: 0.37608728806177777 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9949197769165039 9.337068160597539e-05 0.42549019607843136 0.4253968253968254

 ../data/dev/Period4.test
	Confusion Matrix
	 [199   0   2  25  28   0 250]
	 [  0  76   7   0  43   3 375]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 321  46   6 123]
	 [  2   0   2  24 288  35 153]
	 [  0   0   6  41  99 187 171]
	 [  0   0  17  14 161  25 293]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.39484127 0.15079365        nan 0.63690476 0.57142857 0.37103175
 0.5745098 ]
	Accuracy = 0.45016501650165014
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9522    0.3948    0.5582       504
	              BookRestaurant     1.0000    0.1508    0.2621       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7553    0.6369    0.6911       504
	          SearchCreativeWork     0.4331    0.5714    0.4927       504
	        SearchScreeningEvent     0.7305    0.3710    0.4921       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2147    0.5745    0.3125       510
	
	                    accuracy                         0.4502      3030
	                   macro avg     0.5837    0.3856    0.4012      3030
	                weighted avg     0.6800    0.4502    0.4678      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.425, 0.425, 0.425, 0.712, 0.425
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.425, 0.712, 0.425
-----------------------------------------------------------------------------------------
Epoch    7: avg_loss: 0.3786330272754033 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.994287371635437 0.00035014005602246323 0.4294117647058823 0.4297619047619048

 ../data/dev/Period4.test
	Confusion Matrix
	 [197   0   2  27  31   0 247]
	 [  0  53   7   0  43   2 399]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 323  45   5 123]
	 [  2   0   2  24 294  34 148]
	 [  0   0   6  40 104 188 166]
	 [  0   0  13  16 170  20 291]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.39087302 0.10515873        nan 0.64087302 0.58333333 0.37301587
 0.57058824]
	Accuracy = 0.44422442244224425
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9517    0.3909    0.5541       504
	              BookRestaurant     1.0000    0.1052    0.1903       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7512    0.6409    0.6916       504
	          SearchCreativeWork     0.4279    0.5833    0.4937       504
	        SearchScreeningEvent     0.7550    0.3730    0.4993       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2118    0.5706    0.3089       510
	
	                    accuracy                         0.4442      3030
	                   macro avg     0.5854    0.3805    0.3912      3030
	                weighted avg     0.6820    0.4442    0.4561      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.430, 0.429, 0.430, 0.712, 0.419
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.430, 0.712, 0.419
-----------------------------------------------------------------------------------------
Epoch    8: avg_loss: 0.36343572040398914 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9925228357315063 7.002801120448154e-05 0.42745098039215684 0.42738095238095236

 ../data/dev/Period4.test
	Confusion Matrix
	 [202   0   2  26  30   0 244]
	 [  0  55   7   0  40   2 400]
	 [0 0 0 0 0 0 0]
	 [  9   0   0 308  61   3 123]
	 [  3   0   1  21 306  26 147]
	 [  0   0   7  36 102 196 163]
	 [  0   0   8  14 182  14 292]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.40079365 0.10912698        nan 0.61111111 0.60714286 0.38888889
 0.57254902]
	Accuracy = 0.4485148514851485
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9439    0.4008    0.5627       504
	              BookRestaurant     1.0000    0.1091    0.1968       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7605    0.6111    0.6777       504
	          SearchCreativeWork     0.4244    0.6071    0.4996       504
	        SearchScreeningEvent     0.8133    0.3889    0.5262       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2133    0.5725    0.3108       510
	
	                    accuracy                         0.4485      3030
	                   macro avg     0.5936    0.3842    0.3962      3030
	                weighted avg     0.6916    0.4485    0.4620      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.427, 0.427, 0.427, 0.725, 0.423
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.427, 0.725, 0.423
-----------------------------------------------------------------------------------------
Epoch    9: avg_loss: 0.3601650098959605 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9898529648780823 0.0006535947712418277 0.4117647058823529 0.4111111111111111

 ../data/dev/Period4.test
	Confusion Matrix
	 [197   0   2  31  32   0 242]
	 [  0  84   5   0  46   2 367]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 294  78   1 126]
	 [  1   0   1  17 323  19 143]
	 [  0   0   7  29 114 196 158]
	 [  0   0   6   6 186  12 300]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.39087302 0.16666667        nan 0.58333333 0.64087302 0.38888889
 0.58823529]
	Accuracy = 0.46006600660066005
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9704    0.3909    0.5573       504
	              BookRestaurant     1.0000    0.1667    0.2857       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7798    0.5833    0.6674       504
	          SearchCreativeWork     0.4146    0.6409    0.5035       504
	        SearchScreeningEvent     0.8522    0.3889    0.5341       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2246    0.5882    0.3250       510
	
	                    accuracy                         0.4601      3030
	                   macro avg     0.6059    0.3941    0.4104      3030
	                weighted avg     0.7060    0.4601    0.4785      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.411, 0.412, 0.411, 0.727, 0.434
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.411, 0.727, 0.434
-----------------------------------------------------------------------------------------
Epoch   10: avg_loss: 0.3610403885444005 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9877857565879822 0.0 0.4 0.4

 ../data/dev/Period4.test
	Confusion Matrix
	 [217   0   2  29  32   0 224]
	 [  0  90   6   0  42   2 364]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 286  88   0 123]
	 [  1   0   1  17 326  17 142]
	 [  0   0   7  23 122 197 155]
	 [  0   0   6   4 182  12 306]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.43055556 0.17857143        nan 0.56746032 0.6468254  0.39087302
 0.6       ]
	Accuracy = 0.4693069306930693
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9644    0.4306    0.5953       504
	              BookRestaurant     1.0000    0.1786    0.3030       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7967    0.5675    0.6628       504
	          SearchCreativeWork     0.4116    0.6468    0.5031       504
	        SearchScreeningEvent     0.8640    0.3909    0.5383       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2329    0.6000    0.3355       510
	
	                    accuracy                         0.4693      3030
	                   macro avg     0.6099    0.4020    0.4197      3030
	                weighted avg     0.7107    0.4693    0.4894      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.400, 0.400, 0.400, 0.730, 0.443
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.400, 0.730, 0.443
-----------------------------------------------------------------------------------------
Epoch   11: avg_loss: 0.39857521653175354 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.988068699836731 4.6685340802987696e-05 0.403921568627451 0.403968253968254

 ../data/dev/Period4.test
	Confusion Matrix
	 [230   0   1  26  30   0 217]
	 [  0  47   3   0  39   2 413]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 294  89   0 113]
	 [  1   0   1  20 328  17 137]
	 [  0   0   8  20 118 220 138]
	 [  0   0   6   5 182  13 304]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.45634921 0.09325397        nan 0.58333333 0.65079365 0.43650794
 0.59607843]
	Accuracy = 0.46963696369636965
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9623    0.4563    0.6191       504
	              BookRestaurant     1.0000    0.0933    0.1706       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8055    0.5833    0.6766       504
	          SearchCreativeWork     0.4173    0.6508    0.5085       504
	        SearchScreeningEvent     0.8730    0.4365    0.5820       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2300    0.5961    0.3319       510
	
	                    accuracy                         0.4696      3030
	                   macro avg     0.6126    0.4023    0.4127      3030
	                weighted avg     0.7137    0.4696    0.4812      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.404, 0.404, 0.404, 0.737, 0.444
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.404, 0.737, 0.444
-----------------------------------------------------------------------------------------
Epoch   12: avg_loss: 0.376846507191658 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9919145107269287 0.00046685340802987696 0.40588235294117647 0.40634920634920635

 ../data/dev/Period4.test
	Confusion Matrix
	 [228   0   1  32  30   0 213]
	 [  1  30   6   0  37   2 428]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 305  84   0 108]
	 [  3   0   2  21 325  13 140]
	 [  0   0   8  23 119 219 135]
	 [  0   0   7   6 177  17 303]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.45238095 0.05952381        nan 0.60515873 0.64484127 0.43452381
 0.59411765]
	Accuracy = 0.46534653465346537
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9540    0.4524    0.6137       504
	              BookRestaurant     1.0000    0.0595    0.1124       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7881    0.6052    0.6846       504
	          SearchCreativeWork     0.4210    0.6448    0.5094       504
	        SearchScreeningEvent     0.8725    0.4345    0.5801       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2283    0.5941    0.3299       510
	
	                    accuracy                         0.4653      3030
	                   macro avg     0.6091    0.3986    0.4043      3030
	                weighted avg     0.7097    0.4653    0.4714      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.406, 0.406, 0.406, 0.725, 0.439
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.406, 0.725, 0.439
-----------------------------------------------------------------------------------------
Epoch   13: avg_loss: 0.36742612222830456 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.995625376701355 0.00018674136321195078 0.4176470588235294 0.4174603174603175

 ../data/dev/Period4.test
	Confusion Matrix
	 [218   0   1  36  32   0 217]
	 [  1  35   6   0  35   2 425]
	 [0 0 0 0 0 0 0]
	 [  5   0   1 298  85   0 115]
	 [  3   0   2  23 317  16 143]
	 [  0   0   8  31 123 190 152]
	 [  0   0   9   9 174  21 297]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.43253968 0.06944444        nan 0.59126984 0.62896825 0.37698413
 0.58235294]
	Accuracy = 0.4471947194719472
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9604    0.4325    0.5964       504
	              BookRestaurant     1.0000    0.0694    0.1299       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7506    0.5913    0.6615       504
	          SearchCreativeWork     0.4138    0.6290    0.4992       504
	        SearchScreeningEvent     0.8297    0.3770    0.5184       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2202    0.5824    0.3195       510
	
	                    accuracy                         0.4472      3030
	                   macro avg     0.5964    0.3831    0.3893      3030
	                weighted avg     0.6948    0.4472    0.4539      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.417, 0.418, 0.417, 0.708, 0.420
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.417, 0.708, 0.420
-----------------------------------------------------------------------------------------
Epoch   14: avg_loss: 0.3885459005832672 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9960490465164185 0.0009103641456582601 0.4235294117647059 0.4226190476190476

 ../data/dev/Period4.test
	Confusion Matrix
	 [208   0   1  42  28   0 225]
	 [  0  48   6   1  31   2 416]
	 [0 0 0 0 0 0 0]
	 [  4   0   1 292  77   2 128]
	 [  2   0   3  23 312  22 142]
	 [  0   0   8  35 124 183 154]
	 [  0   0   9   9 175  23 294]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.41269841 0.0952381         nan 0.57936508 0.61904762 0.36309524
 0.57647059]
	Accuracy = 0.4412541254125413
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9720    0.4127    0.5794       504
	              BookRestaurant     1.0000    0.0952    0.1739       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7264    0.5794    0.6446       504
	          SearchCreativeWork     0.4177    0.6190    0.4988       504
	        SearchScreeningEvent     0.7888    0.3631    0.4973       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2163    0.5765    0.3146       510
	
	                    accuracy                         0.4413      3030
	                   macro avg     0.5887    0.3780    0.3869      3030
	                weighted avg     0.6859    0.4413    0.4512      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.423, 0.424, 0.423, 0.697, 0.414
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.423, 0.697, 0.414
-----------------------------------------------------------------------------------------
Epoch   15: avg_loss: 0.3442874103784561 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9954962134361267 0.00011671335200746924 0.4235294117647059 0.4234126984126984

 ../data/dev/Period4.test
	Confusion Matrix
	 [203   0   1  39  27   0 234]
	 [  0  51   5   1  29   1 417]
	 [0 0 0 0 0 0 0]
	 [  3   0   1 301  68   3 128]
	 [  1   0   3  24 313  25 138]
	 [  0   0   8  33 124 189 150]
	 [  0   0   9  11 173  23 294]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.40277778 0.10119048        nan 0.59722222 0.62103175 0.375
 0.57647059]
	Accuracy = 0.44587458745874586
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9807    0.4028    0.5710       504
	              BookRestaurant     1.0000    0.1012    0.1838       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7359    0.5972    0.6594       504
	          SearchCreativeWork     0.4264    0.6210    0.5057       504
	        SearchScreeningEvent     0.7842    0.3750    0.5074       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2160    0.5765    0.3143       510
	
	                    accuracy                         0.4459      3030
	                   macro avg     0.5919    0.3820    0.3916      3030
	                weighted avg     0.6896    0.4459    0.4566      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.423, 0.424, 0.423, 0.703, 0.419
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.423, 0.703, 0.419
-----------------------------------------------------------------------------------------
Epoch   16: avg_loss: 0.39742400745550793 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9939333200454712 0.00035014005602246323 0.4294117647058823 0.4297619047619048

 ../data/dev/Period4.test
	Confusion Matrix
	 [189   0   1  39  27   0 248]
	 [  0  51   7   1  27   1 417]
	 [0 0 0 0 0 0 0]
	 [  3   0   1 306  60   3 131]
	 [  0   0   3  24 313  27 137]
	 [  0   0   9  32 128 185 150]
	 [  0   0  13  13 171  22 291]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.375      0.10119048        nan 0.60714286 0.62103175 0.36706349
 0.57058824]
	Accuracy = 0.4405940594059406
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9844    0.3750    0.5431       504
	              BookRestaurant     1.0000    0.1012    0.1838       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7373    0.6071    0.6659       504
	          SearchCreativeWork     0.4311    0.6210    0.5089       504
	        SearchScreeningEvent     0.7773    0.3671    0.4987       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2118    0.5706    0.3089       510
	
	                    accuracy                         0.4406      3030
	                   macro avg     0.5917    0.3774    0.3870      3030
	                weighted avg     0.6894    0.4406    0.4513      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.430, 0.429, 0.430, 0.702, 0.414
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.430, 0.702, 0.414
-----------------------------------------------------------------------------------------
Epoch   17: avg_loss: 0.3581513961156209 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9927913546562195 0.00037348272642390157 0.43137254901960786 0.43174603174603177

 ../data/dev/Period4.test
	Confusion Matrix
	 [182   0   1  40  26   0 255]
	 [  0  50   7   1  25   1 420]
	 [0 0 0 0 0 0 0]
	 [  3   0   1 310  60   2 128]
	 [  0   0   4  25 313  26 136]
	 [  0   0   9  29 130 187 149]
	 [  0   0  17  16 165  22 290]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36111111 0.09920635        nan 0.61507937 0.62103175 0.37103175
 0.56862745]
	Accuracy = 0.4396039603960396
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9838    0.3611    0.5283       504
	              BookRestaurant     1.0000    0.0992    0.1805       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7363    0.6151    0.6703       504
	          SearchCreativeWork     0.4353    0.6210    0.5119       504
	        SearchScreeningEvent     0.7857    0.3710    0.5040       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2104    0.5686    0.3072       510
	
	                    accuracy                         0.4396      3030
	                   macro avg     0.5931    0.3766    0.3860      3030
	                weighted avg     0.6910    0.4396    0.4501      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.432, 0.431, 0.432, 0.703, 0.413
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.432, 0.703, 0.413
-----------------------------------------------------------------------------------------
Epoch   18: avg_loss: 0.3546413779258728 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9895612001419067 0.0 0.43333333333333335 0.43333333333333335

 ../data/dev/Period4.test
	Confusion Matrix
	 [175   0   0  47  28   0 254]
	 [  0  61   6   1  24   1 411]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 299  69   0 134]
	 [  0   0   5  23 321  19 136]
	 [  0   0  12  24 139 172 157]
	 [  0   0  16  14 169  22 289]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.34722222 0.12103175        nan 0.59325397 0.63690476 0.34126984
 0.56666667]
	Accuracy = 0.43465346534653465
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9887    0.3472    0.5140       504
	              BookRestaurant     1.0000    0.1210    0.2159       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7328    0.5933    0.6557       504
	          SearchCreativeWork     0.4280    0.6369    0.5120       504
	        SearchScreeningEvent     0.8037    0.3413    0.4791       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2093    0.5667    0.3057       510
	
	                    accuracy                         0.4347      3030
	                   macro avg     0.5947    0.3723    0.3832      3030
	                weighted avg     0.6928    0.4347    0.4468      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.433, 0.433, 0.433, 0.696, 0.408
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.433, 0.696, 0.408
-----------------------------------------------------------------------------------------
Epoch   19: avg_loss: 0.3862502972284953 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9892733097076416 0.00023342670401493848 0.4137254901960784 0.41349206349206347

 ../data/dev/Period4.test
	Confusion Matrix
	 [211   0   0  54  27   0 212]
	 [  0  97   3   1  24   1 378]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 279  77   4 138]
	 [  1   0   3  22 312  24 142]
	 [  0   0  10  11 142 169 172]
	 [  0   0  12  10 167  22 299]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.41865079 0.19246032        nan 0.55357143 0.61904762 0.33531746
 0.58627451]
	Accuracy = 0.45115511551155113
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9679    0.4187    0.5845       504
	              BookRestaurant     1.0000    0.1925    0.3228       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7401    0.5536    0.6334       504
	          SearchCreativeWork     0.4166    0.6190    0.4980       504
	        SearchScreeningEvent     0.7682    0.3353    0.4669       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2230    0.5863    0.3231       510
	
	                    accuracy                         0.4512      3030
	                   macro avg     0.5879    0.3865    0.4041      3030
	                weighted avg     0.6850    0.4512    0.4711      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.414, 0.414, 0.413, 0.688, 0.424
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.414, 0.688, 0.424
-----------------------------------------------------------------------------------------
Epoch   20: avg_loss: 0.35904989143212634 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9889026880264282 0.0 0.4 0.4

 ../data/dev/Period4.test
	Confusion Matrix
	 [223   0   0  46  24   0 211]
	 [  0 127   3   1  24   3 346]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 276  75   5 143]
	 [  1   0   3  21 311  26 142]
	 [  0   0  10   9 140 179 166]
	 [  0   0  12   8 159  25 306]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.44246032 0.25198413        nan 0.54761905 0.61706349 0.35515873
 0.6       ]
	Accuracy = 0.4693069306930693
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9738    0.4425    0.6085       504
	              BookRestaurant     1.0000    0.2520    0.4025       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7645    0.5476    0.6382       504
	          SearchCreativeWork     0.4243    0.6171    0.5028       504
	        SearchScreeningEvent     0.7521    0.3552    0.4825       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2329    0.6000    0.3355       510
	
	                    accuracy                         0.4693      3030
	                   macro avg     0.5925    0.4020    0.4243      3030
	                weighted avg     0.6904    0.4693    0.4947      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.400, 0.400, 0.400, 0.707, 0.443
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.400, 0.707, 0.443
-----------------------------------------------------------------------------------------
Epoch   21: avg_loss: 0.3503447026014328 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9855464696884155 9.337068160597539e-05 0.39215686274509803 0.39206349206349206

 ../data/dev/Period4.test
	Confusion Matrix
	 [200   0   0  41  22   1 240]
	 [  0 135   2   0  18   3 346]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 273  72  10 146]
	 [  1   0   3  20 300  43 137]
	 [  0   0  11  16 142 216 119]
	 [  0   0  15   8 144  33 310]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.3968254  0.26785714        nan 0.54166667 0.5952381  0.42857143
 0.60784314]
	Accuracy = 0.47326732673267324
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9804    0.3968    0.5650       504
	              BookRestaurant     1.0000    0.2679    0.4225       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7626    0.5417    0.6334       504
	          SearchCreativeWork     0.4298    0.5952    0.4992       504
	        SearchScreeningEvent     0.7059    0.4286    0.5333       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2388    0.6078    0.3429       510
	
	                    accuracy                         0.4733      3030
	                   macro avg     0.5882    0.4054    0.4280      3030
	                weighted avg     0.6854    0.4733    0.4991      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.392, 0.392, 0.392, 0.708, 0.446
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.392, 0.708, 0.446
-----------------------------------------------------------------------------------------
Epoch   22: avg_loss: 0.35443322857220966 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9870954751968384 4.6685340802987696e-05 0.396078431372549 0.396031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [187   0   0  42  19   1 255]
	 [  0 155   3   0  15   4 327]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 262  66  11 161]
	 [  1   0   3  19 299  46 136]
	 [  0   1  10  11 135 228 119]
	 [  0   0  21   8 138  35 308]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.37103175 0.30753968        nan 0.51984127 0.59325397 0.45238095
 0.60392157]
	Accuracy = 0.4749174917491749
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9740    0.3710    0.5374       504
	              BookRestaurant     0.9936    0.3075    0.4697       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7661    0.5198    0.6194       504
	          SearchCreativeWork     0.4449    0.5933    0.5085       504
	        SearchScreeningEvent     0.7015    0.4524    0.5501       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2358    0.6039    0.3392       510
	
	                    accuracy                         0.4749      3030
	                   macro avg     0.5880    0.4069    0.4320      3030
	                weighted avg     0.6851    0.4749    0.5037      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.396, 0.396, 0.396, 0.714, 0.449
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.396, 0.714, 0.449
-----------------------------------------------------------------------------------------
Epoch   23: avg_loss: 0.355052908261617 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9937036037445068 2.3342670401493848e-05 0.3980392156862745 0.398015873015873

 ../data/dev/Period4.test
	Confusion Matrix
	 [180   0   0  33  19   0 272]
	 [  0 205   5   1  22   3 268]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 249  69   4 177]
	 [  1   0   4  16 307  34 142]
	 [  0   0  12   5 125 218 144]
	 [  0   1  24   7 140  31 307]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.35714286 0.40674603        nan 0.49404762 0.60912698 0.43253968
 0.60196078]
	Accuracy = 0.48382838283828383
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9677    0.3571    0.5217       504
	              BookRestaurant     0.9951    0.4067    0.5775       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8006    0.4940    0.6110       504
	          SearchCreativeWork     0.4501    0.6091    0.5177       504
	        SearchScreeningEvent     0.7517    0.4325    0.5491       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2344    0.6020    0.3374       510
	
	                    accuracy                         0.4838      3030
	                   macro avg     0.6000    0.4145    0.4449      3030
	                weighted avg     0.6990    0.4838    0.5187      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.398, 0.398, 0.398, 0.738, 0.460
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.398, 0.738, 0.460
-----------------------------------------------------------------------------------------
Epoch   24: avg_loss: 0.3308175355195999 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9918603897094727 0.00032679738562091387 0.4392156862745098 0.4388888888888889

 ../data/dev/Period4.test
	Confusion Matrix
	 [138   0   1  28  17   0 320]
	 [  0 180   6   0  12   1 305]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 237  71   3 192]
	 [  1   0   4  15 316  25 143]
	 [  0   0  14   7 125 212 146]
	 [  0   0  37  12 147  28 286]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.27380952 0.35714286        nan 0.4702381  0.62698413 0.42063492
 0.56078431]
	Accuracy = 0.4518151815181518
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9857    0.2738    0.4286       504
	              BookRestaurant     1.0000    0.3571    0.5263       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7926    0.4702    0.5903       504
	          SearchCreativeWork     0.4593    0.6270    0.5302       504
	        SearchScreeningEvent     0.7881    0.4206    0.5485       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2055    0.5608    0.3007       510
	
	                    accuracy                         0.4518      3030
	                   macro avg     0.6045    0.3871    0.4178      3030
	                weighted avg     0.7042    0.4518    0.4871      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.439, 0.439, 0.439, 0.737, 0.430
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.439, 0.737, 0.430
-----------------------------------------------------------------------------------------
Epoch   25: avg_loss: 0.33446575701236725 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9911404252052307 0.0003968253968253954 0.43333333333333335 0.43373015873015874

 ../data/dev/Period4.test
	Confusion Matrix
	 [151   0   0  35  22   0 296]
	 [  0  95   5   0   8   0 396]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 275  78   2 147]
	 [  1   0   4  18 330  27 124]
	 [  0   0  13   5 140 216 130]
	 [  0   0  36  10 148  27 289]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.29960317 0.18849206        nan 0.54563492 0.6547619  0.42857143
 0.56666667]
	Accuracy = 0.44752475247524753
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9805    0.2996    0.4590       504
	              BookRestaurant     1.0000    0.1885    0.3172       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8017    0.5456    0.6494       504
	          SearchCreativeWork     0.4545    0.6548    0.5366       504
	        SearchScreeningEvent     0.7941    0.4286    0.5567       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2091    0.5667    0.3055       510
	
	                    accuracy                         0.4475      3030
	                   macro avg     0.6057    0.3834    0.4035      3030
	                weighted avg     0.7057    0.4475    0.4704      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.434, 0.433, 0.434, 0.738, 0.423
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.434, 0.738, 0.423
-----------------------------------------------------------------------------------------
Epoch   26: avg_loss: 0.33495909969011944 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9929475784301758 0.00018674136321195078 0.41568627450980394 0.4158730158730159

 ../data/dev/Period4.test
	Confusion Matrix
	 [190   0   0  39  21   0 254]
	 [  0  70   3   0   9   0 422]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 291  84   2 123]
	 [  1   0   3  18 335  25 122]
	 [  0   0  14   5 150 208 127]
	 [  0   0  27   9 153  23 298]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.37698413 0.13888889        nan 0.57738095 0.66468254 0.41269841
 0.58431373]
	Accuracy = 0.4594059405940594
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9744    0.3770    0.5436       504
	              BookRestaurant     1.0000    0.1389    0.2439       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8039    0.5774    0.6721       504
	          SearchCreativeWork     0.4455    0.6647    0.5334       504
	        SearchScreeningEvent     0.8062    0.4127    0.5459       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2214    0.5843    0.3211       510
	
	                    accuracy                         0.4594      3030
	                   macro avg     0.6073    0.3936    0.4086      3030
	                weighted avg     0.7076    0.4594    0.4764      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.416, 0.416, 0.416, 0.733, 0.434
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.416, 0.733, 0.434
-----------------------------------------------------------------------------------------
Epoch   27: avg_loss: 0.3657758831977844 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9912192225456238 0.00042016806722688926 0.4019607843137255 0.4023809523809524

 ../data/dev/Period4.test
	Confusion Matrix
	 [197   0   0  43  19   0 245]
	 [  0  89   3   0   9   0 403]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 292  85   3 120]
	 [  1   0   3  18 337  27 118]
	 [  0   0  12   5 152 207 128]
	 [  0   0  25   5 151  24 305]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.39087302 0.1765873         nan 0.57936508 0.66865079 0.41071429
 0.59803922]
	Accuracy = 0.47095709570957095
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9752    0.3909    0.5581       504
	              BookRestaurant     1.0000    0.1766    0.3002       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8044    0.5794    0.6736       504
	          SearchCreativeWork     0.4475    0.6687    0.5362       504
	        SearchScreeningEvent     0.7931    0.4107    0.5412       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2312    0.5980    0.3335       510
	
	                    accuracy                         0.4710      3030
	                   macro avg     0.6074    0.4035    0.4204      3030
	                weighted avg     0.7076    0.4710    0.4901      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.402, 0.402, 0.402, 0.731, 0.445
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.402, 0.731, 0.445
-----------------------------------------------------------------------------------------
Epoch   28: avg_loss: 0.3541071762641271 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.988264262676239 7.002801120448154e-05 0.3941176470588235 0.39404761904761904

 ../data/dev/Period4.test
	Confusion Matrix
	 [197   0   0  47  16   0 244]
	 [  0 102   2   0   7   0 393]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 292  90   3 115]
	 [  1   0   3  19 337  28 116]
	 [  0   0  12   4 153 210 125]
	 [  0   0  21   5 150  25 309]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.39087302 0.20238095        nan 0.57936508 0.66865079 0.41666667
 0.60588235]
	Accuracy = 0.4775577557755776
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9752    0.3909    0.5581       504
	              BookRestaurant     1.0000    0.2024    0.3366       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7956    0.5794    0.6705       504
	          SearchCreativeWork     0.4475    0.6687    0.5362       504
	        SearchScreeningEvent     0.7895    0.4167    0.5455       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2373    0.6059    0.3411       510
	
	                    accuracy                         0.4776      3030
	                   macro avg     0.6065    0.4091    0.4268      3030
	                weighted avg     0.7066    0.4776    0.4977      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.394, 0.394, 0.394, 0.735, 0.452
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.394, 0.735, 0.452
-----------------------------------------------------------------------------------------
Epoch   29: avg_loss: 0.33502841492493945 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9859269857406616 0.0007469654528478031 0.396078431372549 0.3968253968253968

 ../data/dev/Period4.test
	Confusion Matrix
	 [183   0   0  39  16   0 266]
	 [  0 168   2   0   6   0 328]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 276  81   3 140]
	 [  1   0   3  16 328  27 129]
	 [  0   0  13   2 152 200 137]
	 [  0   0  25   5 145  27 308]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36309524 0.33333333        nan 0.54761905 0.65079365 0.3968254
 0.60392157]
	Accuracy = 0.48283828382838284
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9734    0.3631    0.5289       504
	              BookRestaurant     1.0000    0.3333    0.5000       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8166    0.5476    0.6556       504
	          SearchCreativeWork     0.4505    0.6508    0.5325       504
	        SearchScreeningEvent     0.7782    0.3968    0.5256       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2355    0.6039    0.3388       510
	
	                    accuracy                         0.4828      3030
	                   macro avg     0.6077    0.4137    0.4402      3030
	                weighted avg     0.7081    0.4828    0.5132      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.397, 0.396, 0.397, 0.736, 0.458
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.397, 0.736, 0.458
-----------------------------------------------------------------------------------------
Epoch   30: avg_loss: 0.3562447528044383 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9881079792976379 9.337068160597539e-05 0.39215686274509803 0.39206349206349206

 ../data/dev/Period4.test
	Confusion Matrix
	 [215   0   0  38  14   0 237]
	 [  0 165   1   0   1   0 337]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 287  74   3 133]
	 [  0   0   3  17 320  31 133]
	 [  0   0  12   2 146 196 148]
	 [  0   0  19   5 146  30 310]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.4265873  0.32738095        nan 0.56944444 0.63492063 0.38888889
 0.60784314]
	Accuracy = 0.49273927392739275
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9685    0.4266    0.5923       504
	              BookRestaurant     1.0000    0.3274    0.4933       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8223    0.5694    0.6729       504
	          SearchCreativeWork     0.4565    0.6349    0.5311       504
	        SearchScreeningEvent     0.7538    0.3889    0.5131       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2388    0.6078    0.3429       510
	
	                    accuracy                         0.4927      3030
	                   macro avg     0.6057    0.4222    0.4494      3030
	                weighted avg     0.7057    0.4927    0.5239      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.392, 0.392, 0.392, 0.743, 0.469
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.392, 0.743, 0.469
-----------------------------------------------------------------------------------------
Epoch   31: avg_loss: 0.3316420093178749 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9870786666870117 0.00011671335200746924 0.40980392156862744 0.4099206349206349

 ../data/dev/Period4.test
	Confusion Matrix
	 [186   0   0  34  11   0 273]
	 [  0 194   1   0   1   0 308]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 275  70   3 152]
	 [  0   0   4  14 312  26 148]
	 [  0   0  16   1 137 198 152]
	 [  0   0  20   5 158  26 301]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36904762 0.38492063        nan 0.54563492 0.61904762 0.39285714
 0.59019608]
	Accuracy = 0.48382838283828383
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9789    0.3690    0.5360       504
	              BookRestaurant     1.0000    0.3849    0.5559       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8359    0.5456    0.6603       504
	          SearchCreativeWork     0.4528    0.6190    0.5231       504
	        SearchScreeningEvent     0.7826    0.3929    0.5231       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2256    0.5902    0.3265       510
	
	                    accuracy                         0.4838      3030
	                   macro avg     0.6108    0.4145    0.4464      3030
	                weighted avg     0.7117    0.4838    0.5204      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.410, 0.410, 0.410, 0.751, 0.462
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.410, 0.751, 0.462
-----------------------------------------------------------------------------------------
Epoch   32: avg_loss: 0.34023450811704 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9822196960449219 0.00030345471521942 0.40784313725490196 0.40753968253968254

 ../data/dev/Period4.test
	Confusion Matrix
	 [170   0   0  34   9   0 291]
	 [  0 185   3   0   0   0 316]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 272  72   3 154]
	 [  0   0   9  14 310  27 144]
	 [  0   0  14   1 148 219 122]
	 [  0   0  25   5 152  26 302]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.33730159 0.36706349        nan 0.53968254 0.61507937 0.43452381
 0.59215686]
	Accuracy = 0.48118811881188117
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9827    0.3373    0.5022       504
	              BookRestaurant     1.0000    0.3671    0.5370       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8344    0.5397    0.6554       504
	          SearchCreativeWork     0.4486    0.6151    0.5188       504
	        SearchScreeningEvent     0.7964    0.4345    0.5623       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2272    0.5922    0.3284       510
	
	                    accuracy                         0.4812      3030
	                   macro avg     0.6127    0.4123    0.4435      3030
	                weighted avg     0.7139    0.4812    0.5170      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.408, 0.408, 0.408, 0.740, 0.459
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.408, 0.740, 0.459
-----------------------------------------------------------------------------------------
Epoch   33: avg_loss: 0.3346196462710698 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9891877174377441 0.0008870214752567662 0.40784313725490196 0.4087301587301587

 ../data/dev/Period4.test
	Confusion Matrix
	 [196   0   0  32  11   0 265]
	 [  0 211   2   0   2   1 288]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 268  69   3 159]
	 [  0   0   6  11 298  30 159]
	 [  0   0  12   1 139 193 159]
	 [  0   0  20   5 157  26 302]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.38888889 0.41865079        nan 0.53174603 0.59126984 0.38293651
 0.59215686]
	Accuracy = 0.4844884488448845
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9751    0.3889    0.5560       504
	              BookRestaurant     1.0000    0.4187    0.5902       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8454    0.5317    0.6529       504
	          SearchCreativeWork     0.4408    0.5913    0.5051       504
	        SearchScreeningEvent     0.7628    0.3829    0.5099       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2267    0.5922    0.3279       510
	
	                    accuracy                         0.4845      3030
	                   macro avg     0.6073    0.4151    0.4489      3030
	                weighted avg     0.7075    0.4845    0.5233      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.409, 0.408, 0.409, 0.750, 0.463
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.409, 0.750, 0.463
-----------------------------------------------------------------------------------------
Epoch   34: avg_loss: 0.34145330886046094 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9938243627548218 0.0009103641456582601 0.40980392156862744 0.4107142857142857

 ../data/dev/Period4.test
	Confusion Matrix
	 [218   0   0  34  12   0 240]
	 [  0 178   1   0   2   0 323]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 273  75   3 146]
	 [  0   0   5  14 306  26 153]
	 [  0   0   8   1 135 187 173]
	 [  0   0  14   5 165  25 301]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.43253968 0.3531746         nan 0.54166667 0.60714286 0.37103175
 0.59019608]
	Accuracy = 0.48283828382838284
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9689    0.4325    0.5981       504
	              BookRestaurant     1.0000    0.3532    0.5220       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8349    0.5417    0.6570       504
	          SearchCreativeWork     0.4403    0.6071    0.5104       504
	        SearchScreeningEvent     0.7759    0.3710    0.5020       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2253    0.5902    0.3261       510
	
	                    accuracy                         0.4828      3030
	                   macro avg     0.6065    0.4137    0.4451      3030
	                weighted avg     0.7066    0.4828    0.5189      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.411, 0.410, 0.411, 0.752, 0.461
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.411, 0.752, 0.461
-----------------------------------------------------------------------------------------
Epoch   35: avg_loss: 0.3306846444805463 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9902999997138977 0.0007703081232493525 0.3980392156862745 0.39880952380952384

 ../data/dev/Period4.test
	Confusion Matrix
	 [239   0   0  37  12   0 216]
	 [  0 137   1   0   1   0 365]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 302  77   3 112]
	 [  0   0   5  20 306  27 146]
	 [  0   0   8   2 149 179 166]
	 [  0   0  12   5 163  23 307]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.47420635 0.2718254         nan 0.59920635 0.60714286 0.35515873
 0.60196078]
	Accuracy = 0.48514851485148514
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9598    0.4742    0.6348       504
	              BookRestaurant     1.0000    0.2718    0.4275       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8251    0.5992    0.6943       504
	          SearchCreativeWork     0.4322    0.6071    0.5050       504
	        SearchScreeningEvent     0.7716    0.3552    0.4864       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2340    0.6020    0.3370       510
	
	                    accuracy                         0.4851      3030
	                   macro avg     0.6032    0.4156    0.4407      3030
	                weighted avg     0.7029    0.4851    0.5138      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.399, 0.398, 0.399, 0.744, 0.462
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.399, 0.744, 0.462
-----------------------------------------------------------------------------------------
Epoch   36: avg_loss: 0.34494152168432873 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9865411520004272 9.337068160597539e-05 0.40784313725490196 0.40793650793650793

 ../data/dev/Period4.test
	Confusion Matrix
	 [186   0   0  37  12   0 269]
	 [  0 105   1   0   1   1 396]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 306  80   3 111]
	 [  0   0   6  22 316  33 127]
	 [  0   0   9   3 160 207 125]
	 [  0   0  16   6 160  26 302]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36904762 0.20833333        nan 0.60714286 0.62698413 0.41071429
 0.59215686]
	Accuracy = 0.4693069306930693
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9789    0.3690    0.5360       504
	              BookRestaurant     1.0000    0.2083    0.3448       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8182    0.6071    0.6970       504
	          SearchCreativeWork     0.4335    0.6270    0.5126       504
	        SearchScreeningEvent     0.7667    0.4107    0.5349       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2271    0.5922    0.3283       510
	
	                    accuracy                         0.4693      3030
	                   macro avg     0.6035    0.4021    0.4219      3030
	                weighted avg     0.7031    0.4693    0.4919      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.408, 0.408, 0.408, 0.735, 0.444
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.408, 0.735, 0.444
-----------------------------------------------------------------------------------------
Epoch   37: avg_loss: 0.3013013998667399 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9879651069641113 4.6685340802987696e-05 0.396078431372549 0.396031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [231   0   0  43   9   0 221]
	 [  0  99   1   0   1   0 403]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 306  88   3  96]
	 [  0   0   4  24 313  32 131]
	 [  0   0   8   3 165 181 147]
	 [  0   0   9   5 160  28 308]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.45833333 0.19642857        nan 0.60714286 0.62103175 0.35912698
 0.60392157]
	Accuracy = 0.4745874587458746
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9545    0.4583    0.6193       504
	              BookRestaurant     1.0000    0.1964    0.3284       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8031    0.6071    0.6915       504
	          SearchCreativeWork     0.4253    0.6210    0.5048       504
	        SearchScreeningEvent     0.7418    0.3591    0.4840       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2358    0.6039    0.3392       510
	
	                    accuracy                         0.4746      3030
	                   macro avg     0.5944    0.4066    0.4239      3030
	                weighted avg     0.6925    0.4746    0.4942      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.396, 0.396, 0.396, 0.723, 0.448
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.396, 0.723, 0.448
-----------------------------------------------------------------------------------------
Epoch   38: avg_loss: 0.32683423658212024 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.988050103187561 0.0009570494864612478 0.3803921568627451 0.3813492063492063

 ../data/dev/Period4.test
	Confusion Matrix
	 [222   0   0  39   8   0 235]
	 [  0 189   3   0   2   1 309]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 298  69   3 124]
	 [  0   0   4  22 300  40 138]
	 [  0   0   6   2 154 187 155]
	 [  0   0   9   5 149  31 316]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.44047619 0.375             nan 0.59126984 0.5952381  0.37103175
 0.61960784]
	Accuracy = 0.499009900990099
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9569    0.4405    0.6033       504
	              BookRestaurant     1.0000    0.3750    0.5455       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8142    0.5913    0.6851       504
	          SearchCreativeWork     0.4399    0.5952    0.5059       504
	        SearchScreeningEvent     0.7137    0.3710    0.4883       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2475    0.6196    0.3537       510
	
	                    accuracy                         0.4990      3030
	                   macro avg     0.5960    0.4275    0.4545      3030
	                weighted avg     0.6945    0.4990    0.5299      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.381, 0.380, 0.381, 0.734, 0.475
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.381, 0.734, 0.475
-----------------------------------------------------------------------------------------
Epoch   39: avg_loss: 0.3194676339626312 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9859941005706787 0.0006535947712418277 0.35490196078431374 0.35555555555555557

 ../data/dev/Period4.test
	Confusion Matrix
	 [241   0   0  39   9   0 215]
	 [  0 242   1   0   1   0 260]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 305  65   1 122]
	 [  0   0   4  24 293  40 143]
	 [  0   0   5   2 148 193 156]
	 [  0   1   7   5 137  31 329]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.4781746  0.48015873        nan 0.60515873 0.58134921 0.38293651
 0.64509804]
	Accuracy = 0.529042904290429
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9563    0.4782    0.6376       504
	              BookRestaurant     0.9959    0.4802    0.6479       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8133    0.6052    0.6940       504
	          SearchCreativeWork     0.4487    0.5813    0.5065       504
	        SearchScreeningEvent     0.7283    0.3829    0.5020       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2686    0.6451    0.3793       510
	
	                    accuracy                         0.5290      3030
	                   macro avg     0.6016    0.4533    0.4810      3030
	                weighted avg     0.7010    0.5290    0.5608      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.355, 0.355, 0.356, 0.747, 0.506
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.355, 0.747, 0.506
-----------------------------------------------------------------------------------------
Epoch   40: avg_loss: 0.31829192737738293 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.985184907913208 4.6685340802987696e-05 0.3627450980392157 0.3626984126984127

 ../data/dev/Period4.test
	Confusion Matrix
	 [187   0   0  30   7   0 280]
	 [  0 279   1   0   1   1 222]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 280  68   1 150]
	 [  0   0   4  18 299  45 138]
	 [  0   0   6   0 138 236 124]
	 [  0   4   9   5 132  35 325]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.37103175 0.55357143        nan 0.55555556 0.59325397 0.46825397
 0.6372549 ]
	Accuracy = 0.53003300330033
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9740    0.3710    0.5374       504
	              BookRestaurant     0.9859    0.5536    0.7090       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8408    0.5556    0.6691       504
	          SearchCreativeWork     0.4636    0.5933    0.5205       504
	        SearchScreeningEvent     0.7421    0.4683    0.5742       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2623    0.6373    0.3716       510
	
	                    accuracy                         0.5300      3030
	                   macro avg     0.6098    0.4541    0.4831      3030
	                weighted avg     0.7106    0.5300    0.5632      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.363, 0.363, 0.363, 0.762, 0.508
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.363, 0.762, 0.508
-----------------------------------------------------------------------------------------
Epoch   41: avg_loss: 0.27741147577762604 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9851226806640625 0.0007936507936507908 0.4 0.39920634920634923

 ../data/dev/Period4.test
	Confusion Matrix
	 [135   0   0  23   6   0 340]
	 [  0 222   2   0   0   0 280]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 276  79   2 146]
	 [  0   0   8  19 305  48 124]
	 [  0   0   6   0 151 231 116]
	 [  0   1  23   5 139  36 306]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.26785714 0.44047619        nan 0.54761905 0.60515873 0.45833333
 0.6       ]
	Accuracy = 0.4867986798679868
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9926    0.2679    0.4219       504
	              BookRestaurant     0.9955    0.4405    0.6107       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8545    0.5476    0.6675       504
	          SearchCreativeWork     0.4485    0.6052    0.5152       504
	        SearchScreeningEvent     0.7287    0.4583    0.5627       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2332    0.6000    0.3359       510
	
	                    accuracy                         0.4868      3030
	                   macro avg     0.6076    0.4171    0.4448      3030
	                weighted avg     0.7079    0.4868    0.5186      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.399, 0.400, 0.399, 0.746, 0.464
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.399, 0.746, 0.464
-----------------------------------------------------------------------------------------
Epoch   42: avg_loss: 0.3193401942650477 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9876499176025391 0.0007002801120448154 0.40784313725490196 0.40714285714285714

 ../data/dev/Period4.test
	Confusion Matrix
	 [169   0   0  32  10   0 293]
	 [  0 128   3   0   0   0 373]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 293  93   2 114]
	 [  0   0   8  21 318  41 116]
	 [  0   0   7   1 150 216 130]
	 [  0   0  24   7 148  29 302]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.33531746 0.25396825        nan 0.58134921 0.63095238 0.42857143
 0.59215686]
	Accuracy = 0.47062706270627064
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9883    0.3353    0.5007       504
	              BookRestaurant     1.0000    0.2540    0.4051       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8277    0.5813    0.6830       504
	          SearchCreativeWork     0.4423    0.6310    0.5200       504
	        SearchScreeningEvent     0.7500    0.4286    0.5455       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2274    0.5922    0.3286       510
	
	                    accuracy                         0.4706      3030
	                   macro avg     0.6051    0.4032    0.4261      3030
	                weighted avg     0.7050    0.4706    0.4968      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.407, 0.408, 0.407, 0.742, 0.446
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.407, 0.742, 0.446
-----------------------------------------------------------------------------------------
Epoch   43: avg_loss: 0.2932460804780324 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9877205491065979 0.00046685340802987696 0.3941176470588235 0.39365079365079364

 ../data/dev/Period4.test
	Confusion Matrix
	 [181   0   0  33   7   0 283]
	 [  0 177   3   0   0   0 324]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 275 104   1 121]
	 [  0   0   8  21 317  33 125]
	 [  0   0   7   0 154 204 139]
	 [  0   0  16   6 148  31 309]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.35912698 0.35119048        nan 0.54563492 0.62896825 0.4047619
 0.60588235]
	Accuracy = 0.48283828382838284
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9837    0.3591    0.5262       504
	              BookRestaurant     1.0000    0.3512    0.5198       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8209    0.5456    0.6555       504
	          SearchCreativeWork     0.4342    0.6290    0.5138       504
	        SearchScreeningEvent     0.7584    0.4048    0.5278       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2375    0.6059    0.3412       510
	
	                    accuracy                         0.4828      3030
	                   macro avg     0.6050    0.4137    0.4406      3030
	                weighted avg     0.7049    0.4828    0.5137      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.394, 0.394, 0.394, 0.741, 0.458
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.394, 0.741, 0.458
-----------------------------------------------------------------------------------------
Epoch   44: avg_loss: 0.29157086461782455 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9849317073822021 0.00023342670401493848 0.34705882352941175 0.3468253968253968

 ../data/dev/Period4.test
	Confusion Matrix
	 [234   0   0  37   7   0 226]
	 [  0 201   3   0   0   1 299]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 296 104   1  93]
	 [  0   0   7  23 321  34 119]
	 [  0   0   8   0 151 208 137]
	 [  0   0  14   6 127  30 333]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.46428571 0.39880952        nan 0.58730159 0.63690476 0.41269841
 0.65294118]
	Accuracy = 0.5257425742574258
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9590    0.4643    0.6257       504
	              BookRestaurant     1.0000    0.3988    0.5702       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8177    0.5873    0.6836       504
	          SearchCreativeWork     0.4521    0.6369    0.5288       504
	        SearchScreeningEvent     0.7591    0.4127    0.5347       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2759    0.6529    0.3879       510
	
	                    accuracy                         0.5257      3030
	                   macro avg     0.6091    0.4504    0.4758      3030
	                weighted avg     0.7098    0.5257    0.5548      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.347, 0.347, 0.347, 0.748, 0.500
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.347, 0.748, 0.500
-----------------------------------------------------------------------------------------
Epoch   45: avg_loss: 0.311474251250426 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9854050874710083 0.00021008403361344463 0.34901960784313724 0.3488095238095238

 ../data/dev/Period4.test
	Confusion Matrix
	 [285   0   0  47   7   0 165]
	 [  0 105   1   0   0   1 397]
	 [0 0 0 0 0 0 0]
	 [ 13   0   0 327 101   1  62]
	 [  0   0   2  33 323  30 116]
	 [  0   0   3   2 161 199 139]
	 [  0   0   3  14 135  26 332]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.56547619 0.20833333        nan 0.64880952 0.64087302 0.39484127
 0.65098039]
	Accuracy = 0.5184818481848185
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9564    0.5655    0.7107       504
	              BookRestaurant     1.0000    0.2083    0.3448       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7730    0.6488    0.7055       504
	          SearchCreativeWork     0.4443    0.6409    0.5248       504
	        SearchScreeningEvent     0.7743    0.3948    0.5230       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2742    0.6510    0.3858       510
	
	                    accuracy                         0.5185      3030
	                   macro avg     0.6032    0.4442    0.4564      3030
	                weighted avg     0.7028    0.5185    0.5322      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.349, 0.349, 0.349, 0.748, 0.492
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.349, 0.748, 0.492
-----------------------------------------------------------------------------------------
Epoch   46: avg_loss: 0.3090827738245328 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9880824685096741 0.0001400560224089631 0.31176470588235294 0.3119047619047619

 ../data/dev/Period4.test
	Confusion Matrix
	 [267   0   0  36   5   0 196]
	 [  0 273   3   0   0   1 227]
	 [0 0 0 0 0 0 0]
	 [ 12   0   0 306  93   1  92]
	 [  0   0   3  27 307  42 125]
	 [  0   0   3   1 145 209 146]
	 [  0   2   5  10 107  35 351]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.5297619  0.54166667        nan 0.60714286 0.60912698 0.41468254
 0.68823529]
	Accuracy = 0.5653465346534653
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9570    0.5298    0.6820       504
	              BookRestaurant     0.9927    0.5417    0.7009       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8053    0.6071    0.6923       504
	          SearchCreativeWork     0.4673    0.6091    0.5289       504
	        SearchScreeningEvent     0.7257    0.4147    0.5278       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3087    0.6882    0.4262       510
	
	                    accuracy                         0.5653      3030
	                   macro avg     0.6081    0.4844    0.5083      3030
	                weighted avg     0.7086    0.5653    0.5927      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.312, 0.312, 0.312, 0.751, 0.540
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.312, 0.751, 0.540
-----------------------------------------------------------------------------------------
Epoch   47: avg_loss: 0.3021213213602702 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9854370355606079 0.00037348272642390157 0.2980392156862745 0.2984126984126984

 ../data/dev/Period4.test
	Confusion Matrix
	 [300   0   0  36   4   0 164]
	 [  0 291   1   0   0   1 211]
	 [0 0 0 0 0 0 0]
	 [ 12   0   0 315  86   1  90]
	 [  1   0   3  29 300  43 128]
	 [  0   0   2   1 140 202 159]
	 [  0   2   3  11 101  35 358]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.5952381  0.57738095        nan 0.625      0.5952381  0.40079365
 0.70196078]
	Accuracy = 0.5828382838283829
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9585    0.5952    0.7344       504
	              BookRestaurant     0.9932    0.5774    0.7302       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8036    0.6250    0.7031       504
	          SearchCreativeWork     0.4754    0.5952    0.5286       504
	        SearchScreeningEvent     0.7163    0.4008    0.5140       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3225    0.7020    0.4420       510
	
	                    accuracy                         0.5828      3030
	                   macro avg     0.6099    0.4994    0.5218      3030
	                weighted avg     0.7108    0.5828    0.6084      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.298, 0.298, 0.298, 0.762, 0.559
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.298, 0.762, 0.559
-----------------------------------------------------------------------------------------
Epoch   48: avg_loss: 0.3069063226381938 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.98185795545578 0.0008169934640522847 0.30196078431372547 0.30277777777777776

 ../data/dev/Period4.test
	Confusion Matrix
	 [321   0   0  40   4   0 139]
	 [  0 225   1   0   0   1 277]
	 [0 0 0 0 0 0 0]
	 [ 14   0   0 329  91   1  69]
	 [  1   0   2  32 317  34 118]
	 [  0   0   3   2 151 188 160]
	 [  0   0   3  11 111  29 356]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.63690476 0.44642857        nan 0.65277778 0.62896825 0.37301587
 0.69803922]
	Accuracy = 0.572937293729373
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9554    0.6369    0.7643       504
	              BookRestaurant     1.0000    0.4464    0.6173       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7947    0.6528    0.7168       504
	          SearchCreativeWork     0.4703    0.6290    0.5382       504
	        SearchScreeningEvent     0.7431    0.3730    0.4967       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3181    0.6980    0.4371       510
	
	                    accuracy                         0.5729      3030
	                   macro avg     0.6117    0.4909    0.5100      3030
	                weighted avg     0.7128    0.5729    0.5947      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.303, 0.302, 0.303, 0.758, 0.548
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.303, 0.758, 0.548
-----------------------------------------------------------------------------------------
Epoch   49: avg_loss: 0.2712530493736267 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9785344004631042 0.00023342670401493848 0.3137254901960784 0.3134920634920635

 ../data/dev/Period4.test
	Confusion Matrix
	 [298   0   0  39   4   0 163]
	 [  0 238   1   0   0   1 264]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 306  98   1  89]
	 [  0   0   2  31 324  28 119]
	 [  0   0   4   1 148 196 155]
	 [  0   0   4  11 116  29 350]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.59126984 0.47222222        nan 0.60714286 0.64285714 0.38888889
 0.68627451]
	Accuracy = 0.565016501650165
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9675    0.5913    0.7340       504
	              BookRestaurant     1.0000    0.4722    0.6415       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7887    0.6071    0.6861       504
	          SearchCreativeWork     0.4696    0.6429    0.5427       504
	        SearchScreeningEvent     0.7686    0.3889    0.5165       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3070    0.6863    0.4242       510
	
	                    accuracy                         0.5650      3030
	                   macro avg     0.6145    0.4841    0.5064      3030
	                weighted avg     0.7161    0.5650    0.5905      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.314, 0.314, 0.313, 0.763, 0.540
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.314, 0.763, 0.540
-----------------------------------------------------------------------------------------
Epoch   50: avg_loss: 0.3022288978099823 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9773969054222107 0.0009103641456582601 0.30980392156862746 0.3107142857142857

 ../data/dev/Period4.test
	Confusion Matrix
	 [307   0   0  35   5   0 157]
	 [  0 251   1   0   0   1 251]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 314  88   1  91]
	 [  0   0   5  30 318  25 126]
	 [  0   0   5   1 138 202 158]
	 [  0   0   5   8 119  26 352]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.60912698 0.49801587        nan 0.62301587 0.63095238 0.40079365
 0.69019608]
	Accuracy = 0.5755775577557756
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9685    0.6091    0.7479       504
	              BookRestaurant     1.0000    0.4980    0.6649       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8093    0.6230    0.7040       504
	          SearchCreativeWork     0.4760    0.6310    0.5427       504
	        SearchScreeningEvent     0.7922    0.4008    0.5323       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3101    0.6902    0.4280       510
	
	                    accuracy                         0.5756      3030
	                   macro avg     0.6223    0.4932    0.5171      3030
	                weighted avg     0.7252    0.5756    0.6029      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.311, 0.310, 0.311, 0.781, 0.552
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.311, 0.781, 0.552
-----------------------------------------------------------------------------------------
Epoch   51: avg_loss: 0.27678997566302616 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9784948825836182 7.002801120448154e-05 0.3058823529411765 0.305952380952381

 ../data/dev/Period4.test
	Confusion Matrix
	 [329   0   0  41   2   0 132]
	 [  0 155   0   0   0   0 349]
	 [0 0 0 0 0 0 0]
	 [ 13   0   0 359  75   1  56]
	 [  0   0   2  36 326  30 110]
	 [  0   0   3   1 147 229 124]
	 [  0   0   2  13 112  29 354]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.65277778 0.30753968        nan 0.71230159 0.6468254  0.45436508
 0.69411765]
	Accuracy = 0.5782178217821782
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9620    0.6528    0.7778       504
	              BookRestaurant     1.0000    0.3075    0.4704       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7978    0.7123    0.7526       504
	          SearchCreativeWork     0.4924    0.6468    0.5592       504
	        SearchScreeningEvent     0.7924    0.4544    0.5776       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3147    0.6941    0.4330       510
	
	                    accuracy                         0.5782      3030
	                   macro avg     0.6228    0.4954    0.5101      3030
	                weighted avg     0.7257    0.5782    0.5948      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.306, 0.306, 0.306, 0.787, 0.555
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.306, 0.787, 0.555
-----------------------------------------------------------------------------------------
Epoch   52: avg_loss: 0.3047990600268046 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9929428696632385 2.3342670401493848e-05 0.3686274509803922 0.3686507936507937

 ../data/dev/Period4.test
	Confusion Matrix
	 [287   0   0  45   1   0 171]
	 [  0   5   1   0   1   1 496]
	 [0 0 0 0 0 0 0]
	 [ 12   0   0 359  76   1  56]
	 [  0   0   2  32 354  24  92]
	 [  0   0   3   1 142 244 114]
	 [  0   0   3  14 148  23 322]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.56944444 0.00992063        nan 0.71230159 0.70238095 0.48412698
 0.63137255]
	Accuracy = 0.5184818481848185
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9599    0.5694    0.7148       504
	              BookRestaurant     1.0000    0.0099    0.0196       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7960    0.7123    0.7518       504
	          SearchCreativeWork     0.4903    0.7024    0.5775       504
	        SearchScreeningEvent     0.8328    0.4841    0.6123       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2574    0.6314    0.3657       510
	
	                    accuracy                         0.5185      3030
	                   macro avg     0.6195    0.4442    0.4345      3030
	                weighted avg     0.7218    0.5185    0.5067      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.369, 0.369, 0.369, 0.784, 0.496
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.369, 0.784, 0.496
-----------------------------------------------------------------------------------------
Epoch   53: avg_loss: 0.30184367795785266 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9924459457397461 0.0005135387488328647 0.3568627450980392 0.35634920634920636

 ../data/dev/Period4.test
	Confusion Matrix
	 [270   0   0  43   2   0 189]
	 [  0  70   0   0   0   0 434]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 334  89   1  69]
	 [  0   0   3  37 342  30  92]
	 [  0   0   5   1 156 228 114]
	 [  0   0   3  12 137  30 328]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53571429 0.13888889        nan 0.66269841 0.67857143 0.45238095
 0.64313725]
	Accuracy = 0.5188118811881188
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9609    0.5357    0.6879       504
	              BookRestaurant     1.0000    0.1389    0.2439       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7822    0.6627    0.7175       504
	          SearchCreativeWork     0.4711    0.6786    0.5561       504
	        SearchScreeningEvent     0.7889    0.4524    0.5750       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2675    0.6431    0.3779       510
	
	                    accuracy                         0.5188      3030
	                   macro avg     0.6101    0.4445    0.4512      3030
	                weighted avg     0.7109    0.5188    0.5261      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.356, 0.357, 0.356, 0.774, 0.494
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.356, 0.774, 0.494
-----------------------------------------------------------------------------------------
Epoch   54: avg_loss: 0.28359901905059814 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9870717525482178 9.337068160597539e-05 0.3411764705882353 0.3412698412698413

 ../data/dev/Period4.test
	Confusion Matrix
	 [272   0   0  40   1   0 191]
	 [  0 123   0   0   0   0 381]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 341  80   1  71]
	 [  0   0   2  34 342  28  98]
	 [  0   0   4   1 161 219 119]
	 [  0   0   3  13 128  30 336]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53968254 0.24404762        nan 0.6765873  0.67857143 0.43452381
 0.65882353]
	Accuracy = 0.5389438943894389
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9611    0.5397    0.6912       504
	              BookRestaurant     1.0000    0.2440    0.3923       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.7949    0.6766    0.7310       504
	          SearchCreativeWork     0.4803    0.6786    0.5625       504
	        SearchScreeningEvent     0.7878    0.4345    0.5601       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2809    0.6588    0.3939       510
	
	                    accuracy                         0.5389      3030
	                   macro avg     0.6150    0.4617    0.4759      3030
	                weighted avg     0.7166    0.5389    0.5549      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.341, 0.341, 0.341, 0.777, 0.515
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.341, 0.777, 0.515
-----------------------------------------------------------------------------------------
Epoch   55: avg_loss: 0.3051660905281703 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9925214052200317 9.337068160597539e-05 0.3588235294117647 0.35873015873015873

 ../data/dev/Period4.test
	Confusion Matrix
	 [236   0   0  32   1   0 235]
	 [  0 134   1   0   0   1 368]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 326  86   1  83]
	 [  0   0   5  32 336  32  99]
	 [  0   0   8   0 160 217 119]
	 [  0   0   7  10 130  36 327]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.46825397 0.26587302        nan 0.6468254  0.66666667 0.43055556
 0.64117647]
	Accuracy = 0.5201320132013202
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9672    0.4683    0.6310       504
	              BookRestaurant     1.0000    0.2659    0.4201       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8150    0.6468    0.7212       504
	          SearchCreativeWork     0.4712    0.6667    0.5522       504
	        SearchScreeningEvent     0.7561    0.4306    0.5487       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2656    0.6412    0.3756       510
	
	                    accuracy                         0.5201      3030
	                   macro avg     0.6107    0.4456    0.4641      3030
	                weighted avg     0.7116    0.5201    0.5411      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.359, 0.359, 0.359, 0.776, 0.496
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.359, 0.776, 0.496
-----------------------------------------------------------------------------------------
Epoch   56: avg_loss: 0.29957569638888043 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9910097122192383 0.00018674136321195078 0.3509803921568627 0.35079365079365077

 ../data/dev/Period4.test
	Confusion Matrix
	 [237   0   0  26   1   0 240]
	 [  0 183   1   0   0   0 320]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 320  88   1  88]
	 [  0   0   3  31 326  38 106]
	 [  0   0   6   0 155 213 130]
	 [  0   0   4  10 128  37 331]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.4702381  0.36309524        nan 0.63492063 0.6468254  0.42261905
 0.64901961]
	Accuracy = 0.5313531353135313
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9713    0.4702    0.6337       504
	              BookRestaurant     1.0000    0.3631    0.5328       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8269    0.6349    0.7183       504
	          SearchCreativeWork     0.4670    0.6468    0.5424       504
	        SearchScreeningEvent     0.7370    0.4226    0.5372       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2724    0.6490    0.3838       510
	
	                    accuracy                         0.5314      3030
	                   macro avg     0.6107    0.4552    0.4783      3030
	                weighted avg     0.7116    0.5314    0.5577      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.351, 0.351, 0.351, 0.777, 0.508
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.351, 0.777, 0.508
-----------------------------------------------------------------------------------------
Epoch   57: avg_loss: 0.26587237666050595 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9847986698150635 2.3342670401493848e-05 0.3352941176470588 0.3353174603174603

 ../data/dev/Period4.test
	Confusion Matrix
	 [212   0   0  14   1   0 277]
	 [  0 311   1   0   0   1 191]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 276  92   1 132]
	 [  0   0   3  27 311  41 122]
	 [  0   0   6   0 138 237 123]
	 [  0   0   3   6 121  41 339]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.42063492 0.61706349        nan 0.54761905 0.61706349 0.4702381
 0.66470588]
	Accuracy = 0.5564356435643565
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9860    0.4206    0.5897       504
	              BookRestaurant     1.0000    0.6171    0.7632       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8545    0.5476    0.6675       504
	          SearchCreativeWork     0.4691    0.6171    0.5330       504
	        SearchScreeningEvent     0.7383    0.4702    0.5745       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2863    0.6647    0.4002       510
	
	                    accuracy                         0.5564      3030
	                   macro avg     0.6192    0.4768    0.5040      3030
	                weighted avg     0.7215    0.5564    0.5877      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.335, 0.335, 0.335, 0.784, 0.535
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.335, 0.784, 0.535
-----------------------------------------------------------------------------------------
Epoch   58: avg_loss: 0.26908231029907864 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9805313348770142 0.00021008403361344463 0.3156862745098039 0.31547619047619047

 ../data/dev/Period4.test
	Confusion Matrix
	 [202   0   0   7   1   0 294]
	 [  0 386   1   0   0   0 117]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 255 100   1 146]
	 [  0   0   2  22 304  46 130]
	 [  0   0   5   0 124 267 108]
	 [  0   1   3   4 103  50 349]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.40079365 0.76587302        nan 0.50595238 0.6031746  0.5297619
 0.68431373]
	Accuracy = 0.5818481848184819
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9902    0.4008    0.5706       504
	              BookRestaurant     0.9974    0.7659    0.8664       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8854    0.5060    0.6439       504
	          SearchCreativeWork     0.4810    0.6032    0.5352       504
	        SearchScreeningEvent     0.7335    0.5298    0.6152       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3051    0.6843    0.4220       510
	
	                    accuracy                         0.5818      3030
	                   macro avg     0.6275    0.4986    0.5219      3030
	                weighted avg     0.7313    0.5818    0.6085      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.316, 0.316, 0.315, 0.792, 0.561
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.316, 0.792, 0.561
-----------------------------------------------------------------------------------------
Epoch   59: avg_loss: 0.2695330927769343 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9887816905975342 2.3342670401493848e-05 0.36470588235294116 0.36468253968253966

 ../data/dev/Period4.test
	Confusion Matrix
	 [247   0   0  32   1   0 224]
	 [  0 107   0   0   0   0 397]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 340  77   1  80]
	 [  0   0   1  40 331  38  94]
	 [  0   0   1   0 158 221 124]
	 [  0   0   0  11 133  42 324]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.49007937 0.21230159        nan 0.67460317 0.65674603 0.43849206
 0.63529412]
	Accuracy = 0.5181518151815182
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9763    0.4901    0.6526       504
	              BookRestaurant     1.0000    0.2123    0.3502       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8038    0.6746    0.7335       504
	          SearchCreativeWork     0.4729    0.6567    0.5498       504
	        SearchScreeningEvent     0.7318    0.4385    0.5484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2607    0.6353    0.3697       510
	
	                    accuracy                         0.5182      3030
	                   macro avg     0.6065    0.4439    0.4577      3030
	                weighted avg     0.7067    0.5182    0.5337      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.365, 0.365, 0.365, 0.780, 0.494
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.365, 0.780, 0.494
-----------------------------------------------------------------------------------------
Epoch   60: avg_loss: 0.2990049247940381 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9919995665550232 0.00030345471521942 0.3588235294117647 0.35912698412698413

 ../data/dev/Period4.test
	Confusion Matrix
	 [292   0   0  28   1   0 183]
	 [  0 121   0   0   0   0 383]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 358  59   1  78]
	 [  0   0   1  42 323  36 102]
	 [  0   0   0   0 143 202 159]
	 [  0   0   0  10 136  37 327]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.57936508 0.24007937        nan 0.71031746 0.64087302 0.40079365
 0.64117647]
	Accuracy = 0.5356435643564357
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9733    0.5794    0.7264       504
	              BookRestaurant     1.0000    0.2401    0.3872       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8174    0.7103    0.7601       504
	          SearchCreativeWork     0.4879    0.6409    0.5540       504
	        SearchScreeningEvent     0.7319    0.4008    0.5179       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2654    0.6412    0.3754       510
	
	                    accuracy                         0.5356      3030
	                   macro avg     0.6108    0.4589    0.4744      3030
	                weighted avg     0.7118    0.5356    0.5532      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.359, 0.359, 0.359, 0.796, 0.514
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.359, 0.796, 0.514
-----------------------------------------------------------------------------------------
Epoch   61: avg_loss: 0.27931173890829086 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9815438985824585 2.3342670401493848e-05 0.2980392156862745 0.298015873015873

 ../data/dev/Period4.test
	Confusion Matrix
	 [333   0   0  12   1   0 158]
	 [  0 355   0   0   0   0 149]
	 [0 0 0 0 0 0 0]
	 [  9   0   0 320  63   1 111]
	 [  0   0   1  32 274  46 151]
	 [  0   0   1   0 107 214 182]
	 [  0   0   0   8 108  36 358]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.66071429 0.70436508        nan 0.63492063 0.54365079 0.42460317
 0.70196078]
	Accuracy = 0.6118811881188119
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9737    0.6607    0.7872       504
	              BookRestaurant     1.0000    0.7044    0.8265       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8602    0.6349    0.7306       504
	          SearchCreativeWork     0.4955    0.5437    0.5184       504
	        SearchScreeningEvent     0.7205    0.4246    0.5343       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3228    0.7020    0.4422       510
	
	                    accuracy                         0.6119      3030
	                   macro avg     0.6247    0.5243    0.5485      3030
	                weighted avg     0.7280    0.6119    0.6395      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.298, 0.298, 0.298, 0.809, 0.594
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.298, 0.809, 0.594
-----------------------------------------------------------------------------------------
Epoch   62: avg_loss: 0.2608890434106191 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9841179847717285 0.00042016806722688926 0.2980392156862745 0.2976190476190476

 ../data/dev/Period4.test
	Confusion Matrix
	 [375   0   0  13   2   0 114]
	 [  0 306   0   0   0   0 198]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 365  48   1  80]
	 [  0   0   1  40 284  36 143]
	 [  0   0   0   0 107 182 215]
	 [  2   0   0  11 112  27 358]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.74404762 0.60714286        nan 0.72420635 0.56349206 0.36111111
 0.70196078]
	Accuracy = 0.6171617161716172
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9690    0.7440    0.8418       504
	              BookRestaurant     1.0000    0.6071    0.7556       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8508    0.7242    0.7824       504
	          SearchCreativeWork     0.5136    0.5635    0.5374       504
	        SearchScreeningEvent     0.7398    0.3611    0.4853       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3231    0.7020    0.4425       510
	
	                    accuracy                         0.6172      3030
	                   macro avg     0.6280    0.5289    0.5493      3030
	                weighted avg     0.7319    0.6172    0.6404      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.298, 0.298, 0.298, 0.819, 0.600
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.298, 0.819, 0.600
-----------------------------------------------------------------------------------------
Epoch   63: avg_loss: 0.26373310883839923 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9869731664657593 4.6685340802987696e-05 0.30392156862745096 0.30396825396825394

 ../data/dev/Period4.test
	Confusion Matrix
	 [287   0   0  14   1   0 202]
	 [  0 308   0   0   0   0 196]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 342  59   1  95]
	 [  0   0   1  33 302  55 113]
	 [  0   0   3   0 116 225 160]
	 [  0   0   1  11 106  37 355]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.56944444 0.61111111        nan 0.67857143 0.59920635 0.44642857
 0.69607843]
	Accuracy = 0.6003300330033003
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9762    0.5694    0.7193       504
	              BookRestaurant     1.0000    0.6111    0.7586       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8550    0.6786    0.7566       504
	          SearchCreativeWork     0.5171    0.5992    0.5551       504
	        SearchScreeningEvent     0.7075    0.4464    0.5474       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3167    0.6961    0.4353       510
	
	                    accuracy                         0.6003      3030
	                   macro avg     0.6246    0.5144    0.5389      3030
	                weighted avg     0.7279    0.6003    0.6284      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.304, 0.304, 0.304, 0.807, 0.581
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.304, 0.807, 0.581
-----------------------------------------------------------------------------------------
Epoch   64: avg_loss: 0.29578446596860886 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9862087368965149 0.0002801120448179262 0.3764705882352941 0.3761904761904762

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 77   0   0   4   0   0 423]
	 [  0 358   0   0   0   0 146]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 232  93   1 178]
	 [  0   0   1  14 314  58 117]
	 [  0   0   4   0 141 275  84]
	 [  0   0   1   3 106  82 318]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.15277778 0.71031746        nan 0.46031746 0.62301587 0.54563492
 0.62352941]
	Accuracy = 0.5194719471947195
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1528    0.2651       504
	              BookRestaurant     1.0000    0.7103    0.8306       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9170    0.4603    0.6129       504
	          SearchCreativeWork     0.4801    0.6230    0.5423       504
	        SearchScreeningEvent     0.6611    0.5456    0.5978       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2512    0.6235    0.3581       510
	
	                    accuracy                         0.5195      3030
	                   macro avg     0.6156    0.4451    0.4581      3030
	                weighted avg     0.7173    0.5195    0.5341      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.376, 0.376, 0.376, 0.785, 0.498
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.376, 0.785, 0.498
-----------------------------------------------------------------------------------------
Epoch   65: avg_loss: 0.25212982545296353 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9881775975227356 4.6685340802987696e-05 0.396078431372549 0.396031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 55   0   0   6   0   1 442]
	 [  0 317   0   0   0   0 187]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 221 106   1 176]
	 [  0   0   2  16 314  62 110]
	 [  0   0   6   0 156 259  83]
	 [  0   0   8   4 103  87 308]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.10912698 0.62896825        nan 0.43849206 0.62301587 0.51388889
 0.60392157]
	Accuracy = 0.4864686468646865
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1091    0.1968       504
	              BookRestaurant     1.0000    0.6290    0.7722       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8947    0.4385    0.5885       504
	          SearchCreativeWork     0.4624    0.6230    0.5309       504
	        SearchScreeningEvent     0.6317    0.5139    0.5667       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2358    0.6039    0.3392       510
	
	                    accuracy                         0.4865      3030
	                   macro avg     0.6035    0.4168    0.4278      3030
	                weighted avg     0.7032    0.4865    0.4987      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.396, 0.396, 0.396, 0.770, 0.463
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.396, 0.770, 0.463
-----------------------------------------------------------------------------------------
Epoch   66: avg_loss: 0.25119492163260776 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9865294098854065 0.0009570494864612478 0.3862745098039216 0.38531746031746034

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 80   0   0   5   0   0 419]
	 [  0 355   0   0   0   0 149]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 219  95   1 189]
	 [  0   0   3  15 319  47 120]
	 [  0   0   6   0 144 260  94]
	 [  0   1  18   4 114  60 313]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.15873016 0.70436508        nan 0.43452381 0.63293651 0.51587302
 0.61372549]
	Accuracy = 0.5102310231023103
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1587    0.2740       504
	              BookRestaurant     0.9972    0.7044    0.8256       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9012    0.4345    0.5863       504
	          SearchCreativeWork     0.4747    0.6329    0.5425       504
	        SearchScreeningEvent     0.7065    0.5159    0.5963       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2438    0.6137    0.3489       510
	
	                    accuracy                         0.5102      3030
	                   macro avg     0.6176    0.4372    0.4534      3030
	                weighted avg     0.7196    0.5102    0.5286      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.385, 0.386, 0.385, 0.787, 0.489
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.385, 0.787, 0.489
-----------------------------------------------------------------------------------------
Epoch   67: avg_loss: 0.2778397649526596 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9864264130592346 2.3342670401493848e-05 0.3686274509803922 0.3686507936507937

 ../data/dev/Period4.test
	Confusion Matrix
	 [178   0   0  14   1   0 311]
	 [  0 186   0   0   0   0 318]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 330  78   1  94]
	 [  0   0   2  29 310  66  97]
	 [  0   0   6   0 138 251 109]
	 [  0   0   2   7 121  58 322]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.3531746  0.36904762        nan 0.6547619  0.61507937 0.49801587
 0.63137255]
	Accuracy = 0.5204620462046204
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9944    0.3532    0.5212       504
	              BookRestaurant     1.0000    0.3690    0.5391       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8684    0.6548    0.7466       504
	          SearchCreativeWork     0.4784    0.6151    0.5382       504
	        SearchScreeningEvent     0.6676    0.4980    0.5705       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2574    0.6314    0.3657       510
	
	                    accuracy                         0.5205      3030
	                   macro avg     0.6095    0.4459    0.4688      3030
	                weighted avg     0.7101    0.5205    0.5465      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.369, 0.369, 0.369, 0.786, 0.498
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.369, 0.786, 0.498
-----------------------------------------------------------------------------------------
Epoch   68: avg_loss: 0.2871004765232404 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.989264190196991 0.00018674136321195078 0.34901960784313724 0.3492063492063492

 ../data/dev/Period4.test
	Confusion Matrix
	 [288   0   0  23   1   0 192]
	 [  0 128   0   0   0   0 376]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 374  54   1  70]
	 [  0   0   1  37 310  57  99]
	 [  0   0   1   0 125 235 143]
	 [  0   0   0  11 124  43 332]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.57142857 0.25396825        nan 0.74206349 0.61507937 0.46626984
 0.65098039]
	Accuracy = 0.5501650165016502
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9829    0.5714    0.7227       504
	              BookRestaurant     1.0000    0.2540    0.4051       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8404    0.7421    0.7882       504
	          SearchCreativeWork     0.5049    0.6151    0.5546       504
	        SearchScreeningEvent     0.6994    0.4663    0.5595       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2739    0.6510    0.3856       510
	
	                    accuracy                         0.5502      3030
	                   macro avg     0.6145    0.4714    0.4880      3030
	                weighted avg     0.7161    0.5502    0.5689      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.349, 0.349, 0.349, 0.809, 0.530
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.349, 0.809, 0.530
-----------------------------------------------------------------------------------------
Epoch   69: avg_loss: 0.24809151887893677 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.981665849685669 0.0 0.3 0.3

 ../data/dev/Period4.test
	Confusion Matrix
	 [344   0  19   0   0 141]
	 [  0 227   0   0   0 277]
	 [  8   0 383  47   1  65]
	 [  0   0  39 301  55 109]
	 [  0   0   0 123 217 164]
	 [  0   0  10 106  37 357]
	Classwise Accuracies
	Labels
	[0.68253968 0.45039683 0.75992063 0.59722222 0.43055556 0.7       ]
	Accuracy = 0.6036303630363037
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9773    0.6825    0.8037       504
	              BookRestaurant     1.0000    0.4504    0.6211       504
	                   PlayMusic     0.8492    0.7599    0.8021       504
	          SearchCreativeWork     0.5217    0.5972    0.5569       504
	        SearchScreeningEvent     0.7000    0.4306    0.5332       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3208    0.7000    0.4399       510
	
	                    accuracy                         0.6036      3030
	                   macro avg     0.7282    0.6034    0.6261      3030
	                weighted avg     0.7273    0.6036    0.6258      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.300, 0.300, 0.300, 0.817, 0.584
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.300, 0.817, 0.584
-----------------------------------------------------------------------------------------
Epoch   70: avg_loss: 0.22274856766064963 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9836880564689636 2.3342670401493848e-05 0.36470588235294116 0.36468253968253966

 ../data/dev/Period4.test
	Confusion Matrix
	 [112   0   0   3   0   0 389]
	 [  0 377   0   0   0   0 127]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 268  50   1 185]
	 [  0   0   1  21 301  65 116]
	 [  0   0   4   0 135 263 102]
	 [  0   2   1   3 108  72 324]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.22222222 0.74801587        nan 0.53174603 0.59722222 0.5218254
 0.63529412]
	Accuracy = 0.5429042904290429
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2222    0.3636       504
	              BookRestaurant     0.9947    0.7480    0.8539       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9085    0.5317    0.6708       504
	          SearchCreativeWork     0.5067    0.5972    0.5483       504
	        SearchScreeningEvent     0.6559    0.5218    0.5812       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2607    0.6353    0.3697       510
	
	                    accuracy                         0.5429      3030
	                   macro avg     0.6181    0.4652    0.4839      3030
	                weighted avg     0.7202    0.5429    0.5642      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.365, 0.365, 0.365, 0.809, 0.524
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.365, 0.809, 0.524
-----------------------------------------------------------------------------------------
Epoch   71: avg_loss: 0.26493220527966815 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9913421869277954 0.0009103641456582601 0.40980392156862744 0.4107142857142857

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 63   0   0   5   1   0 435]
	 [  0 250   0   0   0   0 254]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 293  56   1 154]
	 [  0   0   1  26 319  60  98]
	 [  0   0   2   0 160 248  94]
	 [  0   0   1   4 111  93 301]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.125      0.49603175        nan 0.58134921 0.63293651 0.49206349
 0.59019608]
	Accuracy = 0.4864686468646865
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1250    0.2222       504
	              BookRestaurant     1.0000    0.4960    0.6631       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8933    0.5813    0.7043       504
	          SearchCreativeWork     0.4930    0.6329    0.5543       504
	        SearchScreeningEvent     0.6169    0.4921    0.5475       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2253    0.5902    0.3261       510
	
	                    accuracy                         0.4865      3030
	                   macro avg     0.6041    0.4168    0.4311      3030
	                weighted avg     0.7038    0.4865    0.5026      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.411, 0.410, 0.411, 0.789, 0.465
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.411, 0.789, 0.465
-----------------------------------------------------------------------------------------
Epoch   72: avg_loss: 0.26619353145360947 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9891163110733032 2.3342670401493848e-05 0.4019607843137255 0.401984126984127

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 64   0   0   4   1   0 435]
	 [  0 300   0   0   0   1 203]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 280  58   1 165]
	 [  0   0   1  23 314  56 110]
	 [  0   0   3   0 176 225 100]
	 [  0   0   1   3 102  99 305]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.12698413 0.5952381         nan 0.55555556 0.62301587 0.44642857
 0.59803922]
	Accuracy = 0.4910891089108911
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1270    0.2254       504
	              BookRestaurant     1.0000    0.5952    0.7463       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9032    0.5556    0.6880       504
	          SearchCreativeWork     0.4823    0.6230    0.5437       504
	        SearchScreeningEvent     0.5890    0.4464    0.5079       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2314    0.5980    0.3337       510
	
	                    accuracy                         0.4911      3030
	                   macro avg     0.6009    0.4208    0.4350      3030
	                weighted avg     0.7001    0.4911    0.5071      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.402, 0.402, 0.402, 0.779, 0.469
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.402, 0.779, 0.469
-----------------------------------------------------------------------------------------
Epoch   73: avg_loss: 0.2367410585284233 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9815831184387207 0.0009103641456582601 0.3568627450980392 0.35595238095238096

 ../data/dev/Period4.test
	Confusion Matrix
	 [159   0   0   6   1   0 338]
	 [  0 345   0   0   0   0 159]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 273  74   1 156]
	 [  0   0   5  21 297  62 119]
	 [  0   0   8   0 149 222 125]
	 [  0   2   3   2  90  85 328]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.31547619 0.68452381        nan 0.54166667 0.58928571 0.44047619
 0.64313725]
	Accuracy = 0.5359735973597359
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3155    0.4796       504
	              BookRestaurant     0.9942    0.6845    0.8108       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9040    0.5417    0.6774       504
	          SearchCreativeWork     0.4861    0.5893    0.5327       504
	        SearchScreeningEvent     0.6000    0.4405    0.5080       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2678    0.6431    0.3781       510
	
	                    accuracy                         0.5360      3030
	                   macro avg     0.6074    0.4592    0.4838      3030
	                weighted avg     0.7078    0.5360    0.5641      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.356, 0.357, 0.356, 0.777, 0.514
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.356, 0.777, 0.514
-----------------------------------------------------------------------------------------
Epoch   74: avg_loss: 0.27057940512895584 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9804072380065918 7.002801120448154e-05 0.29411764705882354 0.29404761904761906

 ../data/dev/Period4.test
	Confusion Matrix
	 [299   0   0  21   0   0 184]
	 [  0 293   0   0   0   0 211]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 354  61   1  82]
	 [  0   0   2  33 289  60 120]
	 [  0   0   4   1 148 207 144]
	 [  0   0   2   7  85  56 360]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.59325397 0.58134921        nan 0.70238095 0.5734127  0.41071429
 0.70588235]
	Accuracy = 0.5947194719471948
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9803    0.5933    0.7392       504
	              BookRestaurant     1.0000    0.5813    0.7353       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8510    0.7024    0.7696       504
	          SearchCreativeWork     0.4957    0.5734    0.5317       504
	        SearchScreeningEvent     0.6389    0.4107    0.5000       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3270    0.7059    0.4469       510
	
	                    accuracy                         0.5947      3030
	                   macro avg     0.6133    0.5096    0.5318      3030
	                weighted avg     0.7147    0.5947    0.6201      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.294, 0.294, 0.294, 0.792, 0.572
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.294, 0.792, 0.572
-----------------------------------------------------------------------------------------
Epoch   75: avg_loss: 0.263705350458622 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9900455474853516 0.0007936507936507908 0.3333333333333333 0.3325396825396825

 ../data/dev/Period4.test
	Confusion Matrix
	 [296   0   0  20   1   0 187]
	 [  0 259   0   0   0   0 245]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 356  56   1  84]
	 [  0   0   0  32 284  56 132]
	 [  0   0   1   1 122 190 190]
	 [  0   0   1   8 106  55 340]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.58730159 0.51388889        nan 0.70634921 0.56349206 0.37698413
 0.66666667]
	Accuracy = 0.5693069306930693
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9769    0.5873    0.7336       504
	              BookRestaurant     1.0000    0.5139    0.6789       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8537    0.7063    0.7731       504
	          SearchCreativeWork     0.4991    0.5635    0.5294       504
	        SearchScreeningEvent     0.6291    0.3770    0.4715       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2886    0.6667    0.4028       510
	
	                    accuracy                         0.5693      3030
	                   macro avg     0.6068    0.4878    0.5127      3030
	                weighted avg     0.7071    0.5693    0.5978      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.333, 0.333, 0.333, 0.800, 0.550
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.333, 0.800, 0.550
-----------------------------------------------------------------------------------------
Epoch   76: avg_loss: 0.24616100390752158 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9810224771499634 9.337068160597539e-05 0.27450980392156865 0.2746031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [407   0   0  31   0   0  66]
	 [  0 203   0   0   0   0 301]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 407  42   1  43]
	 [  0   0   0  37 314  44 109]
	 [  0   0   1   1 135 194 173]
	 [  1   0   0  12  94  33 370]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.80753968 0.40277778        nan 0.80753968 0.62301587 0.38492063
 0.7254902 ]
	Accuracy = 0.6254125412541254
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9714    0.8075    0.8819       504
	              BookRestaurant     1.0000    0.4028    0.5743       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8340    0.8075    0.8206       504
	          SearchCreativeWork     0.5368    0.6230    0.5767       504
	        SearchScreeningEvent     0.7132    0.3849    0.5000       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3484    0.7255    0.4707       510
	
	                    accuracy                         0.6254      3030
	                   macro avg     0.6291    0.5359    0.5463      3030
	                weighted avg     0.7332    0.6254    0.6370      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.275, 0.275, 0.275, 0.818, 0.605
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.275, 0.818, 0.605
-----------------------------------------------------------------------------------------
Epoch   77: avg_loss: 0.2414911910891533 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9845657348632812 0.00060690943043884 0.3176470588235294 0.31825396825396823

 ../data/dev/Period4.test
	Confusion Matrix
	 [396   0   0  36   1   0  71]
	 [  0  77   0   0   0   0 427]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 421  34   1  38]
	 [  0   0   0  39 317  45 103]
	 [  0   0   1   1 167 172 163]
	 [  1   0   0  15 118  28 348]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.78571429 0.15277778        nan 0.83531746 0.62896825 0.34126984
 0.68235294]
	Accuracy = 0.5712871287128712
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9730    0.7857    0.8694       504
	              BookRestaurant     1.0000    0.1528    0.2651       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8223    0.8353    0.8287       504
	          SearchCreativeWork     0.4976    0.6290    0.5557       504
	        SearchScreeningEvent     0.6992    0.3413    0.4587       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3026    0.6824    0.4193       510
	
	                    accuracy                         0.5713      3030
	                   macro avg     0.6135    0.4895    0.4853      3030
	                weighted avg     0.7150    0.5713    0.5658      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.318, 0.318, 0.318, 0.803, 0.549
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.318, 0.803, 0.549
-----------------------------------------------------------------------------------------
Epoch   78: avg_loss: 0.2451274817188581 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9860389232635498 0.00042016806722688926 0.2980392156862745 0.2976190476190476

 ../data/dev/Period4.test
	Confusion Matrix
	 [347   0   0  16   1   0 140]
	 [  0 297   0   0   0   0 207]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 374  42   1  81]
	 [  0   0   0  32 279  67 126]
	 [  0   0   1   0 135 172 196]
	 [  0   0   0   8  86  58 358]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.68849206 0.58928571        nan 0.74206349 0.55357143 0.34126984
 0.70196078]
	Accuracy = 0.602970297029703
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9830    0.6885    0.8098       504
	              BookRestaurant     1.0000    0.5893    0.7416       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8698    0.7421    0.8009       504
	          SearchCreativeWork     0.5138    0.5536    0.5330       504
	        SearchScreeningEvent     0.5772    0.3413    0.4289       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3231    0.7020    0.4425       510
	
	                    accuracy                         0.6030      3030
	                   macro avg     0.6096    0.5167    0.5367      3030
	                weighted avg     0.7104    0.6030    0.6257      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.298, 0.298, 0.298, 0.802, 0.583
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.298, 0.802, 0.583
-----------------------------------------------------------------------------------------
Epoch   79: avg_loss: 0.24042991797129312 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9837571382522583 0.00060690943043884 0.34901960784313724 0.3484126984126984

 ../data/dev/Period4.test
	Confusion Matrix
	 [220   0   0   4   0   0 280]
	 [  0 426   0   0   0   0  78]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 237  47   1 218]
	 [  0   0   0  13 254  75 162]
	 [  0   0   5   0 104 255 140]
	 [  0   6   1   3  83  85 332]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.43650794 0.8452381         nan 0.4702381  0.50396825 0.50595238
 0.65098039]
	Accuracy = 0.568976897689769
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9955    0.4365    0.6069       504
	              BookRestaurant     0.9861    0.8452    0.9103       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9222    0.4702    0.6229       504
	          SearchCreativeWork     0.5205    0.5040    0.5121       504
	        SearchScreeningEvent     0.6130    0.5060    0.5543       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2744    0.6510    0.3860       510
	
	                    accuracy                         0.5690      3030
	                   macro avg     0.6159    0.4876    0.5132      3030
	                weighted avg     0.7177    0.5690    0.5983      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.349, 0.349, 0.348, 0.812, 0.552
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.349, 0.812, 0.552
-----------------------------------------------------------------------------------------
Epoch   80: avg_loss: 0.2531479671597481 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9844299554824829 9.337068160597539e-05 0.307843137254902 0.30793650793650795

 ../data/dev/Period4.test
	Confusion Matrix
	 [316   0   0  14   0   0 174]
	 [  0 326   0   0   0   0 178]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 341  44   1 114]
	 [  0   0   0  26 246  79 153]
	 [  0   0   5   0 100 242 157]
	 [  0   1   0   6 102  48 353]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.62698413 0.6468254         nan 0.6765873  0.48809524 0.48015873
 0.69215686]
	Accuracy = 0.601980198019802
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9875    0.6270    0.7670       504
	              BookRestaurant     0.9969    0.6468    0.7846       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8811    0.6766    0.7654       504
	          SearchCreativeWork     0.5000    0.4881    0.4940       504
	        SearchScreeningEvent     0.6541    0.4802    0.5538       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3127    0.6922    0.4308       510
	
	                    accuracy                         0.6020      3030
	                   macro avg     0.6189    0.5158    0.5422      3030
	                weighted avg     0.7212    0.6020    0.6322      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.308, 0.308, 0.308, 0.805, 0.584
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.308, 0.805, 0.584
-----------------------------------------------------------------------------------------
Epoch   81: avg_loss: 0.2644171367088954 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.992214560508728 0.0006535947712418277 0.35490196078431374 0.35555555555555557

 ../data/dev/Period4.test
	Confusion Matrix
	 [344   0   0  17   1   0 142]
	 [  0  40   0   0   0   0 464]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 413  34   0  54]
	 [  0   0   0  38 307  61  98]
	 [  0   0   4   1 124 237 138]
	 [  0   0   0  17 138  26 329]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.68253968 0.07936508        nan 0.81944444 0.60912698 0.4702381
 0.64509804]
	Accuracy = 0.5511551155115512
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9914    0.6825    0.8085       504
	              BookRestaurant     1.0000    0.0794    0.1471       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8498    0.8194    0.8343       504
	          SearchCreativeWork     0.5083    0.6091    0.5542       504
	        SearchScreeningEvent     0.7315    0.4702    0.5725       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2686    0.6451    0.3793       510
	
	                    accuracy                         0.5512      3030
	                   macro avg     0.6214    0.4723    0.4708      3030
	                weighted avg     0.7240    0.5512    0.5490      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.355, 0.355, 0.356, 0.815, 0.532
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.355, 0.815, 0.532
-----------------------------------------------------------------------------------------
Epoch   82: avg_loss: 0.25318726648886997 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9904826283454895 0.0001400560224089631 0.34509803921568627 0.34523809523809523

 ../data/dev/Period4.test
	Confusion Matrix
	 [327   0   0  21   0   0 156]
	 [  0  41   0   0   0   0 463]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 404  43   1  51]
	 [  0   0   0  37 318  69  80]
	 [  0   0   5   1 124 254 120]
	 [  0   0   0  17 126  33 334]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.64880952 0.08134921        nan 0.8015873  0.63095238 0.50396825
 0.65490196]
	Accuracy = 0.5537953795379538
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9849    0.6488    0.7823       504
	              BookRestaurant     1.0000    0.0813    0.1505       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8417    0.8016    0.8211       504
	          SearchCreativeWork     0.5205    0.6310    0.5704       504
	        SearchScreeningEvent     0.7115    0.5040    0.5900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2774    0.6549    0.3897       510
	
	                    accuracy                         0.5538      3030
	                   macro avg     0.6194    0.4745    0.4720      3030
	                weighted avg     0.7218    0.5538    0.5504      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.345, 0.345, 0.345, 0.806, 0.533
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.345, 0.806, 0.533
-----------------------------------------------------------------------------------------
Epoch   83: avg_loss: 0.2525557031234105 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9856177568435669 0.00018674136321195078 0.3509803921568627 0.35079365079365077

 ../data/dev/Period4.test
	Confusion Matrix
	 [142   0   0   5   0   0 357]
	 [  0 286   0   0   0   0 218]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 334  43   1 126]
	 [  0   0   1  30 314  69  90]
	 [  0   0   5   0 170 236  93]
	 [  0   1   1   6 101  70 331]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.28174603 0.56746032        nan 0.66269841 0.62301587 0.46825397
 0.64901961]
	Accuracy = 0.5422442244224422
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2817    0.4396       504
	              BookRestaurant     0.9965    0.5675    0.7231       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8907    0.6627    0.7600       504
	          SearchCreativeWork     0.5000    0.6230    0.5548       504
	        SearchScreeningEvent     0.6277    0.4683    0.5364       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2724    0.6490    0.3838       510
	
	                    accuracy                         0.5422      3030
	                   macro avg     0.6125    0.4646    0.4854      3030
	                weighted avg     0.7137    0.5422    0.5659      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.351, 0.351, 0.351, 0.798, 0.521
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.351, 0.798, 0.521
-----------------------------------------------------------------------------------------
Epoch   84: avg_loss: 0.2286503091454506 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9858411550521851 0.0 0.36666666666666664 0.36666666666666664

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 57   0   0   2   0   0 445]
	 [  0 404   0   0   0   0 100]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 246  57   1 200]
	 [  0   0   1  15 314  67 107]
	 [  0   0   4   0 158 270  72]
	 [  0   3   1   2  70 111 323]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.11309524 0.8015873         nan 0.48809524 0.62301587 0.53571429
 0.63333333]
	Accuracy = 0.5326732673267327
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1131    0.2032       504
	              BookRestaurant     0.9926    0.8016    0.8869       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9283    0.4881    0.6398       504
	          SearchCreativeWork     0.5242    0.6230    0.5694       504
	        SearchScreeningEvent     0.6013    0.5357    0.5666       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2590    0.6333    0.3677       510
	
	                    accuracy                         0.5327      3030
	                   macro avg     0.6151    0.4564    0.4619      3030
	                weighted avg     0.7167    0.5327    0.5386      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.367, 0.367, 0.367, 0.805, 0.512
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.367, 0.805, 0.512
-----------------------------------------------------------------------------------------
Epoch   85: avg_loss: 0.24608105421066284 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9799692034721375 0.00060690943043884 0.3176470588235294 0.31825396825396823

 ../data/dev/Period4.test
	Confusion Matrix
	 [247   0   0   4   0   0 253]
	 [  0 445   0   0   0   0  59]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 283  38   1 181]
	 [  0   0   0  19 246  78 161]
	 [  0   0   4   0 113 239 148]
	 [  0  14   0   3  66  79 348]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.49007937 0.88293651        nan 0.56150794 0.48809524 0.47420635
 0.68235294]
	Accuracy = 0.5966996699669967
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9960    0.4901    0.6569       504
	              BookRestaurant     0.9695    0.8829    0.9242       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9159    0.5615    0.6962       504
	          SearchCreativeWork     0.5313    0.4881    0.5088       504
	        SearchScreeningEvent     0.6020    0.4742    0.5305       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3026    0.6824    0.4193       510
	
	                    accuracy                         0.5967      3030
	                   macro avg     0.6168    0.5113    0.5337      3030
	                weighted avg     0.7187    0.5967    0.6222      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.318, 0.318, 0.318, 0.815, 0.579
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.318, 0.815, 0.579
-----------------------------------------------------------------------------------------
Epoch   86: avg_loss: 0.2028924971818924 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9769574999809265 2.3342670401493848e-05 0.26862745098039215 0.26865079365079364

 ../data/dev/Period4.test
	Confusion Matrix
	 [362   0   0   8   0   0 134]
	 [  0 366   0   0   0   0 138]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 370  35   1  92]
	 [  0   0   0  35 268  62 139]
	 [  0   0   2   0 138 190 174]
	 [  0   1   0   7  77  52 373]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.71825397 0.72619048        nan 0.73412698 0.53174603 0.37698413
 0.73137255]
	Accuracy = 0.6366336633663366
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9837    0.7183    0.8303       504
	              BookRestaurant     0.9973    0.7262    0.8404       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8810    0.7341    0.8009       504
	          SearchCreativeWork     0.5174    0.5317    0.5245       504
	        SearchScreeningEvent     0.6230    0.3770    0.4697       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3552    0.7314    0.4782       510
	
	                    accuracy                         0.6366      3030
	                   macro avg     0.6225    0.5455    0.5634      3030
	                weighted avg     0.7255    0.6366    0.6570      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.269, 0.269, 0.269, 0.811, 0.617
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.269, 0.811, 0.617
-----------------------------------------------------------------------------------------
Epoch   87: avg_loss: 0.22214416662851968 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9742960333824158 0.00018674136321195078 0.3156862745098039 0.31587301587301586

 ../data/dev/Period4.test
	Confusion Matrix
	 [271   0   0   2   0   0 231]
	 [  0 444   0   0   0   0  60]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 251  35   1 215]
	 [  0   0   0  18 235  80 171]
	 [  0   0   5   0 125 255 119]
	 [  0   8   0   3  70  80 349]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53769841 0.88095238        nan 0.49801587 0.46626984 0.50595238
 0.68431373]
	Accuracy = 0.5957095709570958
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9927    0.5377    0.6976       504
	              BookRestaurant     0.9823    0.8810    0.9289       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9161    0.4980    0.6452       504
	          SearchCreativeWork     0.5054    0.4663    0.4850       504
	        SearchScreeningEvent     0.6130    0.5060    0.5543       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3048    0.6843    0.4218       510
	
	                    accuracy                         0.5957      3030
	                   macro avg     0.6163    0.5105    0.5333      3030
	                weighted avg     0.7182    0.5957    0.6217      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.316, 0.316, 0.316, 0.806, 0.578
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.316, 0.806, 0.578
-----------------------------------------------------------------------------------------
Epoch   88: avg_loss: 0.23464065541823706 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9797874093055725 0.00046685340802987696 0.3607843137254902 0.3603174603174603

 ../data/dev/Period4.test
	Confusion Matrix
	 [107   0   0   1   0   0 396]
	 [  0 384   0   0   0   0 120]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 252  46   1 205]
	 [  0   0   1  21 300  68 114]
	 [  0   0   5   0 174 252  73]
	 [  0   4   1   4  88  87 326]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.21230159 0.76190476        nan 0.5        0.5952381  0.5
 0.63921569]
	Accuracy = 0.5349834983498349
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2123    0.3502       504
	              BookRestaurant     0.9897    0.7619    0.8610       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9065    0.5000    0.6445       504
	          SearchCreativeWork     0.4934    0.5952    0.5396       504
	        SearchScreeningEvent     0.6176    0.5000    0.5526       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2642    0.6392    0.3739       510
	
	                    accuracy                         0.5350      3030
	                   macro avg     0.6102    0.4584    0.4745      3030
	                weighted avg     0.7110    0.5350    0.5533      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.360, 0.361, 0.360, 0.791, 0.514
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.360, 0.791, 0.514
-----------------------------------------------------------------------------------------
Epoch   89: avg_loss: 0.2854066739479701 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9880043864250183 0.00042016806722688926 0.36470588235294116 0.36428571428571427

 ../data/dev/Period4.test
	Confusion Matrix
	 [279   0   0  13   0   0 212]
	 [  0 119   0   0   0   0 385]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 371  43   1  87]
	 [  0   0   6  35 296  60 107]
	 [  0   0  12   1 146 218 127]
	 [  0   0   3   9 115  59 324]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.55357143 0.23611111        nan 0.73611111 0.58730159 0.43253968
 0.63529412]
	Accuracy = 0.5303630363036304
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9929    0.5536    0.7108       504
	              BookRestaurant     1.0000    0.2361    0.3820       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8648    0.7361    0.7953       504
	          SearchCreativeWork     0.4933    0.5873    0.5362       504
	        SearchScreeningEvent     0.6450    0.4325    0.5178       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2609    0.6353    0.3699       510
	
	                    accuracy                         0.5304      3030
	                   macro avg     0.6081    0.4544    0.4731      3030
	                weighted avg     0.7086    0.5304    0.5516      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.364, 0.365, 0.364, 0.782, 0.509
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.364, 0.782, 0.509
-----------------------------------------------------------------------------------------
Epoch   90: avg_loss: 0.24665704121192297 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9932212233543396 0.0008403361344537785 0.37058823529411766 0.37142857142857144

 ../data/dev/Period4.test
	Confusion Matrix
	 [280   0   0  14   0   0 210]
	 [  0 157   0   0   0   0 347]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 359  40   1 101]
	 [  0   0   0  31 278  69 126]
	 [  0   0   8   1 137 206 152]
	 [  0   0   0   9 114  66 321]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.55555556 0.31150794        nan 0.71230159 0.5515873  0.40873016
 0.62941176]
	Accuracy = 0.5283828382838284
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9894    0.5556    0.7116       504
	              BookRestaurant     1.0000    0.3115    0.4750       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8671    0.7123    0.7821       504
	          SearchCreativeWork     0.4886    0.5516    0.5182       504
	        SearchScreeningEvent     0.6023    0.4087    0.4870       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2554    0.6294    0.3633       510
	
	                    accuracy                         0.5284      3030
	                   macro avg     0.6004    0.4527    0.4767      3030
	                weighted avg     0.6996    0.5284    0.5558      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.371, 0.371, 0.371, 0.787, 0.508
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.371, 0.787, 0.508
-----------------------------------------------------------------------------------------
Epoch   91: avg_loss: 0.2649741346637408 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9896431565284729 0.0007936507936507908 0.36666666666666664 0.36587301587301585

 ../data/dev/Period4.test
	Confusion Matrix
	 [272   0   0  11   0   0 221]
	 [  0 128   0   0   0   0 376]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 374  39   1  88]
	 [  0   0   1  36 294  67 106]
	 [  0   0  10   1 144 218 131]
	 [  0   0   2  10 113  62 323]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53968254 0.25396825        nan 0.74206349 0.58333333 0.43253968
 0.63333333]
	Accuracy = 0.531023102310231
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9927    0.5397    0.6992       504
	              BookRestaurant     1.0000    0.2540    0.4051       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8657    0.7421    0.7991       504
	          SearchCreativeWork     0.4983    0.5833    0.5375       504
	        SearchScreeningEvent     0.6264    0.4325    0.5117       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2594    0.6333    0.3681       510
	
	                    accuracy                         0.5310      3030
	                   macro avg     0.6061    0.4550    0.4744      3030
	                weighted avg     0.7062    0.5310    0.5531      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.366, 0.367, 0.366, 0.788, 0.510
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.366, 0.788, 0.510
-----------------------------------------------------------------------------------------
Epoch   92: avg_loss: 0.23805260409911475 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9842389822006226 0.0009103641456582601 0.3568627450980392 0.35595238095238096

 ../data/dev/Period4.test
	Confusion Matrix
	 [242   0   0   5   0   0 257]
	 [  0 193   0   0   0   0 311]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 356  40   1 105]
	 [  0   0   4  35 290  71 104]
	 [  0   0  10   1 156 217 120]
	 [  0   0   3   9 114  56 328]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.48015873 0.38293651        nan 0.70634921 0.57539683 0.43055556
 0.64313725]
	Accuracy = 0.5366336633663367
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9918    0.4802    0.6471       504
	              BookRestaurant     1.0000    0.3829    0.5538       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8768    0.7063    0.7824       504
	          SearchCreativeWork     0.4833    0.5754    0.5254       504
	        SearchScreeningEvent     0.6290    0.4306    0.5112       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2678    0.6431    0.3781       510
	
	                    accuracy                         0.5366      3030
	                   macro avg     0.6070    0.4598    0.4854      3030
	                weighted avg     0.7072    0.5366    0.5659      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.356, 0.357, 0.356, 0.782, 0.515
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.356, 0.782, 0.515
-----------------------------------------------------------------------------------------
Epoch   93: avg_loss: 0.2502036492029826 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9837380647659302 9.337068160597539e-05 0.3254901960784314 0.3253968253968254

 ../data/dev/Period4.test
	Confusion Matrix
	 [291   0   0   6   0   0 207]
	 [  0 214   0   0   0   0 290]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 368  38   1  94]
	 [  0   0   2  39 294  68 101]
	 [  0   0   8   1 172 195 128]
	 [  0   0   2  10 101  53 344]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.57738095 0.42460317        nan 0.73015873 0.58333333 0.38690476
 0.6745098 ]
	Accuracy = 0.563036303630363
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9898    0.5774    0.7293       504
	              BookRestaurant     1.0000    0.4246    0.5961       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8679    0.7302    0.7931       504
	          SearchCreativeWork     0.4860    0.5833    0.5302       504
	        SearchScreeningEvent     0.6151    0.3869    0.4750       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2955    0.6745    0.4110       510
	
	                    accuracy                         0.5630      3030
	                   macro avg     0.6078    0.4824    0.5050      3030
	                weighted avg     0.7082    0.5630    0.5888      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.325, 0.325, 0.325, 0.785, 0.540
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.325, 0.785, 0.540
-----------------------------------------------------------------------------------------
Epoch   94: avg_loss: 0.22380825132131577 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9868806600570679 0.0009570494864612478 0.3196078431372549 0.31865079365079363

 ../data/dev/Period4.test
	Confusion Matrix
	 [304   0   0   5   0   0 195]
	 [  0 311   0   0   0   0 193]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 343  34   1 123]
	 [  0   0   0  33 278  56 137]
	 [  0   0   6   0 173 170 155]
	 [  0   2   1   7  87  66 347]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6031746  0.61706349        nan 0.68055556 0.5515873  0.33730159
 0.68039216]
	Accuracy = 0.5785478547854785
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9902    0.6032    0.7497       504
	              BookRestaurant     0.9936    0.6171    0.7613       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8840    0.6806    0.7691       504
	          SearchCreativeWork     0.4860    0.5516    0.5167       504
	        SearchScreeningEvent     0.5802    0.3373    0.4266       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3017    0.6804    0.4181       510
	
	                    accuracy                         0.5785      3030
	                   macro avg     0.6051    0.4957    0.5202      3030
	                weighted avg     0.7052    0.5785    0.6065      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.319, 0.320, 0.319, 0.794, 0.558
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.319, 0.794, 0.558
-----------------------------------------------------------------------------------------
Epoch   95: avg_loss: 0.23593545705080032 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9803341031074524 0.0009103641456582601 0.27647058823529413 0.2773809523809524

 ../data/dev/Period4.test
	Confusion Matrix
	 [360   0   0   3   0   0 141]
	 [  0 450   0   0   0   0  54]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 328  23   1 146]
	 [  0   0   0  25 227  60 192]
	 [  0   0   5   0 135 198 166]
	 [  0   9   1   4  61  66 369]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.71428571 0.89285714        nan 0.65079365 0.45039683 0.39285714
 0.72352941]
	Accuracy = 0.6376237623762376
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9836    0.7143    0.8276       504
	              BookRestaurant     0.9804    0.8929    0.9346       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9111    0.6508    0.7593       504
	          SearchCreativeWork     0.5090    0.4504    0.4779       504
	        SearchScreeningEvent     0.6092    0.3929    0.4777       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3455    0.7235    0.4677       510
	
	                    accuracy                         0.6376      3030
	                   macro avg     0.6198    0.5464    0.5635      3030
	                weighted avg     0.7224    0.6376    0.6571      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.277, 0.276, 0.277, 0.808, 0.620
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.277, 0.808, 0.620
-----------------------------------------------------------------------------------------
Epoch   96: avg_loss: 0.21947584052880606 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9864906072616577 0.00037348272642390157 0.30196078431372547 0.30158730158730157

 ../data/dev/Period4.test
	Confusion Matrix
	 [350   0   0   6   0   0 148]
	 [  0 279   0   0   0   0 225]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 371  32   1  94]
	 [  0   0   0  34 258  63 149]
	 [  0   0  10   0 143 207 144]
	 [  0   0   1   8  90  55 356]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.69444444 0.55357143        nan 0.73611111 0.51190476 0.41071429
 0.69803922]
	Accuracy = 0.600990099009901
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9831    0.6944    0.8140       504
	              BookRestaurant     1.0000    0.5536    0.7126       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8854    0.7361    0.8039       504
	          SearchCreativeWork     0.4933    0.5119    0.5024       504
	        SearchScreeningEvent     0.6350    0.4107    0.4988       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3190    0.6980    0.4379       510
	
	                    accuracy                         0.6010      3030
	                   macro avg     0.6166    0.5150    0.5385      3030
	                weighted avg     0.7185    0.6010    0.6279      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.302, 0.302, 0.302, 0.798, 0.581
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.302, 0.798, 0.581
-----------------------------------------------------------------------------------------
Epoch   97: avg_loss: 0.2474932794769605 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9868732690811157 0.0007936507936507908 0.3 0.3007936507936508

 ../data/dev/Period4.test
	Confusion Matrix
	 [402   0   0  13   0   0  89]
	 [  0 155   0   0   0   0 349]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 411  30   1  51]
	 [  0   0   0  40 291  54 119]
	 [  0   0   3   2 142 207 150]
	 [  1   0   0  14 107  31 357]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.79761905 0.30753968        nan 0.81547619 0.57738095 0.41071429
 0.7       ]
	Accuracy = 0.6016501650165017
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9710    0.7976    0.8758       504
	              BookRestaurant     1.0000    0.3075    0.4704       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8562    0.8155    0.8354       504
	          SearchCreativeWork     0.5105    0.5774    0.5419       504
	        SearchScreeningEvent     0.7065    0.4107    0.5194       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3202    0.7000    0.4394       510
	
	                    accuracy                         0.6017      3030
	                   macro avg     0.6235    0.5155    0.5260      3030
	                weighted avg     0.7266    0.6017    0.6134      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.301, 0.300, 0.301, 0.813, 0.582
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.301, 0.813, 0.582
-----------------------------------------------------------------------------------------
Epoch   98: avg_loss: 0.24922210971514383 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.986259937286377 0.00016339869281045694 0.34705882352941175 0.3472222222222222

 ../data/dev/Period4.test
	Confusion Matrix
	 [189   0   0   6   0   0 309]
	 [  0 221   0   0   0   0 283]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 353  39   0 111]
	 [  0   0   1  32 311  78  82]
	 [  0   0   8   0 149 257  90]
	 [  0   0   1   6 113  57 333]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.375      0.43849206        nan 0.70039683 0.61706349 0.50992063
 0.65294118]
	Accuracy = 0.5491749174917492
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9947    0.3750    0.5447       504
	              BookRestaurant     1.0000    0.4385    0.6097       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8892    0.7004    0.7836       504
	          SearchCreativeWork     0.5082    0.6171    0.5573       504
	        SearchScreeningEvent     0.6556    0.5099    0.5737       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2757    0.6529    0.3877       510
	
	                    accuracy                         0.5492      3030
	                   macro avg     0.6176    0.4705    0.4938      3030
	                weighted avg     0.7197    0.5492    0.5757      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.347, 0.347, 0.347, 0.793, 0.528
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.347, 0.793, 0.528
-----------------------------------------------------------------------------------------
Epoch   99: avg_loss: 0.21806779752175012 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9847678542137146 0.00060690943043884 0.38235294117647056 0.3817460317460317

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 37   0   0   1   0   0 466]
	 [  0 365   0   0   0   0 139]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 256  52   1 195]
	 [  0   0   1  19 307  76 101]
	 [  0   0   5   0 173 265  61]
	 [  0   3   1   2  98  91 315]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.0734127  0.72420635        nan 0.50793651 0.60912698 0.52579365
 0.61764706]
	Accuracy = 0.5099009900990099
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.0734    0.1368       504
	              BookRestaurant     0.9918    0.7242    0.8372       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9209    0.5079    0.6547       504
	          SearchCreativeWork     0.4873    0.6091    0.5414       504
	        SearchScreeningEvent     0.6120    0.5258    0.5656       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2467    0.6176    0.3525       510
	
	                    accuracy                         0.5099      3030
	                   macro avg     0.6084    0.4369    0.4412      3030
	                weighted avg     0.7089    0.5099    0.5144      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.382, 0.382, 0.382, 0.791, 0.488
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.382, 0.791, 0.488
-----------------------------------------------------------------------------------------
Epoch  100: avg_loss: 0.2356028805176417 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9772282838821411 0.000770308123249297 0.33137254901960783 0.33214285714285713

 ../data/dev/Period4.test
	Confusion Matrix
	 [197   0   0   1   0   0 306]
	 [  0 432   0   0   0   0  72]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 234  48   1 221]
	 [  0   0   0  14 274  69 147]
	 [  0   0   8   0 124 281  91]
	 [  0   3   2   2  98  64 341]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.39087302 0.85714286        nan 0.46428571 0.54365079 0.55753968
 0.66862745]
	Accuracy = 0.5805280528052805
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3909    0.5621       504
	              BookRestaurant     0.9931    0.8571    0.9201       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9323    0.4643    0.6199       504
	          SearchCreativeWork     0.5037    0.5437    0.5229       504
	        SearchScreeningEvent     0.6771    0.5575    0.6115       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2895    0.6686    0.4040       510
	
	                    accuracy                         0.5805      3030
	                   macro avg     0.6279    0.4974    0.5201      3030
	                weighted avg     0.7317    0.5805    0.6064      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.332, 0.331, 0.332, 0.812, 0.563
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.332, 0.812, 0.563
-----------------------------------------------------------------------------------------
Epoch  101: avg_loss: 0.20303374528884888 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9749546051025391 0.0005135387488328647 0.2901960784313726 0.2896825396825397

 ../data/dev/Period4.test
	Confusion Matrix
	 [333   0   0   3   0   0 168]
	 [  0 437   0   0   0   0  67]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 299  31   1 170]
	 [  0   0   0  12 240  61 191]
	 [  0   0  12   0 118 240 134]
	 [  0   5   2   2  83  56 362]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.66071429 0.86706349        nan 0.59325397 0.47619048 0.47619048
 0.70980392]
	Accuracy = 0.6306930693069307
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9911    0.6607    0.7929       504
	              BookRestaurant     0.9887    0.8671    0.9239       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9462    0.5933    0.7293       504
	          SearchCreativeWork     0.5085    0.4762    0.4918       504
	        SearchScreeningEvent     0.6704    0.4762    0.5568       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3315    0.7098    0.4519       510
	
	                    accuracy                         0.6307      3030
	                   macro avg     0.6338    0.5405    0.5638      3030
	                weighted avg     0.7386    0.6307    0.6574      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.290, 0.290, 0.290, 0.815, 0.615
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.290, 0.815, 0.615
-----------------------------------------------------------------------------------------
Epoch  102: avg_loss: 0.22799699008464813 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9843875765800476 0.00037348272642390157 0.2980392156862745 0.2984126984126984

 ../data/dev/Period4.test
	Confusion Matrix
	 [327   0   0   6   0   0 171]
	 [  0 413   0   0   0   0  91]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 324  31   1 144]
	 [  0   0   0  21 245  49 189]
	 [  0   0   4   0 139 204 157]
	 [  0   4   0   3  99  46 358]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.64880952 0.81944444        nan 0.64285714 0.48611111 0.4047619
 0.70196078]
	Accuracy = 0.6174917491749174
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9879    0.6488    0.7832       504
	              BookRestaurant     0.9904    0.8194    0.8969       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9153    0.6429    0.7552       504
	          SearchCreativeWork     0.4767    0.4861    0.4813       504
	        SearchScreeningEvent     0.6800    0.4048    0.5075       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3225    0.7020    0.4420       510
	
	                    accuracy                         0.6175      3030
	                   macro avg     0.6247    0.5291    0.5523      3030
	                weighted avg     0.7280    0.6175    0.6439      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.298, 0.298, 0.298, 0.810, 0.600
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.298, 0.810, 0.600
-----------------------------------------------------------------------------------------
Epoch  103: avg_loss: 0.20000777890284857 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9824092388153076 4.6685340802987696e-05 0.32941176470588235 0.32936507936507936

 ../data/dev/Period4.test
	Confusion Matrix
	 [339   0   0  10   0   0 155]
	 [  0 136   0   0   0   0 368]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 396  36   1  65]
	 [  0   0   0  38 306  50 110]
	 [  0   0   8   0 166 198 132]
	 [  0   0   2  11 118  37 342]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.67261905 0.26984127        nan 0.78571429 0.60714286 0.39285714
 0.67058824]
	Accuracy = 0.5666666666666667
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9826    0.6726    0.7986       504
	              BookRestaurant     1.0000    0.2698    0.4250       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8703    0.7857    0.8259       504
	          SearchCreativeWork     0.4888    0.6071    0.5416       504
	        SearchScreeningEvent     0.6923    0.3929    0.5013       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2918    0.6706    0.4067       510
	
	                    accuracy                         0.5667      3030
	                   macro avg     0.6180    0.4855    0.4999      3030
	                weighted avg     0.7201    0.5667    0.5828      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.329, 0.329, 0.329, 0.789, 0.546
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.329, 0.789, 0.546
-----------------------------------------------------------------------------------------
Epoch  104: avg_loss: 0.20574019104242325 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9853610992431641 7.002801120448154e-05 0.3058823529411765 0.305952380952381

 ../data/dev/Period4.test
	Confusion Matrix
	 [326   0   0   8   0   0 170]
	 [  0 270   0   0   0   0 234]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 381  31   1  88]
	 [  0   0   0  33 263  66 142]
	 [  0   0   4   0 158 205 137]
	 [  0   0   0   7  91  58 354]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6468254  0.53571429        nan 0.75595238 0.5218254  0.40674603
 0.69411765]
	Accuracy = 0.5937293729372938
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9909    0.6468    0.7827       504
	              BookRestaurant     1.0000    0.5357    0.6977       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8881    0.7560    0.8167       504
	          SearchCreativeWork     0.4843    0.5218    0.5024       504
	        SearchScreeningEvent     0.6212    0.4067    0.4916       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3147    0.6941    0.4330       510
	
	                    accuracy                         0.5937      3030
	                   macro avg     0.6142    0.5087    0.5320      3030
	                weighted avg     0.7157    0.5937    0.6203      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.306, 0.306, 0.306, 0.796, 0.573
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.306, 0.796, 0.573
-----------------------------------------------------------------------------------------
Epoch  105: avg_loss: 0.19906104852755865 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9827276468276978 0.00016339869281045694 0.3196078431372549 0.3194444444444444

 ../data/dev/Period4.test
	Confusion Matrix
	 [238   0   0   2   0   0 264]
	 [  0 435   0   0   0   0  69]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 290  29   1 182]
	 [  0   0   0  12 233  85 174]
	 [  0   0   5   0 130 253 116]
	 [  0   9   1   2  68  83 347]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.47222222 0.86309524        nan 0.57539683 0.46230159 0.50198413
 0.68039216]
	Accuracy = 0.5927392739273928
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9917    0.4722    0.6398       504
	              BookRestaurant     0.9797    0.8631    0.9177       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9477    0.5754    0.7160       504
	          SearchCreativeWork     0.5065    0.4623    0.4834       504
	        SearchScreeningEvent     0.5995    0.5020    0.5464       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3012    0.6804    0.4176       510
	
	                    accuracy                         0.5927      3030
	                   macro avg     0.6181    0.5079    0.5316      3030
	                weighted avg     0.7202    0.5927    0.6198      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.319, 0.320, 0.319, 0.806, 0.575
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.319, 0.806, 0.575
-----------------------------------------------------------------------------------------
Epoch  106: avg_loss: 0.22011175751686096 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9826143980026245 9.337068160597539e-05 0.29215686274509806 0.2920634920634921

 ../data/dev/Period4.test
	Confusion Matrix
	 [326   0   0   8   0   0 170]
	 [  0 342   0   0   0   0 162]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 349  33   0 119]
	 [  0   0   0  27 262  67 148]
	 [  0   0   2   0 159 206 137]
	 [  0   1   0   5  87  56 361]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6468254  0.67857143        nan 0.69246032 0.51984127 0.40873016
 0.70784314]
	Accuracy = 0.6092409240924093
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9909    0.6468    0.7827       504
	              BookRestaurant     0.9971    0.6786    0.8076       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8972    0.6925    0.7816       504
	          SearchCreativeWork     0.4843    0.5198    0.5014       504
	        SearchScreeningEvent     0.6261    0.4087    0.4946       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3291    0.7078    0.4493       510
	
	                    accuracy                         0.6092      3030
	                   macro avg     0.6178    0.5220    0.5453      3030
	                weighted avg     0.7200    0.6092    0.6358      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.292, 0.292, 0.292, 0.798, 0.589
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.292, 0.798, 0.589
-----------------------------------------------------------------------------------------
Epoch  107: avg_loss: 0.22948281715313593 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9829863905906677 0.00011671335200746924 0.2901960784313726 0.2900793650793651

 ../data/dev/Period4.test
	Confusion Matrix
	 [348   0   0   6   0   0 150]
	 [  0 444   0   0   0   0  60]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 303  25   0 168]
	 [  0   0   0  14 230  76 184]
	 [  0   0   2   0 123 210 169]
	 [  0   4   1   2  71  70 362]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.69047619 0.88095238        nan 0.60119048 0.45634921 0.41666667
 0.70980392]
	Accuracy = 0.6260726072607261
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9775    0.6905    0.8093       504
	              BookRestaurant     0.9911    0.8810    0.9328       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9323    0.6012    0.7310       504
	          SearchCreativeWork     0.5122    0.4563    0.4827       504
	        SearchScreeningEvent     0.5899    0.4167    0.4884       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3312    0.7098    0.4517       510
	
	                    accuracy                         0.6261      3030
	                   macro avg     0.6192    0.5365    0.5565      3030
	                weighted avg     0.7216    0.6261    0.6489      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.290, 0.290, 0.290, 0.800, 0.609
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.290, 0.800, 0.609
-----------------------------------------------------------------------------------------
Epoch  108: avg_loss: 0.21010914941628775 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9850583672523499 0.00011671335200746924 0.3235294117647059 0.32341269841269843

 ../data/dev/Period4.test
	Confusion Matrix
	 [297   0   0   2   0   0 205]
	 [  0 424   0   0   0   0  80]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 270  28   0 203]
	 [  0   0   0  11 256  71 166]
	 [  0   0   2   0 146 195 161]
	 [  0   4   1   3  86  71 345]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.58928571 0.84126984        nan 0.53571429 0.50793651 0.38690476
 0.67647059]
	Accuracy = 0.5897689768976898
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9900    0.5893    0.7388       504
	              BookRestaurant     0.9907    0.8413    0.9099       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9441    0.5357    0.6835       504
	          SearchCreativeWork     0.4961    0.5079    0.5020       504
	        SearchScreeningEvent     0.5786    0.3869    0.4637       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2974    0.6765    0.4132       510
	
	                    accuracy                         0.5898      3030
	                   macro avg     0.6138    0.5054    0.5302      3030
	                weighted avg     0.7153    0.5898    0.6181      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.323, 0.324, 0.323, 0.794, 0.572
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.323, 0.794, 0.572
-----------------------------------------------------------------------------------------
Epoch  109: avg_loss: 0.2455250397324562 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9797820448875427 0.00046685340802987696 0.3058823529411765 0.30634920634920637

 ../data/dev/Period4.test
	Confusion Matrix
	 [290   0   0   3   0   0 211]
	 [  0 355   0   0   0   0 149]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 319  44   1 138]
	 [  0   0   0  24 279  60 141]
	 [  0   0   2   0 168 201 133]
	 [  0   0   0   3 112  41 354]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.57539683 0.70436508        nan 0.63293651 0.55357143 0.39880952
 0.69411765]
	Accuracy = 0.5933993399339934
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9932    0.5754    0.7286       504
	              BookRestaurant     1.0000    0.7044    0.8265       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9140    0.6329    0.7479       504
	          SearchCreativeWork     0.4627    0.5536    0.5041       504
	        SearchScreeningEvent     0.6634    0.3988    0.4981       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3144    0.6941    0.4328       510
	
	                    accuracy                         0.5934      3030
	                   macro avg     0.6211    0.5085    0.5340      3030
	                weighted avg     0.7238    0.5934    0.6226      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.306, 0.306, 0.306, 0.796, 0.573
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.306, 0.796, 0.573
-----------------------------------------------------------------------------------------
Epoch  110: avg_loss: 0.23422651489575705 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9842029213905334 0.0003968253968253954 0.3 0.3003968253968254

 ../data/dev/Period4.test
	Confusion Matrix
	 [352   0   0   7   0   0 145]
	 [  0 284   0   0   0   0 220]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 363  31   2 106]
	 [  0   0   0  30 263  66 145]
	 [  0   0   1   0 158 204 141]
	 [  0   0   0   6  93  54 357]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6984127  0.56349206        nan 0.7202381  0.5218254  0.4047619
 0.7       ]
	Accuracy = 0.6016501650165017
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9944    0.6984    0.8205       504
	              BookRestaurant     1.0000    0.5635    0.7208       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8941    0.7202    0.7978       504
	          SearchCreativeWork     0.4826    0.5218    0.5014       504
	        SearchScreeningEvent     0.6258    0.4048    0.4916       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3205    0.7000    0.4397       510
	
	                    accuracy                         0.6017      3030
	                   macro avg     0.6167    0.5155    0.5388      3030
	                weighted avg     0.7187    0.6017    0.6283      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.300, 0.300, 0.300, 0.796, 0.582
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.300, 0.796, 0.582
-----------------------------------------------------------------------------------------
Epoch  111: avg_loss: 0.21818946053584418 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9836492538452148 0.00016339869281045694 0.3196078431372549 0.3194444444444444

 ../data/dev/Period4.test
	Confusion Matrix
	 [347   0   0   8   0   0 149]
	 [  0 185   0   0   0   0 319]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 381  30   2  88]
	 [  0   0   0  33 284  63 124]
	 [  0   0   1   0 178 200 125]
	 [  0   0   0   9  96  58 347]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.68849206 0.36706349        nan 0.75595238 0.56349206 0.3968254
 0.68039216]
	Accuracy = 0.5755775577557756
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9914    0.6885    0.8126       504
	              BookRestaurant     1.0000    0.3671    0.5370       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8840    0.7560    0.8150       504
	          SearchCreativeWork     0.4830    0.5635    0.5201       504
	        SearchScreeningEvent     0.6192    0.3968    0.4837       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3012    0.6804    0.4176       510
	
	                    accuracy                         0.5756      3030
	                   macro avg     0.6113    0.4932    0.5123      3030
	                weighted avg     0.7123    0.5756    0.5973      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.319, 0.320, 0.319, 0.791, 0.554
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.319, 0.791, 0.554
-----------------------------------------------------------------------------------------
Epoch  112: avg_loss: 0.2303073729077975 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9728858470916748 0.0005368814192343585 0.22156862745098038 0.22103174603174602

 ../data/dev/Period4.test
	Confusion Matrix
	 [443   0  10   0   0  51]
	 [  0 422   0   0   0  82]
	 [ 19   0 395  19   1  70]
	 [  0   0  33 242  53 176]
	 [  0   0   0 159 167 178]
	 [  1   1   8  72  31 397]
	Classwise Accuracies
	Labels
	[0.87896825 0.83730159 0.78373016 0.48015873 0.33134921 0.77843137]
	Accuracy = 0.6818481848184819
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9568    0.8790    0.9162       504
	              BookRestaurant     0.9976    0.8373    0.9105       504
	                   PlayMusic     0.8857    0.7837    0.8316       504
	          SearchCreativeWork     0.4919    0.4802    0.4859       504
	        SearchScreeningEvent     0.6627    0.3313    0.4418       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4161    0.7784    0.5423       510
	
	                    accuracy                         0.6818      3030
	                   macro avg     0.7351    0.6817    0.6881      3030
	                weighted avg     0.7345    0.6818    0.6878      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.221, 0.222, 0.221, 0.809, 0.662
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.221, 0.809, 0.662
-----------------------------------------------------------------------------------------
Epoch  113: avg_loss: 0.20089571177959442 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9749194383621216 0.00016339869281045694 0.2529411764705882 0.25277777777777777

 ../data/dev/Period4.test
	Confusion Matrix
	 [399   0   0   6   0   0  99]
	 [  0 454   0   0   0   0  50]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 345  23   1 125]
	 [  0   0   0  20 228  64 192]
	 [  0   0   6   0 143 184 171]
	 [  0   4   0   3  72  50 381]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.79166667 0.90079365        nan 0.68452381 0.45238095 0.36507937
 0.74705882]
	Accuracy = 0.6570957095709571
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9756    0.7917    0.8740       504
	              BookRestaurant     0.9913    0.9008    0.9439       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9225    0.6845    0.7859       504
	          SearchCreativeWork     0.4893    0.4524    0.4701       504
	        SearchScreeningEvent     0.6154    0.3651    0.4583       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3743    0.7471    0.4987       510
	
	                    accuracy                         0.6571      3030
	                   macro avg     0.6240    0.5631    0.5758      3030
	                weighted avg     0.7273    0.6571    0.6715      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.253, 0.253, 0.253, 0.799, 0.639
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.253, 0.799, 0.639
-----------------------------------------------------------------------------------------
Epoch  114: avg_loss: 0.214687742292881 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9751949310302734 4.6685340802987696e-05 0.27058823529411763 0.2706349206349206

 ../data/dev/Period4.test
	Confusion Matrix
	 [383   0   0   4   0   0 117]
	 [  0 372   0   0   0   0 132]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 351  27   1 123]
	 [  0   0   9  22 237  66 170]
	 [  0   0  14   0 142 208 140]
	 [  0   0   4   2  83  49 372]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.75992063 0.73809524        nan 0.69642857 0.4702381  0.41269841
 0.72941176]
	Accuracy = 0.6346534653465347
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9948    0.7599    0.8616       504
	              BookRestaurant     1.0000    0.7381    0.8493       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9261    0.6964    0.7950       504
	          SearchCreativeWork     0.4847    0.4702    0.4773       504
	        SearchScreeningEvent     0.6420    0.4127    0.5024       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3529    0.7294    0.4757       510
	
	                    accuracy                         0.6347      3030
	                   macro avg     0.6286    0.5438    0.5659      3030
	                weighted avg     0.7327    0.6347    0.6599      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.271, 0.271, 0.271, 0.787, 0.615
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.271, 0.787, 0.615
-----------------------------------------------------------------------------------------
Epoch  115: avg_loss: 0.22147412101427713 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9872791767120361 0.00018674136321195078 0.3156862745098039 0.31587301587301586

 ../data/dev/Period4.test
	Confusion Matrix
	 [361   0   5   0   0 138]
	 [  0 259   0   0   0 245]
	 [  3   0 377  33   1  90]
	 [  0   0  31 246  72 155]
	 [  0   0   1 114 221 168]
	 [  0   0   8 106  47 349]
	Classwise Accuracies
	Labels
	[0.71626984 0.51388889 0.74801587 0.48809524 0.43849206 0.68431373]
	Accuracy = 0.5983498349834984
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9918    0.7163    0.8318       504
	              BookRestaurant     1.0000    0.5139    0.6789       504
	                   PlayMusic     0.8934    0.7480    0.8143       504
	          SearchCreativeWork     0.4930    0.4881    0.4905       504
	        SearchScreeningEvent     0.6481    0.4385    0.5231       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3048    0.6843    0.4218       510
	
	                    accuracy                         0.5983      3030
	                   macro avg     0.7218    0.5982    0.6267      3030
	                weighted avg     0.7210    0.5983    0.6263      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.316, 0.316, 0.316, 0.809, 0.581
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.316, 0.809, 0.581
-----------------------------------------------------------------------------------------
Epoch  116: avg_loss: 0.20908081779877344 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9888154864311218 0.0005135387488328647 0.3431372549019608 0.34365079365079365

 ../data/dev/Period4.test
	Confusion Matrix
	 [361   0   0   5   0   0 138]
	 [  0  62   0   0   0   0 442]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 410  29   0  62]
	 [  0   0   0  37 288  78 101]
	 [  0   0   1   1 103 276 123]
	 [  0   0   0  19 130  26 335]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.71626984 0.12301587        nan 0.81349206 0.57142857 0.54761905
 0.65686275]
	Accuracy = 0.5716171617161716
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9918    0.7163    0.8318       504
	              BookRestaurant     1.0000    0.1230    0.2191       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8686    0.8135    0.8402       504
	          SearchCreativeWork     0.5236    0.5714    0.5465       504
	        SearchScreeningEvent     0.7263    0.5476    0.6244       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2789    0.6569    0.3916       510
	
	                    accuracy                         0.5716      3030
	                   macro avg     0.6270    0.4898    0.4934      3030
	                weighted avg     0.7307    0.5716    0.5752      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.344, 0.343, 0.344, 0.821, 0.554
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.344, 0.821, 0.554
-----------------------------------------------------------------------------------------
Epoch  117: avg_loss: 0.23345023890336355 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.981711745262146 4.6685340802987696e-05 0.296078431372549 0.29603174603174603

 ../data/dev/Period4.test
	Confusion Matrix
	 [389   0   4   0   0 111]
	 [  0 204   0   0   0 300]
	 [  3   0 411  21   0  69]
	 [  0   0  35 275  67 127]
	 [  0   0   1 152 212 139]
	 [  0   0  16 108  27 359]
	Classwise Accuracies
	Labels
	[0.7718254  0.4047619  0.81547619 0.54563492 0.42063492 0.70392157]
	Accuracy = 0.6105610561056105
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9923    0.7718    0.8683       504
	              BookRestaurant     1.0000    0.4048    0.5763       504
	                   PlayMusic     0.8801    0.8155    0.8465       504
	          SearchCreativeWork     0.4946    0.5456    0.5189       504
	        SearchScreeningEvent     0.6928    0.4206    0.5235       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3249    0.7039    0.4446       510
	
	                    accuracy                         0.6106      3030
	                   macro avg     0.7308    0.6104    0.6297      3030
	                weighted avg     0.7300    0.6106    0.6293      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.296, 0.296, 0.296, 0.809, 0.592
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.296, 0.809, 0.592
-----------------------------------------------------------------------------------------
Epoch  118: avg_loss: 0.23396868507067362 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9701350927352905 0.0007236227824463093 0.2607843137254902 0.2615079365079365

 ../data/dev/Period4.test
	Confusion Matrix
	 [335   0   0   1   0   0 168]
	 [  0 457   0   0   0   0  47]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 297  19   1 185]
	 [  0   0   0  17 234  99 154]
	 [  0   0   5   0 150 244 105]
	 [  0   5   1   2  65  60 377]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.66468254 0.90674603        nan 0.58928571 0.46428571 0.48412698
 0.73921569]
	Accuracy = 0.6415841584158416
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9941    0.6647    0.7967       504
	              BookRestaurant     0.9892    0.9067    0.9462       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9369    0.5893    0.7235       504
	          SearchCreativeWork     0.5000    0.4643    0.4815       504
	        SearchScreeningEvent     0.6040    0.4841    0.5374       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3639    0.7392    0.4877       510
	
	                    accuracy                         0.6416      3030
	                   macro avg     0.6269    0.5498    0.5676      3030
	                weighted avg     0.7306    0.6416    0.6618      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.261, 0.261, 0.262, 0.800, 0.622
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.261, 0.800, 0.622
-----------------------------------------------------------------------------------------
Epoch  119: avg_loss: 0.20679309715827307 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9798113703727722 0.0001400560224089631 0.3784313725490196 0.37857142857142856

 ../data/dev/Period4.test
	Confusion Matrix
	 [116   0   0   0   0   0 388]
	 [  0 473   0   0   0   0  31]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 150  24   3 327]
	 [  0   0   1   2 243 118 140]
	 [  0   1   5   0 142 288  68]
	 [  0  11   1   1  61 119 317]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.23015873 0.93849206        nan 0.29761905 0.48214286 0.57142857
 0.62156863]
	Accuracy = 0.5237623762376238
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2302    0.3742       504
	              BookRestaurant     0.9753    0.9385    0.9565       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9804    0.2976    0.4566       504
	          SearchCreativeWork     0.5170    0.4821    0.4990       504
	        SearchScreeningEvent     0.5455    0.5714    0.5581       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2494    0.6216    0.3560       510
	
	                    accuracy                         0.5238      3030
	                   macro avg     0.6096    0.4488    0.4572      3030
	                weighted avg     0.7103    0.5238    0.5331      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.379, 0.378, 0.379, 0.796, 0.504
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.379, 0.796, 0.504
-----------------------------------------------------------------------------------------
Epoch  120: avg_loss: 0.20425398151079813 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9763710498809814 0.0005835667600373462 0.34901960784313724 0.3496031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [231   0   0   0   0   0 273]
	 [  0 480   0   0   0   0  24]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 150  16   2 336]
	 [  0   0   1   4 231 110 158]
	 [  0   1   8   0 115 290  90]
	 [  0  17   2   1  52 106 332]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.45833333 0.95238095        nan 0.29761905 0.45833333 0.57539683
 0.65098039]
	Accuracy = 0.5656765676567657
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4583    0.6286       504
	              BookRestaurant     0.9639    0.9524    0.9581       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9677    0.2976    0.4552       504
	          SearchCreativeWork     0.5580    0.4583    0.5033       504
	        SearchScreeningEvent     0.5709    0.5754    0.5731       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2737    0.6510    0.3854       510
	
	                    accuracy                         0.5657      3030
	                   macro avg     0.6192    0.4847    0.5005      3030
	                weighted avg     0.7215    0.5657    0.5835      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.350, 0.349, 0.350, 0.804, 0.548
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.350, 0.804, 0.548
-----------------------------------------------------------------------------------------
Epoch  121: avg_loss: 0.24088743329048157 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9806926250457764 0.00023342670401493848 0.2803921568627451 0.28015873015873016

 ../data/dev/Period4.test
	Confusion Matrix
	 [325   0   0   2   0   0 177]
	 [  0 334   0   0   0   0 170]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 360  22   1 119]
	 [  0   0   0  25 256  92 131]
	 [  0   0   4   0 171 220 109]
	 [  0   1   1   5  80  56 367]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.64484127 0.66269841        nan 0.71428571 0.50793651 0.43650794
 0.71960784]
	Accuracy = 0.6145214521452145
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9939    0.6448    0.7822       504
	              BookRestaurant     0.9970    0.6627    0.7962       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9184    0.7143    0.8036       504
	          SearchCreativeWork     0.4839    0.5079    0.4956       504
	        SearchScreeningEvent     0.5962    0.4365    0.5040       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3420    0.7196    0.4637       510
	
	                    accuracy                         0.6145      3030
	                   macro avg     0.6188    0.5266    0.5493      3030
	                weighted avg     0.7212    0.6145    0.6405      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.280, 0.280, 0.280, 0.787, 0.593
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.280, 0.787, 0.593
-----------------------------------------------------------------------------------------
Epoch  122: avg_loss: 0.22899467994769415 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9822325706481934 0.00018674136321195078 0.3156862745098039 0.31587301587301586

 ../data/dev/Period4.test
	Confusion Matrix
	 [261   0   0   3   0   0 240]
	 [  0 246   0   0   0   0 258]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 367  27   1 108]
	 [  0   0   0  28 287  91  98]
	 [  0   0   4   0 183 225  92]
	 [  0   1   0   5 104  51 349]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.51785714 0.48809524        nan 0.7281746  0.56944444 0.44642857
 0.68431373]
	Accuracy = 0.5726072607260726
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9962    0.5179    0.6815       504
	              BookRestaurant     0.9960    0.4881    0.6551       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9107    0.7282    0.8093       504
	          SearchCreativeWork     0.4775    0.5694    0.5195       504
	        SearchScreeningEvent     0.6114    0.4464    0.5161       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3048    0.6843    0.4218       510
	
	                    accuracy                         0.5726      3030
	                   macro avg     0.6138    0.4906    0.5147      3030
	                weighted avg     0.7153    0.5726    0.6002      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.316, 0.316, 0.316, 0.785, 0.550
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.316, 0.785, 0.550
-----------------------------------------------------------------------------------------
Epoch  123: avg_loss: 0.23835123578707376 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9872064590454102 4.6685340802987696e-05 0.3627450980392157 0.3626984126984127

 ../data/dev/Period4.test
	Confusion Matrix
	 [165   0   0   1   0   0 338]
	 [  0 264   0   0   0   0 240]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 320  28   1 155]
	 [  0   0   1  22 289  94  98]
	 [  0   0   8   0 197 216  83]
	 [  0   0   6   2 100  77 325]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.32738095 0.52380952        nan 0.63492063 0.5734127  0.42857143
 0.6372549 ]
	Accuracy = 0.5211221122112211
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3274    0.4933       504
	              BookRestaurant     1.0000    0.5238    0.6875       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9275    0.6349    0.7538       504
	          SearchCreativeWork     0.4707    0.5734    0.5170       504
	        SearchScreeningEvent     0.5567    0.4286    0.4843       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2623    0.6373    0.3716       510
	
	                    accuracy                         0.5211      3030
	                   macro avg     0.6025    0.4465    0.4725      3030
	                weighted avg     0.7020    0.5211    0.5509      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.363, 0.363, 0.363, 0.773, 0.498
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.363, 0.773, 0.498
-----------------------------------------------------------------------------------------
Epoch  124: avg_loss: 0.1913295735915502 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9923590421676636 0.0007469654528478031 0.3627450980392157 0.3634920634920635

 ../data/dev/Period4.test
	Confusion Matrix
	 [186   0   0   1   0   0 317]
	 [  0 305   0   0   0   0 199]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 300  27   2 175]
	 [  0   0   0  18 266  93 127]
	 [  0   0   4   0 172 230  98]
	 [  0   0   1   2  91  91 325]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36904762 0.60515873        nan 0.5952381  0.52777778 0.45634921
 0.6372549 ]
	Accuracy = 0.532013201320132
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3690    0.5391       504
	              BookRestaurant     1.0000    0.6052    0.7540       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9346    0.5952    0.7273       504
	          SearchCreativeWork     0.4784    0.5278    0.5019       504
	        SearchScreeningEvent     0.5529    0.4563    0.5000       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2619    0.6373    0.3712       510
	
	                    accuracy                         0.5320      3030
	                   macro avg     0.6040    0.4558    0.4848      3030
	                weighted avg     0.7038    0.5320    0.5652      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.363, 0.363, 0.363, 0.788, 0.511
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.363, 0.788, 0.511
-----------------------------------------------------------------------------------------
Epoch  125: avg_loss: 0.23540070404609045 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9795914888381958 0.00030345471521942 0.3254901960784314 0.3257936507936508

 ../data/dev/Period4.test
	Confusion Matrix
	 [218   0   0   1   0   0 285]
	 [  0 425   0   0   0   0  79]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 256  19   2 227]
	 [  0   0   1   9 263  85 146]
	 [  0   0   6   0 190 224  84]
	 [  0   3   1   2  68  92 344]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.43253968 0.84325397        nan 0.50793651 0.5218254  0.44444444
 0.6745098 ]
	Accuracy = 0.570957095709571
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4325    0.6039       504
	              BookRestaurant     0.9930    0.8433    0.9120       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9552    0.5079    0.6632       504
	          SearchCreativeWork     0.4870    0.5218    0.5038       504
	        SearchScreeningEvent     0.5558    0.4444    0.4939       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2953    0.6745    0.4107       510
	
	                    accuracy                         0.5710      3030
	                   macro avg     0.6123    0.4892    0.5125      3030
	                weighted avg     0.7136    0.5710    0.5976      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.326, 0.325, 0.326, 0.788, 0.550
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.326, 0.788, 0.550
-----------------------------------------------------------------------------------------
Epoch  126: avg_loss: 0.1847700017193953 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9885085821151733 0.0006302521008403339 0.3196078431372549 0.3202380952380952

 ../data/dev/Period4.test
	Confusion Matrix
	 [299   0   0   3   0   0 202]
	 [  0 195   0   0   0   0 309]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 384  28   0  90]
	 [  0   0   0  29 291  93  91]
	 [  0   0   2   1 181 205 115]
	 [  0   0   0   8  99  56 347]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.59325397 0.38690476        nan 0.76190476 0.57738095 0.40674603
 0.68039216]
	Accuracy = 0.567986798679868
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9934    0.5933    0.7429       504
	              BookRestaurant     1.0000    0.3869    0.5579       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9035    0.7619    0.8267       504
	          SearchCreativeWork     0.4858    0.5774    0.5277       504
	        SearchScreeningEvent     0.5791    0.4067    0.4779       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3007    0.6804    0.4171       510
	
	                    accuracy                         0.5680      3030
	                   macro avg     0.6089    0.4867    0.5072      3030
	                weighted avg     0.7096    0.5680    0.5913      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.320, 0.320, 0.320, 0.787, 0.545
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.320, 0.787, 0.545
-----------------------------------------------------------------------------------------
Epoch  127: avg_loss: 0.22962848593791327 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.990156888961792 0.0004435107376283831 0.32941176470588235 0.32896825396825397

 ../data/dev/Period4.test
	Confusion Matrix
	 [282   0   0   3   0   0 219]
	 [  0 251   0   0   0   0 253]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 368  28   0 106]
	 [  0   0   0  25 278  83 118]
	 [  0   0   1   0 174 196 133]
	 [  0   0   0   5  96  67 342]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.55952381 0.49801587        nan 0.73015873 0.5515873  0.38888889
 0.67058824]
	Accuracy = 0.5666666666666667
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9930    0.5595    0.7157       504
	              BookRestaurant     1.0000    0.4980    0.6649       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9177    0.7302    0.8133       504
	          SearchCreativeWork     0.4826    0.5516    0.5148       504
	        SearchScreeningEvent     0.5665    0.3889    0.4612       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2921    0.6706    0.4069       510
	
	                    accuracy                         0.5667      3030
	                   macro avg     0.6074    0.4855    0.5110      3030
	                weighted avg     0.7078    0.5667    0.5958      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.329, 0.329, 0.329, 0.790, 0.546
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.329, 0.790, 0.546
-----------------------------------------------------------------------------------------
Epoch  128: avg_loss: 0.23729034016529718 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9885351657867432 0.00011671335200746924 0.3431372549019608 0.34325396825396826

 ../data/dev/Period4.test
	Confusion Matrix
	 [259   0   0   2   0   0 243]
	 [  0 300   0   0   0   0 204]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 320  27   0 155]
	 [  0   0   0  18 261  81 144]
	 [  0   0   4   0 156 225 119]
	 [  0   0   1   3  94  77 335]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.51388889 0.5952381         nan 0.63492063 0.51785714 0.44642857
 0.65686275]
	Accuracy = 0.5610561056105611
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9923    0.5139    0.6771       504
	              BookRestaurant     1.0000    0.5952    0.7463       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9329    0.6349    0.7556       504
	          SearchCreativeWork     0.4851    0.5179    0.5010       504
	        SearchScreeningEvent     0.5875    0.4464    0.5073       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2792    0.6569    0.3918       510
	
	                    accuracy                         0.5611      3030
	                   macro avg     0.6110    0.4807    0.5113      3030
	                weighted avg     0.7120    0.5611    0.5961      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.343, 0.343, 0.343, 0.791, 0.542
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.343, 0.791, 0.542
-----------------------------------------------------------------------------------------
Epoch  129: avg_loss: 0.19712846477826437 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9888916015625 9.337068160597539e-05 0.37450980392156863 0.3746031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [207   0   0   1   0   0 296]
	 [  0 169   0   0   0   0 335]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 339  33   1 131]
	 [  0   0   4  25 288  95  92]
	 [  0   0   8   0 180 226  90]
	 [  0   0   6   3 110  72 319]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.41071429 0.33531746        nan 0.67261905 0.57142857 0.4484127
 0.6254902 ]
	Accuracy = 0.5108910891089109
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4107    0.5823       504
	              BookRestaurant     1.0000    0.3353    0.5022       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9212    0.6726    0.7775       504
	          SearchCreativeWork     0.4714    0.5714    0.5166       504
	        SearchScreeningEvent     0.5736    0.4484    0.5033       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2526    0.6255    0.3598       510
	
	                    accuracy                         0.5109      3030
	                   macro avg     0.6027    0.4377    0.4631      3030
	                weighted avg     0.7022    0.5109    0.5399      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.375, 0.375, 0.375, 0.774, 0.488
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.375, 0.774, 0.488
-----------------------------------------------------------------------------------------
Epoch  130: avg_loss: 0.22782002141078314 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.987625241279602 0.0009103641456582601 0.3431372549019608 0.34404761904761905

 ../data/dev/Period4.test
	Confusion Matrix
	 [233   0   0   2   0   0 269]
	 [  0 203   0   0   0   0 301]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 351  33   0 119]
	 [  0   0   0  26 303  87  88]
	 [  0   0   3   0 170 241  90]
	 [  0   0   0   4 122  49 335]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.46230159 0.40277778        nan 0.69642857 0.60119048 0.4781746
 0.65686275]
	Accuracy = 0.5498349834983498
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9957    0.4623    0.6314       504
	              BookRestaurant     1.0000    0.4028    0.5743       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9164    0.6964    0.7914       504
	          SearchCreativeWork     0.4825    0.6012    0.5353       504
	        SearchScreeningEvent     0.6393    0.4782    0.5471       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2787    0.6569    0.3914       510
	
	                    accuracy                         0.5498      3030
	                   macro avg     0.6161    0.4711    0.4958      3030
	                weighted avg     0.7179    0.5498    0.5781      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.344, 0.343, 0.344, 0.799, 0.528
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.344, 0.799, 0.528
-----------------------------------------------------------------------------------------
Epoch  131: avg_loss: 0.20915516465902328 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9863044023513794 0.00016339869281045694 0.34705882352941175 0.3472222222222222

 ../data/dev/Period4.test
	Confusion Matrix
	 [166   0   0   1   0   0 337]
	 [  0 355   0   0   0   0 149]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 282  33   1 188]
	 [  0   0   0  14 298  69 123]
	 [  0   0   3   0 182 241  78]
	 [  0   2   1   2 123  49 333]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.32936508 0.70436508        nan 0.55952381 0.59126984 0.4781746
 0.65294118]
	Accuracy = 0.5528052805280528
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3294    0.4955       504
	              BookRestaurant     0.9944    0.7044    0.8246       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9431    0.5595    0.7024       504
	          SearchCreativeWork     0.4686    0.5913    0.5228       504
	        SearchScreeningEvent     0.6694    0.4782    0.5579       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2757    0.6529    0.3877       510
	
	                    accuracy                         0.5528      3030
	                   macro avg     0.6216    0.4737    0.4987      3030
	                weighted avg     0.7243    0.5528    0.5814      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.347, 0.347, 0.347, 0.800, 0.533
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.347, 0.800, 0.533
-----------------------------------------------------------------------------------------
Epoch  132: avg_loss: 0.22062988579273224 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9889650344848633 0.0008636788048552724 0.3392156862745098 0.3400793650793651

 ../data/dev/Period4.test
	Confusion Matrix
	 [291   0   0   3   0   0 210]
	 [  0 173   0   0   0   0 331]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 351  32   1 118]
	 [  0   0   2  24 280  95 103]
	 [  0   0   5   0 167 237  95]
	 [  0   0   1   5 107  60 337]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.57738095 0.34325397        nan 0.69642857 0.55555556 0.4702381
 0.66078431]
	Accuracy = 0.5508250825082508
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9932    0.5774    0.7302       504
	              BookRestaurant     1.0000    0.3433    0.5111       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9164    0.6964    0.7914       504
	          SearchCreativeWork     0.4778    0.5556    0.5138       504
	        SearchScreeningEvent     0.6031    0.4702    0.5284       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2822    0.6608    0.3955       510
	
	                    accuracy                         0.5508      3030
	                   macro avg     0.6104    0.4719    0.4958      3030
	                weighted avg     0.7113    0.5508    0.5781      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.340, 0.339, 0.340, 0.790, 0.529
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.340, 0.790, 0.529
-----------------------------------------------------------------------------------------
Epoch  133: avg_loss: 0.18922847509384155 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9851546287536621 0.0004435107376283831 0.296078431372549 0.29563492063492064

 ../data/dev/Period4.test
	Confusion Matrix
	 [443   0   8   0   0  53]
	 [  0  62   0   0   0 442]
	 [ 12   0 448  13   1  30]
	 [  0   0  37 306  60 101]
	 [  0   0   2 162 221 119]
	 [  1   0  15 117  18 359]
	Classwise Accuracies
	Labels
	[0.87896825 0.12301587 0.88888889 0.60714286 0.43849206 0.70392157]
	Accuracy = 0.6069306930693069
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9715    0.8790    0.9229       504
	              BookRestaurant     1.0000    0.1230    0.2191       504
	                   PlayMusic     0.8784    0.8889    0.8836       504
	          SearchCreativeWork     0.5117    0.6071    0.5554       504
	        SearchScreeningEvent     0.7367    0.4385    0.5498       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3252    0.7039    0.4449       510
	
	                    accuracy                         0.6069      3030
	                   macro avg     0.7372    0.6067    0.5959      3030
	                weighted avg     0.7364    0.6069    0.5956      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.296, 0.296, 0.296, 0.831, 0.587
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.296, 0.831, 0.587
-----------------------------------------------------------------------------------------
Epoch  134: avg_loss: 0.1988712747891744 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9820772409439087 0.00023342670401493848 0.3137254901960784 0.3134920634920635

 ../data/dev/Period4.test
	Confusion Matrix
	 [389   0   0   6   0   0 109]
	 [  0  72   0   0   0   0 432]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 425  16   1  59]
	 [  0   0   0  36 306  67  95]
	 [  0   0   1   2 169 237  95]
	 [  0   0   0  18 116  26 350]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.7718254  0.14285714        nan 0.84325397 0.60714286 0.4702381
 0.68627451]
	Accuracy = 0.5871287128712871
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9923    0.7718    0.8683       504
	              BookRestaurant     1.0000    0.1429    0.2500       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8727    0.8433    0.8577       504
	          SearchCreativeWork     0.5041    0.6071    0.5509       504
	        SearchScreeningEvent     0.7160    0.4702    0.5677       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3070    0.6863    0.4242       510
	
	                    accuracy                         0.5871      3030
	                   macro avg     0.6275    0.5031    0.5027      3030
	                weighted avg     0.7312    0.5871    0.5861      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.314, 0.314, 0.313, 0.813, 0.567
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.314, 0.813, 0.567
-----------------------------------------------------------------------------------------
Epoch  135: avg_loss: 0.21977956841389337 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9762977361679077 0.00025676937441643233 0.24509803921568626 0.24484126984126983

 ../data/dev/Period4.test
	Confusion Matrix
	 [393   0   0   4   0   0 107]
	 [  0 263   0   0   0   0 241]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 412  15   1  72]
	 [  0   0   0  36 293  68 107]
	 [  0   0   1   2 173 238  90]
	 [  0   0   0  14  97  14 385]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.7797619  0.5218254         nan 0.81746032 0.58134921 0.47222222
 0.75490196]
	Accuracy = 0.6547854785478547
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9899    0.7798    0.8724       504
	              BookRestaurant     1.0000    0.5218    0.6858       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8803    0.8175    0.8477       504
	          SearchCreativeWork     0.5069    0.5813    0.5416       504
	        SearchScreeningEvent     0.7414    0.4722    0.5770       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3842    0.7549    0.5093       510
	
	                    accuracy                         0.6548      3030
	                   macro avg     0.6433    0.5611    0.5762      3030
	                weighted avg     0.7497    0.6548    0.6720      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.245, 0.245, 0.245, 0.815, 0.635
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.245, 0.815, 0.635
-----------------------------------------------------------------------------------------
Epoch  136: avg_loss: 0.19463912397623062 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9808973670005798 0.00011671335200746924 0.2568627450980392 0.2567460317460317

 ../data/dev/Period4.test
	Confusion Matrix
	 [451   0   8   0   0  45]
	 [  0 173   0   0   0 331]
	 [ 10   0 451  10   0  33]
	 [  0   0  36 291  60 117]
	 [  0   0   3 169 211 121]
	 [  1   0  16  94  20 379]
	Classwise Accuracies
	Labels
	[0.89484127 0.34325397 0.89484127 0.57738095 0.41865079 0.74313725]
	Accuracy = 0.6455445544554456
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9762    0.8948    0.9337       504
	              BookRestaurant     1.0000    0.3433    0.5111       504
	                   PlayMusic     0.8774    0.8948    0.8861       504
	          SearchCreativeWork     0.5160    0.5774    0.5449       504
	        SearchScreeningEvent     0.7251    0.4187    0.5308       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3694    0.7431    0.4935       510
	
	                    accuracy                         0.6455      3030
	                   macro avg     0.7440    0.6454    0.6500      3030
	                weighted avg     0.7433    0.6455    0.6497      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.257, 0.257, 0.257, 0.828, 0.626
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.257, 0.828, 0.626
-----------------------------------------------------------------------------------------
Epoch  137: avg_loss: 0.23448744416236877 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9827352166175842 0.0001400560224089631 0.24509803921568626 0.24523809523809523

 ../data/dev/Period4.test
	Confusion Matrix
	 [404   0   0   4   0   0  96]
	 [  0 278   0   0   0   0 226]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 405  18   0  79]
	 [  0   0   0  35 285  82 102]
	 [  0   0   2   1 180 206 115]
	 [  1   0   0   7  84  33 385]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.8015873  0.5515873         nan 0.80357143 0.56547619 0.40873016
 0.75490196]
	Accuracy = 0.6478547854785478
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9926    0.8016    0.8869       504
	              BookRestaurant     1.0000    0.5516    0.7110       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8960    0.8036    0.8473       504
	          SearchCreativeWork     0.5026    0.5655    0.5322       504
	        SearchScreeningEvent     0.6417    0.4087    0.4994       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3838    0.7549    0.5089       510
	
	                    accuracy                         0.6479      3030
	                   macro avg     0.6310    0.5551    0.5694      3030
	                weighted avg     0.7354    0.6479    0.6640      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.245, 0.245, 0.245, 0.810, 0.626
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.245, 0.810, 0.626
-----------------------------------------------------------------------------------------
Epoch  138: avg_loss: 0.19721010078986487 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9854117035865784 0.0006769374416433216 0.27647058823529413 0.2757936507936508

 ../data/dev/Period4.test
	Confusion Matrix
	 [303   0   0   1   0   0 200]
	 [  0 361   0   0   0   0 143]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 344  16   0 144]
	 [  0   0   0  22 297  72 113]
	 [  0   0   2   0 189 218  95]
	 [  0   1   1   2  92  45 369]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.60119048 0.71626984        nan 0.68253968 0.58928571 0.43253968
 0.72352941]
	Accuracy = 0.6244224422442244
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6012    0.7509       504
	              BookRestaurant     0.9972    0.7163    0.8337       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9322    0.6825    0.7881       504
	          SearchCreativeWork     0.5000    0.5893    0.5410       504
	        SearchScreeningEvent     0.6507    0.4325    0.5197       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3468    0.7235    0.4689       510
	
	                    accuracy                         0.6244      3030
	                   macro avg     0.6324    0.5351    0.5575      3030
	                weighted avg     0.7371    0.6244    0.6500      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.276, 0.276, 0.276, 0.804, 0.604
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.276, 0.804, 0.604
-----------------------------------------------------------------------------------------
Epoch  139: avg_loss: 0.201398437221845 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9749779105186462 4.6685340802987696e-05 0.22941176470588234 0.22936507936507936

 ../data/dev/Period4.test
	Confusion Matrix
	 [404   0   0   2   0   0  98]
	 [  0 364   0   0   0   0 140]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 391  10   1 100]
	 [  0   0   0  33 266  66 139]
	 [  0   0   3   1 203 196 101]
	 [  0   0   0   4  68  45 393]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.8015873  0.72222222        nan 0.77579365 0.52777778 0.38888889
 0.77058824]
	Accuracy = 0.6646864686468646
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9951    0.8016    0.8879       504
	              BookRestaurant     1.0000    0.7222    0.8387       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9072    0.7758    0.8364       504
	          SearchCreativeWork     0.4863    0.5278    0.5062       504
	        SearchScreeningEvent     0.6364    0.3889    0.4828       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4047    0.7706    0.5307       510
	
	                    accuracy                         0.6647      3030
	                   macro avg     0.6328    0.5696    0.5832      3030
	                weighted avg     0.7376    0.6647    0.6801      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.229, 0.229, 0.229, 0.804, 0.643
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.229, 0.804, 0.643
-----------------------------------------------------------------------------------------
Epoch  140: avg_loss: 0.21369902789592743 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9773638248443604 9.337068160597539e-05 0.25882352941176473 0.25873015873015875

 ../data/dev/Period4.test
	Confusion Matrix
	 [453   0   0   7   0   0  44]
	 [  0 277   0   0   0   0 227]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 433  10   0  51]
	 [  0   0   0  35 279  35 155]
	 [  0   0   3   1 172 153 175]
	 [  1   0   0  12 103  16 378]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.89880952 0.54960317        nan 0.85912698 0.55357143 0.30357143
 0.74117647]
	Accuracy = 0.6511551155115511
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9763    0.8988    0.9360       504
	              BookRestaurant     1.0000    0.5496    0.7093       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8873    0.8591    0.8730       504
	          SearchCreativeWork     0.4947    0.5536    0.5225       504
	        SearchScreeningEvent     0.7500    0.3036    0.4322       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3670    0.7412    0.4909       510
	
	                    accuracy                         0.6512      3030
	                   macro avg     0.6393    0.5580    0.5663      3030
	                weighted avg     0.7451    0.6512    0.6603      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.259, 0.259, 0.259, 0.814, 0.633
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.259, 0.814, 0.633
-----------------------------------------------------------------------------------------
Epoch  141: avg_loss: 0.20707386980454126 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9840510487556458 9.337068160597539e-05 0.307843137254902 0.30793650793650795

 ../data/dev/Period4.test
	Confusion Matrix
	 [384   0   0   4   0   0 116]
	 [  0 248   0   0   0   0 256]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 390  13   0  99]
	 [  0   0   0  32 292  39 141]
	 [  0   0   4   1 174 161 164]
	 [  1   0   0   6 133  17 353]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.76190476 0.49206349        nan 0.77380952 0.57936508 0.31944444
 0.69215686]
	Accuracy = 0.6033003300330033
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9922    0.7619    0.8620       504
	              BookRestaurant     1.0000    0.4921    0.6596       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9007    0.7738    0.8324       504
	          SearchCreativeWork     0.4771    0.5794    0.5233       504
	        SearchScreeningEvent     0.7419    0.3194    0.4466       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3127    0.6922    0.4308       510
	
	                    accuracy                         0.6033      3030
	                   macro avg     0.6321    0.5170    0.5364      3030
	                weighted avg     0.7366    0.6033    0.6254      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.308, 0.308, 0.308, 0.816, 0.585
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.308, 0.816, 0.585
-----------------------------------------------------------------------------------------
Epoch  142: avg_loss: 0.19081156825025877 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9692659974098206 0.0 0.26666666666666666 0.26666666666666666

 ../data/dev/Period4.test
	Confusion Matrix
	 [353   0   0   1   0   0 150]
	 [  0 446   0   0   0   0  58]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 294   7   1 202]
	 [  0   0   2  13 271  55 163]
	 [  0   0   3   0 186 216  99]
	 [  0   1   2   2 100  31 374]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.70039683 0.88492063        nan 0.58333333 0.53769841 0.42857143
 0.73333333]
	Accuracy = 0.6448844884488449
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.7004    0.8238       504
	              BookRestaurant     0.9978    0.8849    0.9380       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9484    0.5833    0.7224       504
	          SearchCreativeWork     0.4805    0.5377    0.5075       504
	        SearchScreeningEvent     0.7129    0.4286    0.5353       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3576    0.7333    0.4807       510
	
	                    accuracy                         0.6449      3030
	                   macro avg     0.6424    0.5526    0.5725      3030
	                weighted avg     0.7487    0.6449    0.6676      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.267, 0.267, 0.267, 0.820, 0.627
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.267, 0.820, 0.627
-----------------------------------------------------------------------------------------
Epoch  143: avg_loss: 0.1862920100490252 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.990451991558075 0.0006769374416433216 0.39019607843137255 0.39087301587301587

 ../data/dev/Period4.test
	Confusion Matrix
	 [144   0   0   1   0   0 359]
	 [  0 271   0   0   0   0 233]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 318  16   1 169]
	 [  0   0   0  24 293  70 117]
	 [  0   0   3   1 142 251 107]
	 [  0   0   0   2 139  58 311]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.28571429 0.53769841        nan 0.63095238 0.58134921 0.49801587
 0.60980392]
	Accuracy = 0.524092409240924
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2857    0.4444       504
	              BookRestaurant     1.0000    0.5377    0.6994       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9191    0.6310    0.7482       504
	          SearchCreativeWork     0.4966    0.5813    0.5356       504
	        SearchScreeningEvent     0.6605    0.4980    0.5679       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2400    0.6098    0.3444       510
	
	                    accuracy                         0.5241      3030
	                   macro avg     0.6166    0.4491    0.4771      3030
	                weighted avg     0.7184    0.5241    0.5562      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.391, 0.390, 0.391, 0.822, 0.507
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.391, 0.822, 0.507
-----------------------------------------------------------------------------------------
Epoch  144: avg_loss: 0.1959099074204763 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9874099493026733 0.0001400560224089631 0.34509803921568627 0.34523809523809523

 ../data/dev/Period4.test
	Confusion Matrix
	 [241   0   0   1   0   0 262]
	 [  0 287   0   0   0   0 217]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 341  10   0 153]
	 [  0   0   0  25 290  64 125]
	 [  0   0   5   1 187 198 113]
	 [  0   0   0   2 136  38 334]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.4781746  0.56944444        nan 0.6765873  0.57539683 0.39285714
 0.65490196]
	Accuracy = 0.5580858085808581
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4782    0.6470       504
	              BookRestaurant     1.0000    0.5694    0.7257       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9216    0.6766    0.7803       504
	          SearchCreativeWork     0.4655    0.5754    0.5146       504
	        SearchScreeningEvent     0.6600    0.3929    0.4925       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2774    0.6549    0.3897       510
	
	                    accuracy                         0.5581      3030
	                   macro avg     0.6178    0.4782    0.5071      3030
	                weighted avg     0.7199    0.5581    0.5912      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.345, 0.345, 0.345, 0.809, 0.538
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.345, 0.809, 0.538
-----------------------------------------------------------------------------------------
Epoch  145: avg_loss: 0.20974090695381165 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9876575469970703 2.3342670401493848e-05 0.36470588235294116 0.36468253968253966

 ../data/dev/Period4.test
	Confusion Matrix
	 [351   0   0   2   0   0 151]
	 [  0  60   0   0   0   0 444]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 406  11   0  85]
	 [  0   0   0  37 296  55 116]
	 [  0   0   2   1 189 189 123]
	 [  0   0   0   9 147  30 324]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.69642857 0.11904762        nan 0.80555556 0.58730159 0.375
 0.63529412]
	Accuracy = 0.5366336633663367
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9943    0.6964    0.8191       504
	              BookRestaurant     1.0000    0.1190    0.2128       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8923    0.8056    0.8467       504
	          SearchCreativeWork     0.4603    0.5873    0.5161       504
	        SearchScreeningEvent     0.6898    0.3750    0.4859       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2607    0.6353    0.3697       510
	
	                    accuracy                         0.5366      3030
	                   macro avg     0.6139    0.4598    0.4643      3030
	                weighted avg     0.7153    0.5366    0.5414      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.365, 0.365, 0.365, 0.812, 0.517
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.365, 0.812, 0.517
-----------------------------------------------------------------------------------------
Epoch  146: avg_loss: 0.21112064768870673 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9860128164291382 0.00018674136321195078 0.3176470588235294 0.31746031746031744

 ../data/dev/Period4.test
	Confusion Matrix
	 [401   0   2   0   0 101]
	 [  0 162   0   0   0 342]
	 [  2   0 415   9   1  77]
	 [  0   0  33 280  58 133]
	 [  0   0   1 201 155 147]
	 [  0   0   8 121  33 348]
	Classwise Accuracies
	Labels
	[0.79563492 0.32142857 0.8234127  0.55555556 0.30753968 0.68235294]
	Accuracy = 0.5811881188118811
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9950    0.7956    0.8842       504
	              BookRestaurant     1.0000    0.3214    0.4865       504
	                   PlayMusic     0.9041    0.8234    0.8619       504
	          SearchCreativeWork     0.4583    0.5556    0.5022       504
	        SearchScreeningEvent     0.6275    0.3075    0.4128       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3031    0.6824    0.4198       510
	
	                    accuracy                         0.5812      3030
	                   macro avg     0.7147    0.5810    0.5946      3030
	                weighted avg     0.7139    0.5812    0.5942      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.317, 0.318, 0.317, 0.806, 0.561
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.317, 0.806, 0.561
-----------------------------------------------------------------------------------------
Epoch  147: avg_loss: 0.22274076690276465 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9798745512962341 0.00011671335200746924 0.3431372549019608 0.34325396825396826

 ../data/dev/Period4.test
	Confusion Matrix
	 [223   0   0   0   0   0 281]
	 [  0 459   0   0   0   0  45]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 203   7   1 293]
	 [  0   0   1   8 259  75 161]
	 [  0   0   4   0 200 215  85]
	 [  0   5   0   1  82  87 335]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.44246032 0.91071429        nan 0.40277778 0.51388889 0.4265873
 0.65686275]
	Accuracy = 0.5590759075907591
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4425    0.6135       504
	              BookRestaurant     0.9892    0.9107    0.9483       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9575    0.4028    0.5670       504
	          SearchCreativeWork     0.4726    0.5139    0.4924       504
	        SearchScreeningEvent     0.5688    0.4266    0.4875       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2792    0.6569    0.3918       510
	
	                    accuracy                         0.5591      3030
	                   macro avg     0.6096    0.4790    0.5001      3030
	                weighted avg     0.7104    0.5591    0.5831      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.343, 0.343, 0.343, 0.802, 0.539
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.343, 0.802, 0.539
-----------------------------------------------------------------------------------------
Epoch  148: avg_loss: 0.17581208795309067 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9765020608901978 0.0003501400560224077 0.33725490196078434 0.33690476190476193

 ../data/dev/Period4.test
	Confusion Matrix
	 [246   0   0   0   0   0 258]
	 [  0 477   0   0   0   1  26]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 169   6   1 328]
	 [  0   0   1   4 266  66 167]
	 [  0   1   7   0 145 281  70]
	 [  0  12   0   0  51 109 338]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.48809524 0.94642857        nan 0.33531746 0.52777778 0.55753968
 0.6627451 ]
	Accuracy = 0.5864686468646865
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4881    0.6560       504
	              BookRestaurant     0.9735    0.9464    0.9598       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9769    0.3353    0.4993       504
	          SearchCreativeWork     0.5684    0.5278    0.5473       504
	        SearchScreeningEvent     0.6135    0.5575    0.5842       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2848    0.6627    0.3984       510
	
	                    accuracy                         0.5865      3030
	                   macro avg     0.6310    0.5026    0.5207      3030
	                weighted avg     0.7353    0.5865    0.6071      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.337, 0.337, 0.337, 0.825, 0.571
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.337, 0.825, 0.571
-----------------------------------------------------------------------------------------
Epoch  149: avg_loss: 0.20323656996091208 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9892592430114746 0.00018674136321195078 0.34901960784313724 0.3492063492063492

 ../data/dev/Period4.test
	Confusion Matrix
	 [371   0   0   4   0   0 129]
	 [  0  42   0   0   0   0 462]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 420  15   1  65]
	 [  0   0   0  35 304  61 104]
	 [  0   0   3   1 142 238 120]
	 [  1   0   0  13 141  23 332]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.73611111 0.08333333        nan 0.83333333 0.6031746  0.47222222
 0.65098039]
	Accuracy = 0.5633663366336633
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9893    0.7361    0.8441       504
	              BookRestaurant     1.0000    0.0833    0.1538       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8879    0.8333    0.8598       504
	          SearchCreativeWork     0.5050    0.6032    0.5497       504
	        SearchScreeningEvent     0.7368    0.4722    0.5756       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2739    0.6510    0.3856       510
	
	                    accuracy                         0.5634      3030
	                   macro avg     0.6276    0.4827    0.4812      3030
	                weighted avg     0.7313    0.5634    0.5611      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.349, 0.349, 0.349, 0.829, 0.546
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.349, 0.829, 0.546
-----------------------------------------------------------------------------------------
Epoch  150: avg_loss: 0.20301245525479317 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9872395992279053 0.0009803921568627416 0.3176470588235294 0.31666666666666665

 ../data/dev/Period4.test
	Confusion Matrix
	 [385   0   0   5   0   0 114]
	 [  0 129   0   0   0   0 375]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 415  13   1  73]
	 [  0   0   0  32 303  54 115]
	 [  0   0   2   1 148 232 121]
	 [  0   0   0   9 130  23 348]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.76388889 0.25595238        nan 0.8234127  0.60119048 0.46031746
 0.68235294]
	Accuracy = 0.598019801980198
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9948    0.7639    0.8642       504
	              BookRestaurant     1.0000    0.2560    0.4076       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8983    0.8234    0.8592       504
	          SearchCreativeWork     0.5101    0.6012    0.5519       504
	        SearchScreeningEvent     0.7484    0.4603    0.5700       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3037    0.6824    0.4203       510
	
	                    accuracy                         0.5980      3030
	                   macro avg     0.6365    0.5124    0.5247      3030
	                weighted avg     0.7417    0.5980    0.6118      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.317, 0.318, 0.317, 0.832, 0.581
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.317, 0.832, 0.581
-----------------------------------------------------------------------------------------
Epoch  151: avg_loss: 0.22786478946606317 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9800366759300232 0.0007002801120448154 0.27450980392156865 0.27380952380952384

 ../data/dev/Period4.test
	Confusion Matrix
	 [361   0   0   1   0   0 142]
	 [  0 259   0   0   0   0 245]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 389  10   1 101]
	 [  0   0   0  29 299  64 112]
	 [  0   0   3   1 168 242  90]
	 [  0   0   0   4 109  27 370]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.71626984 0.51388889        nan 0.7718254  0.59325397 0.48015873
 0.7254902 ]
	Accuracy = 0.6336633663366337
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9918    0.7163    0.8318       504
	              BookRestaurant     1.0000    0.5139    0.6789       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9175    0.7718    0.8384       504
	          SearchCreativeWork     0.5102    0.5933    0.5486       504
	        SearchScreeningEvent     0.7246    0.4802    0.5776       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3491    0.7255    0.4713       510
	
	                    accuracy                         0.6337      3030
	                   macro avg     0.6419    0.5430    0.5638      3030
	                weighted avg     0.7481    0.6337    0.6574      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.274, 0.275, 0.274, 0.825, 0.615
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.274, 0.825, 0.615
-----------------------------------------------------------------------------------------
Epoch  152: avg_loss: 0.21446692446867624 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9809012413024902 0.00030345471521942 0.307843137254902 0.30753968253968256

 ../data/dev/Period4.test
	Confusion Matrix
	 [326   0   0   1   0   0 177]
	 [  0 218   0   0   0   0 286]
	 [0 0 0 0 0 0 0]
	 [  1   0   0 379  12   1 111]
	 [  0   0   4  29 296  70 105]
	 [  0   0   9   1 163 235  96]
	 [  0   0   0   5 131  21 353]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6468254  0.43253968        nan 0.75198413 0.58730159 0.46626984
 0.69215686]
	Accuracy = 0.5963696369636964
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9969    0.6468    0.7846       504
	              BookRestaurant     1.0000    0.4325    0.6039       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9133    0.7520    0.8248       504
	          SearchCreativeWork     0.4917    0.5873    0.5353       504
	        SearchScreeningEvent     0.7187    0.4663    0.5656       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3129    0.6922    0.4310       510
	
	                    accuracy                         0.5964      3030
	                   macro avg     0.6334    0.5110    0.5350      3030
	                weighted avg     0.7381    0.5964    0.6238      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.308, 0.308, 0.308, 0.813, 0.577
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.308, 0.813, 0.577
-----------------------------------------------------------------------------------------
Epoch  153: avg_loss: 0.17284178485472998 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9759629964828491 0.0006302521008403339 0.3137254901960784 0.3130952380952381

 ../data/dev/Period4.test
	Confusion Matrix
	 [222   0   0   0   0   0 282]
	 [  0 455   0   0   0   0  49]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 223  13   1 267]
	 [  0   0   0  11 289  81 123]
	 [  0   0   2   0 173 261  68]
	 [  0   1   1   1 107  50 350]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.44047619 0.90277778        nan 0.44246032 0.5734127  0.51785714
 0.68627451]
	Accuracy = 0.594059405940594
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4405    0.6116       504
	              BookRestaurant     0.9978    0.9028    0.9479       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9489    0.4425    0.6035       504
	          SearchCreativeWork     0.4966    0.5734    0.5322       504
	        SearchScreeningEvent     0.6641    0.5179    0.5819       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3073    0.6863    0.4245       510
	
	                    accuracy                         0.5941      3030
	                   macro avg     0.6307    0.5090    0.5288      3030
	                weighted avg     0.7349    0.5941    0.6166      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.313, 0.314, 0.313, 0.819, 0.575
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.313, 0.819, 0.575
-----------------------------------------------------------------------------------------
Epoch  154: avg_loss: 0.21627249817053476 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9865805506706238 9.337068160597539e-05 0.3411764705882353 0.3412698412698413

 ../data/dev/Period4.test
	Confusion Matrix
	 [115   0   0   0   0   0 389]
	 [  0 398   0   0   0   0 106]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 284  14   1 205]
	 [  0   0   1  17 305  71 110]
	 [  0   0   4   0 184 266  50]
	 [  0   0   0   2 108  64 336]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.2281746  0.78968254        nan 0.56349206 0.60515873 0.52777778
 0.65882353]
	Accuracy = 0.5623762376237624
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2282    0.3716       504
	              BookRestaurant     1.0000    0.7897    0.8825       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9373    0.5635    0.7038       504
	          SearchCreativeWork     0.4992    0.6052    0.5471       504
	        SearchScreeningEvent     0.6617    0.5278    0.5872       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2809    0.6588    0.3939       510
	
	                    accuracy                         0.5624      3030
	                   macro avg     0.6256    0.4819    0.4980      3030
	                weighted avg     0.7290    0.5624    0.5806      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.341, 0.341, 0.341, 0.819, 0.543
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.341, 0.819, 0.543
-----------------------------------------------------------------------------------------
Epoch  155: avg_loss: 0.15193314850330353 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9712786078453064 0.0 0.23333333333333334 0.23333333333333334

 ../data/dev/Period4.test
	Confusion Matrix
	 [341   0   0   1   0   0 162]
	 [  0 451   0   0   0   0  53]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 323   6   1 174]
	 [  0   0   0  21 282  79 122]
	 [  0   0   2   0 160 265  77]
	 [  0   2   0   3  85  29 391]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6765873  0.89484127        nan 0.64087302 0.55952381 0.52579365
 0.76666667]
	Accuracy = 0.6775577557755775
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6766    0.8071       504
	              BookRestaurant     0.9956    0.8948    0.9425       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9282    0.6409    0.7582       504
	          SearchCreativeWork     0.5291    0.5595    0.5439       504
	        SearchScreeningEvent     0.7086    0.5258    0.6036       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3994    0.7667    0.5252       510
	
	                    accuracy                         0.6776      3030
	                   macro avg     0.6515    0.5806    0.5972      3030
	                weighted avg     0.7594    0.6776    0.6964      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.233, 0.233, 0.233, 0.837, 0.660
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.233, 0.837, 0.660
-----------------------------------------------------------------------------------------
Epoch  156: avg_loss: 0.21882584691047668 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9890894889831543 0.0006302521008403339 0.35294117647058826 0.3535714285714286

 ../data/dev/Period4.test
	Confusion Matrix
	 [268   0   0   2   0   0 234]
	 [  0 183   0   0   0   0 321]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 367  12   0 125]
	 [  0   0   2  27 293  73 109]
	 [  0   0   5   1 158 238 102]
	 [  0   0   1   8 140  31 330]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53174603 0.36309524        nan 0.7281746  0.58134921 0.47222222
 0.64705882]
	Accuracy = 0.5541254125412541
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5317    0.6943       504
	              BookRestaurant     1.0000    0.3631    0.5328       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9062    0.7282    0.8075       504
	          SearchCreativeWork     0.4859    0.5813    0.5294       504
	        SearchScreeningEvent     0.6959    0.4722    0.5626       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2703    0.6471    0.3813       510
	
	                    accuracy                         0.5541      3030
	                   macro avg     0.6226    0.4748    0.5011      3030
	                weighted avg     0.7255    0.5541    0.5842      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.353, 0.353, 0.354, 0.816, 0.535
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.353, 0.816, 0.535
-----------------------------------------------------------------------------------------
Epoch  157: avg_loss: 0.22538932909568152 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9836704730987549 9.337068160597539e-05 0.307843137254902 0.30793650793650795

 ../data/dev/Period4.test
	Confusion Matrix
	 [225   0   0   1   0   0 278]
	 [  0 343   0   0   0   0 161]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 338  11   0 155]
	 [  0   0   1  22 302  79 100]
	 [  0   0   2   1 162 257  82]
	 [  0   0   0   3 114  40 353]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.44642857 0.68055556        nan 0.67063492 0.59920635 0.50992063
 0.69215686]
	Accuracy = 0.6
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4464    0.6173       504
	              BookRestaurant     1.0000    0.6806    0.8099       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9260    0.6706    0.7779       504
	          SearchCreativeWork     0.5127    0.5992    0.5526       504
	        SearchScreeningEvent     0.6835    0.5099    0.5841       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3127    0.6922    0.4308       510
	
	                    accuracy                         0.6000      3030
	                   macro avg     0.6336    0.5141    0.5389      3030
	                weighted avg     0.7383    0.6000    0.6284      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.308, 0.308, 0.308, 0.825, 0.581
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.308, 0.825, 0.581
-----------------------------------------------------------------------------------------
Epoch  158: avg_loss: 0.2367118572195371 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9914809465408325 0.0009803921568627416 0.3509803921568627 0.35

 ../data/dev/Period4.test
	Confusion Matrix
	 [227   0   0   1   0   0 276]
	 [  0 177   0   0   0   0 327]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 372  12   1 119]
	 [  0   0   0  28 315  84  77]
	 [  0   0   6   1 177 237  83]
	 [  0   0   0   6 134  39 331]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.45039683 0.35119048        nan 0.73809524 0.625      0.4702381
 0.64901961]
	Accuracy = 0.5475247524752476
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4504    0.6211       504
	              BookRestaurant     1.0000    0.3512    0.5198       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9118    0.7381    0.8158       504
	          SearchCreativeWork     0.4937    0.6250    0.5517       504
	        SearchScreeningEvent     0.6565    0.4702    0.5480       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2729    0.6490    0.3842       510
	
	                    accuracy                         0.5475      3030
	                   macro avg     0.6193    0.4691    0.4915      3030
	                weighted avg     0.7216    0.5475    0.5730      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.350, 0.351, 0.350, 0.808, 0.527
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.350, 0.808, 0.527
-----------------------------------------------------------------------------------------
Epoch  159: avg_loss: 0.1696780901402235 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.990635871887207 0.00018674136321195078 0.38235294117647056 0.3825396825396825

 ../data/dev/Period4.test
	Confusion Matrix
	 [261   0   0   1   0   0 242]
	 [  0  58   0   0   0   0 446]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 394  10   1  99]
	 [  0   0   1  32 300  84  87]
	 [  0   0   3   1 181 229  90]
	 [  0   0   1  11 131  52 315]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.51785714 0.11507937        nan 0.78174603 0.5952381  0.45436508
 0.61764706]
	Accuracy = 0.5138613861386139
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5179    0.6824       504
	              BookRestaurant     1.0000    0.1151    0.2064       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8975    0.7817    0.8356       504
	          SearchCreativeWork     0.4823    0.5952    0.5329       504
	        SearchScreeningEvent     0.6257    0.4544    0.5264       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2463    0.6176    0.3522       510
	
	                    accuracy                         0.5139      3030
	                   macro avg     0.6074    0.4403    0.4480      3030
	                weighted avg     0.7077    0.5139    0.5223      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.383, 0.382, 0.383, 0.798, 0.493
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.383, 0.798, 0.493
-----------------------------------------------------------------------------------------
Epoch  160: avg_loss: 0.22462140520413718 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9890795946121216 0.0009103641456582601 0.3568627450980392 0.35595238095238096

 ../data/dev/Period4.test
	Confusion Matrix
	 [284   0   0   1   0   0 219]
	 [  0 131   0   0   0   0 373]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 380   9   1 114]
	 [  0   0   1  31 299  78  95]
	 [  0   0   4   1 195 208  96]
	 [  0   0   1   8 125  48 328]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.56349206 0.25992063        nan 0.75396825 0.59325397 0.41269841
 0.64313725]
	Accuracy = 0.5379537953795379
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5635    0.7208       504
	              BookRestaurant     1.0000    0.2599    0.4126       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9026    0.7540    0.8216       504
	          SearchCreativeWork     0.4761    0.5933    0.5283       504
	        SearchScreeningEvent     0.6209    0.4127    0.4958       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2678    0.6431    0.3781       510
	
	                    accuracy                         0.5380      3030
	                   macro avg     0.6096    0.4609    0.4796      3030
	                weighted avg     0.7104    0.5380    0.5592      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.356, 0.357, 0.356, 0.790, 0.517
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.356, 0.790, 0.517
-----------------------------------------------------------------------------------------
Epoch  161: avg_loss: 0.19295409321784973 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9803363084793091 9.337068160597539e-05 0.2411764705882353 0.24126984126984127

 ../data/dev/Period4.test
	Confusion Matrix
	 [372   0   0   1   0   0 131]
	 [  0 357   0   0   0   0 147]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 370   9   1 122]
	 [  0   0   0  24 282  86 112]
	 [  0   0   4   1 202 201  96]
	 [  0   1   0   5  80  37 387]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.73809524 0.70833333        nan 0.73412698 0.55952381 0.39880952
 0.75882353]
	Accuracy = 0.6498349834983498
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9947    0.7381    0.8474       504
	              BookRestaurant     0.9972    0.7083    0.8283       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9227    0.7341    0.8177       504
	          SearchCreativeWork     0.4921    0.5595    0.5237       504
	        SearchScreeningEvent     0.6185    0.3988    0.4849       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3889    0.7588    0.5143       510
	
	                    accuracy                         0.6498      3030
	                   macro avg     0.6306    0.5568    0.5738      3030
	                weighted avg     0.7350    0.6498    0.6691      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.241, 0.241, 0.241, 0.796, 0.628
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.241, 0.796, 0.628
-----------------------------------------------------------------------------------------
Epoch  162: avg_loss: 0.2021876039604346 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9713156223297119 7.002801120448154e-05 0.20588235294117646 0.20595238095238094

 ../data/dev/Period4.test
	Confusion Matrix
	 [447   0   0   3   0   0  54]
	 [  0 467   0   0   0   0  37]
	 [0 0 0 0 0 0 0]
	 [ 11   0   0 369   3   1 120]
	 [  0   0   0  20 233  74 177]
	 [  0   0   3   0 181 189 131]
	 [  1  11   0   4  51  38 405]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.88690476 0.9265873         nan 0.73214286 0.46230159 0.375
 0.79411765]
	Accuracy = 0.6963696369636964
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9739    0.8869    0.9283       504
	              BookRestaurant     0.9770    0.9266    0.9511       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9318    0.7321    0.8200       504
	          SearchCreativeWork     0.4979    0.4623    0.4794       504
	        SearchScreeningEvent     0.6258    0.3750    0.4690       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4383    0.7941    0.5649       510
	
	                    accuracy                         0.6964      3030
	                   macro avg     0.6350    0.5967    0.6018      3030
	                weighted avg     0.7402    0.6964    0.7018      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.206, 0.206, 0.206, 0.804, 0.677
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.206, 0.804, 0.677
-----------------------------------------------------------------------------------------
Epoch  163: avg_loss: 0.1834345037738482 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9895105957984924 4.6685340802987696e-05 0.3627450980392157 0.3626984126984127

 ../data/dev/Period4.test
	Confusion Matrix
	 [182   0   0   0   0   0 322]
	 [  0 317   0   0   0   0 187]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 269   9   1 225]
	 [  0   0   2  12 280 105 105]
	 [  0   0   8   0 197 224  75]
	 [  0   0   2   3 114  66 325]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36111111 0.62896825        nan 0.53373016 0.55555556 0.44444444
 0.6372549 ]
	Accuracy = 0.527062706270627
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3611    0.5306       504
	              BookRestaurant     1.0000    0.6290    0.7722       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9472    0.5337    0.6827       504
	          SearchCreativeWork     0.4667    0.5556    0.5072       504
	        SearchScreeningEvent     0.5657    0.4444    0.4978       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2623    0.6373    0.3716       510
	
	                    accuracy                         0.5271      3030
	                   macro avg     0.6060    0.4516    0.4803      3030
	                weighted avg     0.7061    0.5271    0.5600      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.363, 0.363, 0.363, 0.790, 0.505
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.363, 0.790, 0.505
-----------------------------------------------------------------------------------------
Epoch  164: avg_loss: 0.19769147038459778 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.989488959312439 7.002801120448154e-05 0.37254901960784315 0.3726190476190476

 ../data/dev/Period4.test
	Confusion Matrix
	 [ 84   0   0   0   0   0 420]
	 [  0 380   0   0   0   0 124]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 249   9   1 245]
	 [  0   0   1  10 289 103 101]
	 [  0   0   4   0 202 249  49]
	 [  0   1   2   2 115  70 320]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.16666667 0.75396825        nan 0.49404762 0.5734127  0.49404762
 0.62745098]
	Accuracy = 0.5184818481848185
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.1667    0.2857       504
	              BookRestaurant     0.9974    0.7540    0.8588       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9540    0.4940    0.6510       504
	          SearchCreativeWork     0.4699    0.5734    0.5165       504
	        SearchScreeningEvent     0.5887    0.4940    0.5372       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2542    0.6275    0.3618       510
	
	                    accuracy                         0.5185      3030
	                   macro avg     0.6092    0.4442    0.4587      3030
	                weighted avg     0.7098    0.5185    0.5348      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.373, 0.373, 0.373, 0.798, 0.496
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.373, 0.798, 0.496
-----------------------------------------------------------------------------------------
Epoch  165: avg_loss: 0.22195998082558313 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9907591938972473 9.337068160597539e-05 0.3254901960784314 0.3253968253968254

 ../data/dev/Period4.test
	Confusion Matrix
	 [185   0   0   1   0   0 318]
	 [  0 396   0   0   0   0 108]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 286   7   1 210]
	 [  0   0   2  12 284  87 119]
	 [  0   0  15   0 172 252  65]
	 [  0   2   2   3  88  71 344]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.36706349 0.78571429        nan 0.56746032 0.56349206 0.5
 0.6745098 ]
	Accuracy = 0.5765676567656766
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.3671    0.5370       504
	              BookRestaurant     0.9950    0.7857    0.8780       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9470    0.5675    0.7097       504
	          SearchCreativeWork     0.5154    0.5635    0.5384       504
	        SearchScreeningEvent     0.6131    0.5000    0.5508       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2955    0.6745    0.4110       510
	
	                    accuracy                         0.5766      3030
	                   macro avg     0.6237    0.4940    0.5178      3030
	                weighted avg     0.7268    0.5766    0.6038      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.325, 0.325, 0.325, 0.806, 0.557
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.325, 0.806, 0.557
-----------------------------------------------------------------------------------------
Epoch  166: avg_loss: 0.18607896318038306 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9732505083084106 0.0005368814192343585 0.21176470588235294 0.2123015873015873

 ../data/dev/Period4.test
	Confusion Matrix
	 [435   0   0   2   0   0  67]
	 [  0 464   0   0   0   0  40]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 350   2   1 144]
	 [  0   0   0  14 243  82 165]
	 [  0   0   4   0 159 222 119]
	 [  1   6   1   4  55  41 402]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.86309524 0.92063492        nan 0.69444444 0.48214286 0.44047619
 0.78823529]
	Accuracy = 0.6983498349834983
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9819    0.8631    0.9187       504
	              BookRestaurant     0.9872    0.9206    0.9528       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9459    0.6944    0.8009       504
	          SearchCreativeWork     0.5294    0.4821    0.5047       504
	        SearchScreeningEvent     0.6416    0.4405    0.5224       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4290    0.7882    0.5556       510
	
	                    accuracy                         0.6983      3030
	                   macro avg     0.6450    0.5984    0.6079      3030
	                weighted avg     0.7519    0.6983    0.7089      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.212, 0.212, 0.212, 0.808, 0.680
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.212, 0.808, 0.680
-----------------------------------------------------------------------------------------
Epoch  167: avg_loss: 0.19260091334581375 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9809260368347168 0.00011671335200746924 0.2901960784313726 0.2900793650793651

 ../data/dev/Period4.test
	Confusion Matrix
	 [304   0   0   1   0   0 199]
	 [  0 403   0   0   0   0 101]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 280   6   1 217]
	 [  0   0   2   8 267  90 137]
	 [  0   0  14   0 195 218  77]
	 [  0   1   2   1  79  65 362]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.6031746  0.79960317        nan 0.55555556 0.5297619  0.43253968
 0.70980392]
	Accuracy = 0.6052805280528053
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6032    0.7525       504
	              BookRestaurant     0.9975    0.7996    0.8877       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9655    0.5556    0.7053       504
	          SearchCreativeWork     0.4881    0.5298    0.5081       504
	        SearchScreeningEvent     0.5829    0.4325    0.4966       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3312    0.7098    0.4517       510
	
	                    accuracy                         0.6053      3030
	                   macro avg     0.6236    0.5186    0.5431      3030
	                weighted avg     0.7268    0.6053    0.6333      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.290, 0.290, 0.290, 0.795, 0.584
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.290, 0.795, 0.584
-----------------------------------------------------------------------------------------
Epoch  168: avg_loss: 0.17542575796445212 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9867221117019653 0.00011671335200746924 0.3235294117647059 0.32341269841269843

 ../data/dev/Period4.test
	Confusion Matrix
	 [242   0   0   1   0   0 261]
	 [  0 368   0   0   0   0 136]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 274   7   1 222]
	 [  0   0   4   9 266  98 127]
	 [  0   0  17   0 191 227  69]
	 [  0   0   3   1  90  71 345]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.48015873 0.73015873        nan 0.54365079 0.52777778 0.45039683
 0.67647059]
	Accuracy = 0.5683168316831683
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4802    0.6488       504
	              BookRestaurant     1.0000    0.7302    0.8440       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9614    0.5437    0.6946       504
	          SearchCreativeWork     0.4801    0.5278    0.5028       504
	        SearchScreeningEvent     0.5718    0.4504    0.5039       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2974    0.6765    0.4132       510
	
	                    accuracy                         0.5683      3030
	                   macro avg     0.6158    0.4869    0.5153      3030
	                weighted avg     0.7176    0.5683    0.6008      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.323, 0.324, 0.323, 0.782, 0.546
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.323, 0.782, 0.546
-----------------------------------------------------------------------------------------
Epoch  169: avg_loss: 0.1969339077671369 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9776244163513184 0.0005135387488328647 0.24313725490196078 0.24365079365079365

 ../data/dev/Period4.test
	Confusion Matrix
	 [418   0   0   1   0   0  85]
	 [  0 454   0   0   0   0  50]
	 [0 0 0 0 0 0 0]
	 [  7   0   0 314   4   0 179]
	 [  0   0   1   9 239  83 172]
	 [  0   0   5   0 180 191 128]
	 [  0   5   1   2  64  52 386]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.82936508 0.90079365        nan 0.62301587 0.47420635 0.37896825
 0.75686275]
	Accuracy = 0.6607260726072607
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9835    0.8294    0.8999       504
	              BookRestaurant     0.9891    0.9008    0.9429       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9632    0.6230    0.7566       504
	          SearchCreativeWork     0.4908    0.4742    0.4823       504
	        SearchScreeningEvent     0.5859    0.3790    0.4602       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3860    0.7569    0.5113       510
	
	                    accuracy                         0.6607      3030
	                   macro avg     0.6284    0.5662    0.5790      3030
	                weighted avg     0.7324    0.6607    0.6752      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.244, 0.243, 0.244, 0.796, 0.641
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.244, 0.796, 0.641
-----------------------------------------------------------------------------------------
Epoch  170: avg_loss: 0.16703670720259348 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.976367175579071 2.3342670401493848e-05 0.1980392156862745 0.198015873015873

 ../data/dev/Period4.test
	Confusion Matrix
	 [473   0   7   0   0  24]
	 [  0 365   0   0   0 139]
	 [ 15   0 454   6   0  29]
	 [  0   0  36 277  52 139]
	 [  0   0   1 195 140 168]
	 [  1   1  17  64  18 409]
	Classwise Accuracies
	Labels
	[0.93849206 0.72420635 0.90079365 0.54960317 0.27777778 0.80196078]
	Accuracy = 0.699009900990099
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9673    0.9385    0.9527       504
	              BookRestaurant     0.9973    0.7242    0.8391       504
	                   PlayMusic     0.8816    0.9008    0.8911       504
	          SearchCreativeWork     0.5111    0.5496    0.5296       504
	        SearchScreeningEvent     0.6667    0.2778    0.3922       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4504    0.8020    0.5769       510
	
	                    accuracy                         0.6990      3030
	                   macro avg     0.7457    0.6988    0.6969      3030
	                weighted avg     0.7451    0.6990    0.6967      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.198, 0.198, 0.198, 0.810, 0.678
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.198, 0.810, 0.678
-----------------------------------------------------------------------------------------
Epoch  171: avg_loss: 0.180001612752676 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9804761409759521 0.0008403361344537785 0.22941176470588234 0.22857142857142856

 ../data/dev/Period4.test
	Confusion Matrix
	 [437   0   3   0   0  64]
	 [  0 285   0   0   0 219]
	 [  7   0 432   7   1  57]
	 [  0   0  31 280  79 114]
	 [  0   0   1 202 179 122]
	 [  1   0  14  63  39 393]
	Classwise Accuracies
	Labels
	[0.86706349 0.56547619 0.85714286 0.55555556 0.35515873 0.77058824]
	Accuracy = 0.662046204620462
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9820    0.8671    0.9210       504
	              BookRestaurant     1.0000    0.5655    0.7224       504
	                   PlayMusic     0.8981    0.8571    0.8772       504
	          SearchCreativeWork     0.5072    0.5556    0.5303       504
	        SearchScreeningEvent     0.6007    0.3552    0.4464       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4056    0.7706    0.5314       510
	
	                    accuracy                         0.6620      3030
	                   macro avg     0.7323    0.6618    0.6714      3030
	                weighted avg     0.7316    0.6620    0.6712      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.229, 0.229, 0.229, 0.803, 0.640
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.229, 0.803, 0.640
-----------------------------------------------------------------------------------------
Epoch  172: avg_loss: 0.17004557947317758 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9726348519325256 0.0006535947712418277 0.18823529411764706 0.18888888888888888

 ../data/dev/Period4.test
	Confusion Matrix
	 [439   0   0   2   0   0  63]
	 [  0 391   0   0   0   0 113]
	 [0 0 0 0 0 0 0]
	 [ 10   0   0 422   5   0  67]
	 [  0   0   0  30 254  87 133]
	 [  0   0   2   1 210 191 100]
	 [  1   0   0   4  56  35 414]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.87103175 0.77579365        nan 0.83730159 0.50396825 0.37896825
 0.81176471]
	Accuracy = 0.6966996699669967
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9756    0.8710    0.9203       504
	              BookRestaurant     1.0000    0.7758    0.8737       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9194    0.8373    0.8764       504
	          SearchCreativeWork     0.4838    0.5040    0.4937       504
	        SearchScreeningEvent     0.6102    0.3790    0.4676       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4652    0.8118    0.5914       510
	
	                    accuracy                         0.6967      3030
	                   macro avg     0.6363    0.5970    0.6033      3030
	                weighted avg     0.7418    0.6967    0.7036      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.189, 0.188, 0.189, 0.796, 0.673
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.189, 0.796, 0.673
-----------------------------------------------------------------------------------------
Epoch  173: avg_loss: 0.21743771682182947 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9795358180999756 7.002801120448154e-05 0.2607843137254902 0.26071428571428573

 ../data/dev/Period4.test
	Confusion Matrix
	 [374   0   0   2   0   0 128]
	 [  0 268   0   0   0   0 236]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 396   7   1  97]
	 [  0   0   0  25 274  94 111]
	 [  0   0   1   1 221 197  84]
	 [  0   0   0   4  66  63 377]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.74206349 0.53174603        nan 0.78571429 0.54365079 0.39087302
 0.73921569]
	Accuracy = 0.6224422442244224
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9920    0.7421    0.8490       504
	              BookRestaurant     1.0000    0.5317    0.6943       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9252    0.7857    0.8498       504
	          SearchCreativeWork     0.4824    0.5437    0.5112       504
	        SearchScreeningEvent     0.5549    0.3909    0.4587       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3650    0.7392    0.4887       510
	
	                    accuracy                         0.6224      3030
	                   macro avg     0.6171    0.5333    0.5502      3030
	                weighted avg     0.7192    0.6224    0.6416      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.260, 0.261, 0.260, 0.791, 0.599
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.260, 0.791, 0.599
-----------------------------------------------------------------------------------------
Epoch  174: avg_loss: 0.18728200097878775 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9820826053619385 0.00011671335200746924 0.2901960784313726 0.2900793650793651

 ../data/dev/Period4.test
	Confusion Matrix
	 [270   0   0   1   0   0 233]
	 [  0 326   0   0   0   0 178]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 355   8   1 140]
	 [  0   0   1  20 281  95 107]
	 [  0   0   5   0 224 202  73]
	 [  0   1   0   2  65  80 362]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53571429 0.6468254         nan 0.70436508 0.55753968 0.40079365
 0.70980392]
	Accuracy = 0.5927392739273928
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5357    0.6977       504
	              BookRestaurant     0.9969    0.6468    0.7846       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9392    0.7044    0.8050       504
	          SearchCreativeWork     0.4862    0.5575    0.5194       504
	        SearchScreeningEvent     0.5344    0.4008    0.4580       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3312    0.7098    0.4517       510
	
	                    accuracy                         0.5927      3030
	                   macro avg     0.6125    0.5079    0.5309      3030
	                weighted avg     0.7139    0.5927    0.6191      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.290, 0.290, 0.290, 0.783, 0.569
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.290, 0.783, 0.569
-----------------------------------------------------------------------------------------
Epoch  175: avg_loss: 0.18865610162417093 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9752481579780579 0.00018674136321195078 0.24901960784313726 0.2492063492063492

 ../data/dev/Period4.test
	Confusion Matrix
	 [364   0   0   1   0   0 139]
	 [  0 368   0   0   0   0 136]
	 [0 0 0 0 0 0 0]
	 [  2   0   0 362   7   0 133]
	 [  0   0   1  22 273  83 125]
	 [  0   0   2   1 206 200  95]
	 [  0   0   0   3  82  42 383]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.72222222 0.73015873        nan 0.71825397 0.54166667 0.3968254
 0.75098039]
	Accuracy = 0.6435643564356436
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9945    0.7222    0.8368       504
	              BookRestaurant     1.0000    0.7302    0.8440       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9306    0.7183    0.8108       504
	          SearchCreativeWork     0.4806    0.5417    0.5093       504
	        SearchScreeningEvent     0.6154    0.3968    0.4825       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3788    0.7510    0.5036       510
	
	                    accuracy                         0.6436      3030
	                   macro avg     0.6286    0.5514    0.5696      3030
	                weighted avg     0.7326    0.6436    0.6642      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.249, 0.249, 0.249, 0.799, 0.622
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.249, 0.799, 0.622
-----------------------------------------------------------------------------------------
Epoch  176: avg_loss: 0.214998592933019 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9817408323287964 7.002801120448154e-05 0.22745098039215686 0.22738095238095238

 ../data/dev/Period4.test
	Confusion Matrix
	 [421   0   0   2   0   0  81]
	 [  0 430   0   0   0   0  74]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 373   4   1 121]
	 [  0   0   0  20 244  71 169]
	 [  0   0   2   0 197 177 128]
	 [  0   2   0   4  47  63 394]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.83531746 0.8531746         nan 0.74007937 0.48412698 0.35119048
 0.77254902]
	Accuracy = 0.6729372937293729
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9883    0.8353    0.9054       504
	              BookRestaurant     0.9954    0.8532    0.9188       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9348    0.7401    0.8261       504
	          SearchCreativeWork     0.4959    0.4841    0.4900       504
	        SearchScreeningEvent     0.5673    0.3512    0.4338       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4074    0.7725    0.5335       510
	
	                    accuracy                         0.6729      3030
	                   macro avg     0.6270    0.5766    0.5868      3030
	                weighted avg     0.7309    0.6729    0.6843      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.227, 0.227, 0.227, 0.800, 0.653
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.227, 0.800, 0.653
-----------------------------------------------------------------------------------------
Epoch  177: avg_loss: 0.16578244045376778 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9865203499794006 0.0008636788048552724 0.2725490196078431 0.2734126984126984

 ../data/dev/Period4.test
	Confusion Matrix
	 [431   0   0   8   0   0  65]
	 [  0 240   0   0   0   0 264]
	 [0 0 0 0 0 0 0]
	 [  8   0   0 427   4   1  64]
	 [  0   0   0  33 276  57 138]
	 [  0   0   1   1 202 142 158]
	 [  1   0   0   6  87  45 371]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.85515873 0.47619048        nan 0.84722222 0.54761905 0.28174603
 0.72745098]
	Accuracy = 0.6227722772277228
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9795    0.8552    0.9131       504
	              BookRestaurant     1.0000    0.4762    0.6452       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8989    0.8472    0.8723       504
	          SearchCreativeWork     0.4851    0.5476    0.5144       504
	        SearchScreeningEvent     0.5796    0.2817    0.3792       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3500    0.7275    0.4726       510
	
	                    accuracy                         0.6228      3030
	                   macro avg     0.6133    0.5336    0.5424      3030
	                weighted avg     0.7148    0.6228    0.6325      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.273, 0.273, 0.273, 0.797, 0.602
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.273, 0.797, 0.602
-----------------------------------------------------------------------------------------
Epoch  178: avg_loss: 0.22336714963118234 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9733141660690308 0.00016339869281045694 0.2529411764705882 0.25277777777777777

 ../data/dev/Period4.test
	Confusion Matrix
	 [391   0   0   0   0   0 113]
	 [  0 483   0   0   0   0  21]
	 [0 0 0 0 0 0 0]
	 [  4   0   0 257   1   1 241]
	 [  0   1   3   7 246  71 176]
	 [  0   0   7   0 209 202  86]
	 [  0  18   0   0  59  52 381]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.77579365 0.95833333        nan 0.50992063 0.48809524 0.40079365
 0.74705882]
	Accuracy = 0.6468646864686468
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9899    0.7758    0.8699       504
	              BookRestaurant     0.9622    0.9583    0.9602       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9735    0.5099    0.6693       504
	          SearchCreativeWork     0.4777    0.4881    0.4828       504
	        SearchScreeningEvent     0.6196    0.4008    0.4867       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3743    0.7471    0.4987       510
	
	                    accuracy                         0.6469      3030
	                   macro avg     0.6282    0.5543    0.5668      3030
	                weighted avg     0.7321    0.6469    0.6609      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.253, 0.253, 0.253, 0.803, 0.627
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.253, 0.803, 0.627
-----------------------------------------------------------------------------------------
Epoch  179: avg_loss: 0.18806375314791998 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9823446273803711 9.337068160597539e-05 0.27450980392156865 0.2746031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [282   0   0   0   0   0 222]
	 [  0 421   0   0   0   0  83]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 328   3   1 172]
	 [  0   0   0  14 268  92 130]
	 [  0   0   6   0 241 172  85]
	 [  0   3   0   1  63  73 370]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.55952381 0.83531746        nan 0.65079365 0.53174603 0.34126984
 0.7254902 ]
	Accuracy = 0.6075907590759075
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5595    0.7176       504
	              BookRestaurant     0.9929    0.8353    0.9073       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9563    0.6508    0.7745       504
	          SearchCreativeWork     0.4661    0.5317    0.4968       504
	        SearchScreeningEvent     0.5089    0.3413    0.4086       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3484    0.7255    0.4707       510
	
	                    accuracy                         0.6076      3030
	                   macro avg     0.6104    0.5206    0.5393      3030
	                weighted avg     0.7114    0.6076    0.6289      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.275, 0.275, 0.275, 0.781, 0.584
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.275, 0.781, 0.584
-----------------------------------------------------------------------------------------
Epoch  180: avg_loss: 0.17328200613458952 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9775719046592712 0.0 0.23333333333333334 0.23333333333333334

 ../data/dev/Period4.test
	Confusion Matrix
	 [393   0   0   1   0   0 110]
	 [  0 380   0   0   0   0 124]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 380   3   1 117]
	 [  0   0   2  22 254  88 138]
	 [  0   0   6   0 239 160  99]
	 [  1   0   1   3  62  52 391]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.7797619  0.75396825        nan 0.75396825 0.50396825 0.31746032
 0.76666667]
	Accuracy = 0.6462046204620462
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9899    0.7798    0.8724       504
	              BookRestaurant     1.0000    0.7540    0.8597       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9360    0.7540    0.8352       504
	          SearchCreativeWork     0.4552    0.5040    0.4783       504
	        SearchScreeningEvent     0.5316    0.3175    0.3975       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3994    0.7667    0.5252       510
	
	                    accuracy                         0.6462      3030
	                   macro avg     0.6160    0.5537    0.5669      3030
	                weighted avg     0.7180    0.6462    0.6611      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.233, 0.233, 0.233, 0.786, 0.622
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.233, 0.786, 0.622
-----------------------------------------------------------------------------------------
Epoch  181: avg_loss: 0.16670654093225798 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.98631751537323 0.00011671335200746924 0.2901960784313726 0.2900793650793651

 ../data/dev/Period4.test
	Confusion Matrix
	 [412   0   6   0   0  86]
	 [  0 125   0   0   0 379]
	 [  6   0 439   6   1  52]
	 [  0   0  34 301  63 106]
	 [  0   0   1 223 172 108]
	 [  1   0  10 101  36 362]
	Classwise Accuracies
	Labels
	[0.81746032 0.24801587 0.87103175 0.59722222 0.34126984 0.70980392]
	Accuracy = 0.5976897689768977
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9833    0.8175    0.8927       504
	              BookRestaurant     1.0000    0.2480    0.3975       504
	                   PlayMusic     0.8959    0.8710    0.8833       504
	          SearchCreativeWork     0.4770    0.5972    0.5304       504
	        SearchScreeningEvent     0.6324    0.3413    0.4433       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3312    0.7098    0.4517       510
	
	                    accuracy                         0.5977      3030
	                   macro avg     0.7200    0.5975    0.5998      3030
	                weighted avg     0.7192    0.5977    0.5995      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.290, 0.290, 0.290, 0.803, 0.575
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.290, 0.803, 0.575
-----------------------------------------------------------------------------------------
Epoch  182: avg_loss: 0.16475682705640793 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9918704628944397 0.0008403361344537785 0.32941176470588235 0.32857142857142857

 ../data/dev/Period4.test
	Confusion Matrix
	 [368   0   0   5   0   0 131]
	 [  0  65   0   0   0   0 439]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 431   9   1  60]
	 [  0   0   1  34 304  69  96]
	 [  0   0   3   1 203 195 102]
	 [  1   0   0  10 127  30 342]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.73015873 0.12896825        nan 0.85515873 0.6031746  0.38690476
 0.67058824]
	Accuracy = 0.5627062706270627
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9892    0.7302    0.8402       504
	              BookRestaurant     1.0000    0.1290    0.2285       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8960    0.8552    0.8751       504
	          SearchCreativeWork     0.4728    0.6032    0.5301       504
	        SearchScreeningEvent     0.6610    0.3869    0.4881       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2923    0.6706    0.4071       510
	
	                    accuracy                         0.5627      3030
	                   macro avg     0.6159    0.4821    0.4813      3030
	                weighted avg     0.7177    0.5627    0.5612      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.329, 0.329, 0.329, 0.806, 0.541
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.329, 0.806, 0.541
-----------------------------------------------------------------------------------------
Epoch  183: avg_loss: 0.1500301534930865 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9846222996711731 7.002801120448154e-05 0.3058823529411765 0.305952380952381

 ../data/dev/Period4.test
	Confusion Matrix
	 [369   0   0   2   0   0 133]
	 [  0 122   0   0   0   0 382]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 414   8   1  78]
	 [  0   0   2  35 301  76  90]
	 [  0   0   4   1 203 208  88]
	 [  1   0   2   5 127  21 354]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.73214286 0.24206349        nan 0.82142857 0.59722222 0.41269841
 0.69411765]
	Accuracy = 0.5834983498349835
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9893    0.7321    0.8415       504
	              BookRestaurant     1.0000    0.2421    0.3898       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9059    0.8214    0.8616       504
	          SearchCreativeWork     0.4710    0.5972    0.5267       504
	        SearchScreeningEvent     0.6797    0.4127    0.5136       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3147    0.6941    0.4330       510
	
	                    accuracy                         0.5835      3030
	                   macro avg     0.6229    0.5000    0.5095      3030
	                weighted avg     0.7260    0.5835    0.5940      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.306, 0.306, 0.306, 0.805, 0.561
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.306, 0.805, 0.561
-----------------------------------------------------------------------------------------
Epoch  184: avg_loss: 0.16358659168084463 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9848513603210449 9.337068160597539e-05 0.37450980392156863 0.3746031746031746

 ../data/dev/Period4.test
	Confusion Matrix
	 [108   0   0   0   0   0 396]
	 [  0 292   0   0   0   0 212]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 307   8   2 187]
	 [  0   0   3  20 295  96  90]
	 [  0   0   4   0 230 211  59]
	 [  0   0   6   0 100  85 319]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.21428571 0.57936508        nan 0.60912698 0.58531746 0.41865079
 0.6254902 ]
	Accuracy = 0.5056105610561056
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2143    0.3529       504
	              BookRestaurant     1.0000    0.5794    0.7337       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9388    0.6091    0.7389       504
	          SearchCreativeWork     0.4660    0.5853    0.5189       504
	        SearchScreeningEvent     0.5355    0.4187    0.4699       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2526    0.6255    0.3598       510
	
	                    accuracy                         0.5056      3030
	                   macro avg     0.5990    0.4332    0.4535      3030
	                weighted avg     0.6979    0.5056    0.5287      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.375, 0.375, 0.375, 0.786, 0.481
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.375, 0.786, 0.481
-----------------------------------------------------------------------------------------
Epoch  185: avg_loss: 0.15852047130465508 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9814402461051941 0.0007002801120448154 0.3254901960784314 0.3261904761904762

 ../data/dev/Period4.test
	Confusion Matrix
	 [151   0   0   0   0   0 353]
	 [  0 404   0   0   0   0 100]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 281  11   1 211]
	 [  0   0   2  12 296  88 106]
	 [  0   0   5   0 208 239  52]
	 [  0   1   2   0  75  88 344]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.29960317 0.8015873         nan 0.55753968 0.58730159 0.47420635
 0.6745098 ]
	Accuracy = 0.566006600660066
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.2996    0.4611       504
	              BookRestaurant     0.9975    0.8016    0.8889       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9590    0.5575    0.7051       504
	          SearchCreativeWork     0.5017    0.5873    0.5411       504
	        SearchScreeningEvent     0.5745    0.4742    0.5196       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2950    0.6745    0.4105       510
	
	                    accuracy                         0.5660      3030
	                   macro avg     0.6183    0.4850    0.5038      3030
	                weighted avg     0.7205    0.5660    0.5874      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.326, 0.325, 0.326, 0.804, 0.544
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.326, 0.804, 0.544
-----------------------------------------------------------------------------------------
Epoch  186: avg_loss: 0.19412025436758995 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9769188165664673 0.0009570494864612478 0.21372549019607842 0.21468253968253967

 ../data/dev/Period4.test
	Confusion Matrix
	 [405   0   0   0   0   0  99]
	 [  0 415   0   0   0   0  89]
	 [0 0 0 0 0 0 0]
	 [  3   0   0 371   4   1 125]
	 [  0   0   1  22 274  71 136]
	 [  0   0   2   1 181 228  92]
	 [  0   0   0   3  78  28 401]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.80357143 0.8234127         nan 0.73611111 0.54365079 0.45238095
 0.78627451]
	Accuracy = 0.691089108910891
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9926    0.8036    0.8882       504
	              BookRestaurant     1.0000    0.8234    0.9032       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9345    0.7361    0.8235       504
	          SearchCreativeWork     0.5102    0.5437    0.5264       504
	        SearchScreeningEvent     0.6951    0.4524    0.5481       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4257    0.7863    0.5523       510
	
	                    accuracy                         0.6911      3030
	                   macro avg     0.6512    0.5922    0.6060      3030
	                weighted avg     0.7590    0.6911    0.7066      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.215, 0.214, 0.215, 0.827, 0.672
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.215, 0.827, 0.672
-----------------------------------------------------------------------------------------
Epoch  187: avg_loss: 0.12552955622474352 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9791632294654846 0.00011671335200746924 0.2568627450980392 0.2567460317460317

 ../data/dev/Period4.test
	Confusion Matrix
	 [349   0   0   0   0   0 155]
	 [  0 357   0   0   0   0 147]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 348   7   1 148]
	 [  0   0   3  21 275  79 126]
	 [  0   0   3   1 207 222  71]
	 [  0   0   6   2  85  38 379]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.69246032 0.70833333        nan 0.69047619 0.54563492 0.44047619
 0.74313725]
	Accuracy = 0.636963696369637
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6925    0.8183       504
	              BookRestaurant     1.0000    0.7083    0.8293       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9355    0.6905    0.7945       504
	          SearchCreativeWork     0.4791    0.5456    0.5102       504
	        SearchScreeningEvent     0.6529    0.4405    0.5261       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3694    0.7431    0.4935       510
	
	                    accuracy                         0.6370      3030
	                   macro avg     0.6338    0.5458    0.5674      3030
	                weighted avg     0.7388    0.6370    0.6616      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.257, 0.257, 0.257, 0.808, 0.615
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.257, 0.808, 0.615
-----------------------------------------------------------------------------------------
Epoch  188: avg_loss: 0.18629558632771173 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9891943335533142 0.000770308123249297 0.2980392156862745 0.2988095238095238

 ../data/dev/Period4.test
	Confusion Matrix
	 [297   0   0   1   0   0 206]
	 [  0 213   0   0   0   0 291]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 391  10   1 102]
	 [  0   0   0  33 316  80  75]
	 [  0   0   5   1 197 222  79]
	 [  0   0   0   8 112  32 358]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.58928571 0.42261905        nan 0.77579365 0.62698413 0.44047619
 0.70196078]
	Accuracy = 0.593069306930693
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5893    0.7416       504
	              BookRestaurant     1.0000    0.4226    0.5941       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9009    0.7758    0.8337       504
	          SearchCreativeWork     0.4976    0.6270    0.5549       504
	        SearchScreeningEvent     0.6627    0.4405    0.5292       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3222    0.7020    0.4417       510
	
	                    accuracy                         0.5931      3030
	                   macro avg     0.6262    0.5082    0.5279      3030
	                weighted avg     0.7298    0.5931    0.6155      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.299, 0.298, 0.299, 0.808, 0.571
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.299, 0.808, 0.571
-----------------------------------------------------------------------------------------
Epoch  189: avg_loss: 0.17502464974919954 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9766219854354858 0.0001400560224089631 0.21176470588235294 0.2119047619047619

 ../data/dev/Period4.test
	Confusion Matrix
	 [408   0   1   0   0  95]
	 [  0 346   0   0   0 158]
	 [  4   0 406   6   1  87]
	 [  0   0  31 292  79 102]
	 [  0   0   1 210 201  92]
	 [  1   0   4  78  25 402]
	Classwise Accuracies
	Labels
	[0.80952381 0.68650794 0.80555556 0.57936508 0.39880952 0.78823529]
	Accuracy = 0.6782178217821783
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9879    0.8095    0.8899       504
	              BookRestaurant     1.0000    0.6865    0.8141       504
	                   PlayMusic     0.9165    0.8056    0.8574       504
	          SearchCreativeWork     0.4983    0.5794    0.5358       504
	        SearchScreeningEvent     0.6569    0.3988    0.4963       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4295    0.7882    0.5560       510
	
	                    accuracy                         0.6782      3030
	                   macro avg     0.7482    0.6780    0.6916      3030
	                weighted avg     0.7475    0.6782    0.6913      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.212, 0.212, 0.212, 0.812, 0.656
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.212, 0.812, 0.656
-----------------------------------------------------------------------------------------
Epoch  190: avg_loss: 0.19750492523113886 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9859411120414734 0.0008870214752567662 0.29215686274509806 0.2912698412698413

 ../data/dev/Period4.test
	Confusion Matrix
	 [252   0   0   0   0   0 252]
	 [  0 339   0   0   0   0 165]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 336   9   1 158]
	 [  0   0   2  21 283 103  95]
	 [  0   0   6   1 222 211  64]
	 [  0   0   9   3  83  54 361]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.5        0.67261905        nan 0.66666667 0.56150794 0.41865079
 0.70784314]
	Accuracy = 0.5881188118811881
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5000    0.6667       504
	              BookRestaurant     1.0000    0.6726    0.8043       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9307    0.6667    0.7769       504
	          SearchCreativeWork     0.4740    0.5615    0.5141       504
	        SearchScreeningEvent     0.5718    0.4187    0.4834       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3297    0.7078    0.4498       510
	
	                    accuracy                         0.5881      3030
	                   macro avg     0.6152    0.5039    0.5279      3030
	                weighted avg     0.7169    0.5881    0.6155      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.291, 0.292, 0.291, 0.790, 0.564
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.291, 0.790, 0.564
-----------------------------------------------------------------------------------------
Epoch  191: avg_loss: 0.13258681880931059 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9835608005523682 0.0008403361344537785 0.2627450980392157 0.2619047619047619

 ../data/dev/Period4.test
	Confusion Matrix
	 [265   0   0   0   0   0 239]
	 [  0 428   0   0   0   0  76]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 317   9   1 177]
	 [  0   0   1  17 288  87 111]
	 [  0   0   6   0 190 251  57]
	 [  0   0   1   3  75  55 376]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.52579365 0.84920635        nan 0.62896825 0.57142857 0.49801587
 0.7372549 ]
	Accuracy = 0.6353135313531353
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5258    0.6892       504
	              BookRestaurant     1.0000    0.8492    0.9185       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9407    0.6290    0.7539       504
	          SearchCreativeWork     0.5125    0.5714    0.5403       504
	        SearchScreeningEvent     0.6371    0.4980    0.5590       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3629    0.7373    0.4864       510
	
	                    accuracy                         0.6353      3030
	                   macro avg     0.6362    0.5444    0.5639      3030
	                weighted avg     0.7414    0.6353    0.6575      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.262, 0.263, 0.262, 0.812, 0.615
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.262, 0.812, 0.615
-----------------------------------------------------------------------------------------
Epoch  192: avg_loss: 0.1666796033581098 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9846895933151245 0.00025676937441643233 0.2549019607843137 0.25515873015873014

 ../data/dev/Period4.test
	Confusion Matrix
	 [350   0   0   0   0   0 154]
	 [  0 341   0   0   0   0 163]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 380   9   1 114]
	 [  0   0   0  29 294  69 112]
	 [  0   0   3   1 194 206 100]
	 [  0   0   0   6  97  27 380]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.69444444 0.6765873         nan 0.75396825 0.58333333 0.40873016
 0.74509804]
	Accuracy = 0.643894389438944
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6944    0.8197       504
	              BookRestaurant     1.0000    0.6766    0.8071       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9135    0.7540    0.8261       504
	          SearchCreativeWork     0.4949    0.5833    0.5355       504
	        SearchScreeningEvent     0.6799    0.4087    0.5105       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3715    0.7451    0.4958       510
	
	                    accuracy                         0.6439      3030
	                   macro avg     0.6371    0.5517    0.5707      3030
	                weighted avg     0.7426    0.6439    0.6654      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.255, 0.255, 0.255, 0.812, 0.623
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.255, 0.812, 0.623
-----------------------------------------------------------------------------------------
Epoch  193: avg_loss: 0.1967712864279747 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9746837019920349 2.3342670401493848e-05 0.2019607843137255 0.201984126984127

 ../data/dev/Period4.test
	Confusion Matrix
	 [447   0   0   3   0   0  54]
	 [  0 325   0   0   0   0 179]
	 [0 0 0 0 0 0 0]
	 [  5   0   0 431   5   1  62]
	 [  0   0   0  37 303  47 117]
	 [  0   0   2   1 187 217  97]
	 [  1   0   0   9  83  10 407]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.88690476 0.64484127        nan 0.85515873 0.60119048 0.43055556
 0.79803922]
	Accuracy = 0.7029702970297029
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9868    0.8869    0.9342       504
	              BookRestaurant     1.0000    0.6448    0.7841       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.8960    0.8552    0.8751       504
	          SearchCreativeWork     0.5242    0.6012    0.5601       504
	        SearchScreeningEvent     0.7891    0.4306    0.5571       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4443    0.7980    0.5708       510
	
	                    accuracy                         0.7030      3030
	                   macro avg     0.6629    0.6024    0.6116      3030
	                weighted avg     0.7728    0.7030    0.7133      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.202, 0.202, 0.202, 0.830, 0.684
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.202, 0.830, 0.684
-----------------------------------------------------------------------------------------
Epoch  194: avg_loss: 0.18306072304646173 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9808279871940613 7.002801120448154e-05 0.2607843137254902 0.26071428571428573

 ../data/dev/Period4.test
	Confusion Matrix
	 [289   0   0   0   0   0 215]
	 [  0 411   0   0   0   0  93]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 323   8   1 172]
	 [  0   0   1  16 290  84 113]
	 [  0   0   6   0 222 212  64]
	 [  0   0   1   2  60  70 377]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.5734127  0.81547619        nan 0.64087302 0.57539683 0.42063492
 0.73921569]
	Accuracy = 0.6277227722772277
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5734    0.7289       504
	              BookRestaurant     1.0000    0.8155    0.8984       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9472    0.6409    0.7645       504
	          SearchCreativeWork     0.5000    0.5754    0.5351       504
	        SearchScreeningEvent     0.5777    0.4206    0.4868       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3646    0.7392    0.4883       510
	
	                    accuracy                         0.6277      3030
	                   macro avg     0.6271    0.5379    0.5574      3030
	                weighted avg     0.7309    0.6277    0.6500      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.261, 0.261, 0.261, 0.800, 0.605
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.261, 0.800, 0.605
-----------------------------------------------------------------------------------------
Epoch  195: avg_loss: 0.15729759633541107 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9891829490661621 0.0008169934640522847 0.30196078431372547 0.30277777777777776

 ../data/dev/Period4.test
	Confusion Matrix
	 [270   0   0   0   0   0 234]
	 [  0 344   0   0   0   0 160]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 348   9   1 146]
	 [  0   0   1  19 295  70 119]
	 [  0   0   2   0 185 213 104]
	 [  0   0   0   3  97  54 356]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.53571429 0.68253968        nan 0.69047619 0.58531746 0.42261905
 0.69803922]
	Accuracy = 0.6026402640264027
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.5357    0.6977       504
	              BookRestaurant     1.0000    0.6825    0.8113       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9405    0.6905    0.7963       504
	          SearchCreativeWork     0.5034    0.5853    0.5413       504
	        SearchScreeningEvent     0.6302    0.4226    0.5059       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3181    0.6980    0.4371       510
	
	                    accuracy                         0.6026      3030
	                   macro avg     0.6275    0.5164    0.5414      3030
	                weighted avg     0.7312    0.6026    0.6312      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.303, 0.302, 0.303, 0.814, 0.583
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.303, 0.814, 0.583
-----------------------------------------------------------------------------------------
Epoch  196: avg_loss: 0.18908235306541124 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9900281429290771 0.0008870214752567662 0.307843137254902 0.30873015873015874

 ../data/dev/Period4.test
	Confusion Matrix
	 [328   0   0   1   0   0 175]
	 [  0 184   0   0   0   0 320]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 390  10   0 104]
	 [  0   0   2  33 319  59  91]
	 [  0   0   5   1 177 233  88]
	 [  0   0   0   6 128  23 353]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.65079365 0.36507937        nan 0.77380952 0.63293651 0.46230159
 0.69215686]
	Accuracy = 0.5963696369636964
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6508    0.7885       504
	              BookRestaurant     1.0000    0.3651    0.5349       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9049    0.7738    0.8342       504
	          SearchCreativeWork     0.5032    0.6329    0.5606       504
	        SearchScreeningEvent     0.7397    0.4623    0.5690       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.3121    0.6922    0.4302       510
	
	                    accuracy                         0.5964      3030
	                   macro avg     0.6371    0.5110    0.5311      3030
	                weighted avg     0.7424    0.5964    0.6192      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.309, 0.308, 0.309, 0.816, 0.577
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.309, 0.816, 0.577
-----------------------------------------------------------------------------------------
Epoch  197: avg_loss: 0.1659791978696982 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9883898496627808 0.0009337068160597539 0.3215686274509804 0.32063492063492066

 ../data/dev/Period4.test
	Confusion Matrix
	 [323   0   0   0   0   0 181]
	 [  0 143   1   0   0   0 360]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 393  10   0 101]
	 [  0   0   2  34 317  67  84]
	 [  0   0   3   1 179 239  82]
	 [  0   0   5   7 115  37 346]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.64087302 0.28373016        nan 0.7797619  0.62896825 0.47420635
 0.67843137]
	Accuracy = 0.5811881188118811
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.6409    0.7811       504
	              BookRestaurant     1.0000    0.2837    0.4420       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9034    0.7798    0.8371       504
	          SearchCreativeWork     0.5105    0.6290    0.5636       504
	        SearchScreeningEvent     0.6968    0.4742    0.5643       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2998    0.6784    0.4159       510
	
	                    accuracy                         0.5812      3030
	                   macro avg     0.6301    0.4980    0.5149      3030
	                weighted avg     0.7342    0.5812    0.6003      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.321, 0.322, 0.321, 0.818, 0.562
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.321, 0.818, 0.562
-----------------------------------------------------------------------------------------
Epoch  198: avg_loss: 0.17834443102280298 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9654706120491028 0.0001400560224089631 0.18823529411764706 0.1880952380952381

 ../data/dev/Period4.test
	Confusion Matrix
	 [440   0   0   0   0   0  64]
	 [  0 445   0   0   0   0  59]
	 [0 0 0 0 0 0 0]
	 [  6   0   0 386   7   0 105]
	 [  0   0   2  26 282  60 134]
	 [  0   0   5   0 160 227 112]
	 [  1   1   1   4  65  24 414]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.87301587 0.88293651        nan 0.76587302 0.55952381 0.45039683
 0.81176471]
	Accuracy = 0.7240924092409241
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     0.9843    0.8730    0.9253       504
	              BookRestaurant     0.9978    0.8829    0.9368       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9279    0.7659    0.8391       504
	          SearchCreativeWork     0.5486    0.5595    0.5540       504
	        SearchScreeningEvent     0.7299    0.4504    0.5571       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.4662    0.8118    0.5923       510
	
	                    accuracy                         0.7241      3030
	                   macro avg     0.6650    0.6205    0.6292      3030
	                weighted avg     0.7752    0.7241    0.7338      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.188, 0.188, 0.188, 0.827, 0.706
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.188, 0.827, 0.706
-----------------------------------------------------------------------------------------
Epoch  199: avg_loss: 0.21021116773287454 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.986396074295044 2.3342670401493848e-05 0.33137254901960783 0.33134920634920634

 ../data/dev/Period4.test
	Confusion Matrix
	 [229   0   0   0   0   0 275]
	 [  0 276   1   0   0   0 227]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 319  10   1 174]
	 [  0   0   8  18 303  82  93]
	 [  0   0  15   0 187 236  66]
	 [  0   0  24   3  92  50 341]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.45436508 0.54761905        nan 0.63293651 0.60119048 0.46825397
 0.66862745]
	Accuracy = 0.5623762376237624
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4544    0.6248       504
	              BookRestaurant     1.0000    0.5476    0.7077       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9382    0.6329    0.7559       504
	          SearchCreativeWork     0.5118    0.6012    0.5529       504
	        SearchScreeningEvent     0.6396    0.4683    0.5407       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2900    0.6686    0.4045       510
	
	                    accuracy                         0.5624      3030
	                   macro avg     0.6257    0.4819    0.5124      3030
	                weighted avg     0.7291    0.5624    0.5974      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.331, 0.331, 0.331, 0.802, 0.541
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.331, 0.802, 0.541
-----------------------------------------------------------------------------------------
Epoch  200: avg_loss: 0.16410810127854347 43814
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 6
avg_representations.shape (1, 6, 200)
Testing:  ../data/dev/Period4.train
Testing:  ../data/dev/Period4.test
Testing:  ../data/dev/Period4.test

offsize, insize 510 2520
bestT, bestV, bestFAR, bestFRR 0.9914184808731079 0.0006769374416433216 0.3568627450980392 0.35753968253968255

 ../data/dev/Period4.test
	Confusion Matrix
	 [226   0   0   0   0   0 278]
	 [  0 161   1   0   0   0 342]
	 [0 0 0 0 0 0 0]
	 [  0   0   0 357  11   1 135]
	 [  0   0   6  25 311  81  81]
	 [  0   0  21   1 198 219  65]
	 [  0   0  24   6 105  47 328]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[0.4484127  0.31944444        nan 0.70833333 0.61706349 0.43452381
 0.64313725]
	Accuracy = 0.5287128712871287
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	               AddToPlaylist     1.0000    0.4484    0.6192       504
	              BookRestaurant     1.0000    0.3194    0.4842       504
	                  GetWeather     0.0000    0.0000    0.0000         0
	                   PlayMusic     0.9177    0.7083    0.7996       504
	          SearchCreativeWork     0.4976    0.6171    0.5509       504
	        SearchScreeningEvent     0.6293    0.4345    0.5141       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.2669    0.6431    0.3772       510
	
	                    accuracy                         0.5287      3030
	                   macro avg     0.6159    0.4530    0.4779      3030
	                weighted avg     0.7177    0.5287    0.5572      3030
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.357, 0.357, 0.358, 0.792, 0.506
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.357, 0.792, 0.506
-----------------------------------------------------------------------------------------
=====Training Finished======
