/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
main.py:105: DeprecationWarning: The SafeConfigParser class has been renamed to ConfigParser in Python 3.2. This alias will be removed in future versions. Use ConfigParser directly instead.
  config_parser = configparser.SafeConfigParser()
All parameters:
	total_epoch==>200
	single_workspace==>False
	w2vfile==>../glove/glove.6B.100d.txt
	mnet_training_dir==>../data/train/
	mnet_training_list==>../data/train/workspace_list
	mnet_dev_dir==>../data/dev/
	mnet_dev_list==>../data/dev/workspace_list
	testing_dir==>../data/test/
	testing_list==>../data/test/workspace_list
	model_string==>dummy
	model_dir==>/dccstor/slad/mingtan/offtopic_paper/outputs/models
	batch_size==>10
	max_length==>40
	emb_size==>100
	encoding==>utf-8
	min_ss_size==>100
	hidden_size==>200
	softmax_factor==>10.0
	learning_rate==>0.001
	remove_target_from_support_set==>True
	dropout_keep_prob==>1.0
	vocabulary==>None
	wordvectors==>None
	offtopic_label==>UNCONFIDENT_INTENT_FROM_SLAD
	sampling_classes==>2
	topk_ss==>0
	layer_num==>1
	enable_batchnorm==>True
	mtl_num_tasks==>0
	filter_size==>3
	ood_threshold==>0.6
	ood_threshold_margin==>0.2
	ood_example_size==>1
	alpha_pos==>1.0
	alpha_neg==>1.0
	alpha_indomain==>1.0
	seed==>3143
Parameters: {
    "total_epoch": 200,
    "single_workspace": false,
    "w2vfile": "../glove/glove.6B.100d.txt",
    "mnet_training_dir": "../data/train/",
    "mnet_training_list": "../data/train/workspace_list",
    "mnet_dev_dir": "../data/dev/",
    "mnet_dev_list": "../data/dev/workspace_list",
    "testing_dir": "../data/test/",
    "testing_list": "../data/test/workspace_list",
    "model_string": "test-run",
    "model_dir": "/dccstor/slad/mingtan/offtopic_paper/outputs/models",
    "batch_size": 10,
    "max_length": 40,
    "emb_size": 100,
    "encoding": "utf-8",
    "min_ss_size": 100,
    "hidden_size": 200,
    "softmax_factor": 10.0,
    "learning_rate": 0.001,
    "remove_target_from_support_set": true,
    "dropout_keep_prob": 1.0,
    "vocabulary": null,
    "wordvectors": null,
    "offtopic_label": "UNCONFIDENT_INTENT_FROM_SLAD",
    "sampling_classes": 2,
    "topk_ss": 0,
    "layer_num": 1,
    "enable_batchnorm": true,
    "mtl_num_tasks": 0,
    "filter_size": 3,
    "ood_threshold": 0.6,
    "ood_threshold_margin": 0.2,
    "ood_example_size": 1,
    "alpha_pos": 1.0,
    "alpha_neg": 1.0,
    "alpha_indomain": 1.0,
    "seed": 3143
}
2021-08-25 17:58:02.857132: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-08-25 17:58:02.869154: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2600000000 Hz
2021-08-25 17:58:02.872821: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55b4e6798a30 executing computations on platform Host. Devices:
2021-08-25 17:58:02.872867: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2021-08-25 17:58:03.053971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:3b:00.0
totalMemory: 15.90GiB freeMemory: 2.44GiB
2021-08-25 17:58:03.054026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2021-08-25 17:58:03.054831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-08-25 17:58:03.054848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2021-08-25 17:58:03.054855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2021-08-25 17:58:03.055069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2199 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 6.0)
2021-08-25 17:58:03.063973: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55b4e6ed4b30 executing computations on platform CUDA. Devices:
2021-08-25 17:58:03.064020: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
get_word_info, params["w2vfile"] -> ../glove/glove.6B.100d.txt
Embed Size 100
Skipped -> 0
wdmap 400000
len(W) 400000
0 words taken from BERT
Time Taken = 0.0007 minutes
After combined with train file
word2idx size: 400198
2021-08-25 17:58:24.697415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2021-08-25 17:58:24.697516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-08-25 17:58:24.697525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2021-08-25 17:58:24.697532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2021-08-25 17:58:24.697809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2199 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 6.0)
WARNING:tensorflow:From /home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/raghab-ankan/code/stream/OOD_IBM/src/model.py:62: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.conv2d instead.
batch norm enabled.

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

g_conv_encoder Tensor("losses/g/truediv:0", shape=(?, 200), dtype=float32)
batch norm enabled.
g_conv_encoder Tensor("losses/g_1/truediv:0", shape=(?, 200), dtype=float32)
batch norm enabled.
g_conv_encoder Tensor("losses/g_2/truediv:0", shape=(?, 200), dtype=float32)
batch norm enabled.
g_conv_encoder Tensor("losses/g_3/truediv:0", shape=(?, 200), dtype=float32)
current_learning_rate 0.001
tf.global_variables()--> <tf.Variable 'W:0' shape=(400198, 100) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/conv1/kernel:0' shape=(3, 1, 100, 200) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/beta:0' shape=(200,) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/gamma:0' shape=(200,) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/moving_mean:0' shape=(200,) dtype=float32_ref>
tf.global_variables()--> <tf.Variable 'g/BatchNorm/moving_variance:0' shape=(200,) dtype=float32_ref>
WARNING:tensorflow:From /home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
get_data: 1 	workspace SearchScreeningEvent                          train_workspace
get_data: 2 	workspace SearchCreativeWork                            train_workspace
get_data: 3 	workspace GetWeather                                    train_workspace
get_data: 1 	workspace Period1                                       valid_workspace
get_data: 1 	workspace Period1                                       test_workspace
Starting epochs, Total = 200
2021-08-25 17:58:47.687069: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 676.99MiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-08-25 17:58:47.694841: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 676.99MiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-08-25 17:58:47.699189: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
2021-08-25 17:58:48.159483: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 709.21MiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-08-25 17:58:48.161374: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 709.21MiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
Epoch    1: avg_loss: 0.4095182617505391 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9967409372329712 0.00025676937441643233 0.31176470588235294 0.3115079365079365

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 22 325 157]
	 [ 53 106 351]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.64484127 0.68823529]
	Accuracy = 0.6666666666666666
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7541    0.6448    0.6952       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.6909    0.6882    0.6896       510
	
	                    accuracy                         0.6667      1014
	                   macro avg     0.4817    0.4444    0.4616      1014
	                weighted avg     0.7223    0.6667    0.6924      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.312, 0.312, 0.312, 0.837, 0.645
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.312, 0.837, 0.645
-----------------------------------------------------------------------------------------
Epoch    2: avg_loss: 0.40901074806849164 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9963557720184326 0.00046685340802987696 0.29411764705882354 0.29365079365079366

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 18 338 148]
	 [ 29 121 360]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.67063492 0.70588235]
	Accuracy = 0.6883629191321499
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7364    0.6706    0.7020       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7087    0.7059    0.7073       510
	
	                    accuracy                         0.6884      1014
	                   macro avg     0.4817    0.4588    0.4697      1014
	                weighted avg     0.7224    0.6884    0.7046      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.294, 0.294, 0.294, 0.875, 0.671
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.294, 0.875, 0.671
-----------------------------------------------------------------------------------------
Epoch    3: avg_loss: 0.3562183777491252 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.996105432510376 0.00060690943043884 0.2823529411764706 0.28174603174603174

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 17 345 142]
	 [ 24 120 366]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.68452381 0.71764706]
	Accuracy = 0.7011834319526628
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7419    0.6845    0.7121       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7205    0.7176    0.7191       510
	
	                    accuracy                         0.7012      1014
	                   macro avg     0.4875    0.4674    0.4770      1014
	                weighted avg     0.7311    0.7012    0.7156      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.282, 0.282, 0.282, 0.891, 0.685
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.282, 0.891, 0.685
-----------------------------------------------------------------------------------------
Epoch    4: avg_loss: 0.3756639063358307 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9958553314208984 0.0007936507936507908 0.26666666666666666 0.26587301587301587

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 17 353 134]
	 [ 22 114 374]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.70039683 0.73333333]
	Accuracy = 0.7169625246548323
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7559    0.7004    0.7271       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7362    0.7333    0.7348       510
	
	                    accuracy                         0.7170      1014
	                   macro avg     0.4974    0.4779    0.4873      1014
	                weighted avg     0.7460    0.7170    0.7310      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.266, 0.267, 0.266, 0.899, 0.700
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.266, 0.899, 0.700
-----------------------------------------------------------------------------------------
Epoch    5: avg_loss: 0.38192394375801086 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9946754574775696 0.0009103641456582601 0.2568627450980392 0.25595238095238093

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 18 357 129]
	 [ 23 108 379]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.70833333 0.74313725]
	Accuracy = 0.7258382642998028
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7677    0.7083    0.7368       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7461    0.7431    0.7446       510
	
	                    accuracy                         0.7258      1014
	                   macro avg     0.5046    0.4838    0.4938      1014
	                weighted avg     0.7568    0.7258    0.7407      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.256, 0.257, 0.256, 0.911, 0.708
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.256, 0.911, 0.708
-----------------------------------------------------------------------------------------
Epoch    6: avg_loss: 0.34944461782773334 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9933695793151855 0.0008636788048552724 0.2607843137254902 0.25992063492063494

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 15 358 131]
	 [ 17 116 377]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.71031746 0.73921569]
	Accuracy = 0.7248520710059172
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7553    0.7103    0.7321       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7421    0.7392    0.7407       510
	
	                    accuracy                         0.7249      1014
	                   macro avg     0.4991    0.4832    0.4909      1014
	                weighted avg     0.7487    0.7249    0.7364      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.260, 0.261, 0.260, 0.921, 0.710
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.260, 0.921, 0.710
-----------------------------------------------------------------------------------------
Epoch    7: avg_loss: 0.3629511098066966 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9926053285598755 0.0008403361344537785 0.2627450980392157 0.2619047619047619

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 17 355 132]
	 [ 16 118 376]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.70436508 0.7372549 ]
	Accuracy = 0.7209072978303748
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7505    0.7044    0.7267       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7402    0.7373    0.7387       510
	
	                    accuracy                         0.7209      1014
	                   macro avg     0.4969    0.4805    0.4885      1014
	                weighted avg     0.7453    0.7209    0.7327      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.262, 0.263, 0.262, 0.919, 0.704
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.262, 0.919, 0.704
-----------------------------------------------------------------------------------------
Epoch    8: avg_loss: 0.3780888120333354 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9916000366210938 0.0008636788048552724 0.2607843137254902 0.25992063492063494

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 13 360 131]
	 [ 15 118 377]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.71428571 0.73921569]
	Accuracy = 0.7268244575936884
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7531    0.7143    0.7332       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7421    0.7392    0.7407       510
	
	                    accuracy                         0.7268      1014
	                   macro avg     0.4984    0.4845    0.4913      1014
	                weighted avg     0.7476    0.7268    0.7370      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.260, 0.261, 0.260, 0.931, 0.714
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.260, 0.931, 0.714
-----------------------------------------------------------------------------------------
Epoch    9: avg_loss: 0.3773728609085083 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.990985631942749 0.0009570494864612478 0.24705882352941178 0.24801587301587302

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 12 367 125]
	 [ 15 111 384]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.7281746  0.75294118]
	Accuracy = 0.7406311637080868
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7678    0.7282    0.7475       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7544    0.7529    0.7537       510
	
	                    accuracy                         0.7406      1014
	                   macro avg     0.5074    0.4937    0.5004      1014
	                weighted avg     0.7611    0.7406    0.7506      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.248, 0.247, 0.248, 0.938, 0.728
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.248, 0.938, 0.728
-----------------------------------------------------------------------------------------
Epoch   10: avg_loss: 0.37927717963854474 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9898239374160767 0.0009570494864612478 0.24705882352941178 0.24801587301587302

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 11 368 125]
	 [ 11 115 384]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73015873 0.75294118]
	Accuracy = 0.7416173570019724
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7619    0.7302    0.7457       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7544    0.7529    0.7537       510
	
	                    accuracy                         0.7416      1014
	                   macro avg     0.5054    0.4944    0.4998      1014
	                weighted avg     0.7581    0.7416    0.7497      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.248, 0.247, 0.248, 0.942, 0.730
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.248, 0.942, 0.730
-----------------------------------------------------------------------------------------
Epoch   11: avg_loss: 0.3391253848870595 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9895666837692261 0.0009570494864612478 0.24705882352941178 0.24801587301587302

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 10 369 125]
	 [ 10 116 384]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73214286 0.75294118]
	Accuracy = 0.742603550295858
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7608    0.7321    0.7462       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7544    0.7529    0.7537       510
	
	                    accuracy                         0.7426      1014
	                   macro avg     0.5051    0.4950    0.5000      1014
	                weighted avg     0.7576    0.7426    0.7500      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.248, 0.247, 0.248, 0.950, 0.732
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.248, 0.950, 0.732
-----------------------------------------------------------------------------------------
Epoch   12: avg_loss: 0.3058195660511653 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9899148344993591 0.0009570494864612478 0.24705882352941178 0.24801587301587302

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 10 369 125]
	 [ 10 116 384]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73214286 0.75294118]
	Accuracy = 0.742603550295858
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7608    0.7321    0.7462       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7544    0.7529    0.7537       510
	
	                    accuracy                         0.7426      1014
	                   macro avg     0.5051    0.4950    0.5000      1014
	                weighted avg     0.7576    0.7426    0.7500      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.248, 0.247, 0.248, 0.956, 0.732
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.248, 0.956, 0.732
-----------------------------------------------------------------------------------------
Epoch   13: avg_loss: 0.34514053662618 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9903992414474487 0.0009803921568627416 0.25098039215686274 0.25

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [ 10 368 126]
	 [  9 119 382]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73015873 0.74901961]
	Accuracy = 0.7396449704142012
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7556    0.7302    0.7427       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7520    0.7490    0.7505       510
	
	                    accuracy                         0.7396      1014
	                   macro avg     0.5025    0.4931    0.4977      1014
	                weighted avg     0.7538    0.7396    0.7466      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.250, 0.251, 0.250, 0.960, 0.730
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.250, 0.960, 0.730
-----------------------------------------------------------------------------------------
Epoch   14: avg_loss: 0.30022868514060974 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9909077882766724 0.0009803921568627416 0.25098039215686274 0.25

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  7 371 126]
	 [  8 120 382]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73611111 0.74901961]
	Accuracy = 0.742603550295858
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7556    0.7361    0.7457       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7520    0.7490    0.7505       510
	
	                    accuracy                         0.7426      1014
	                   macro avg     0.5025    0.4950    0.4987      1014
	                weighted avg     0.7538    0.7426    0.7481      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.250, 0.251, 0.250, 0.964, 0.736
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.250, 0.964, 0.736
-----------------------------------------------------------------------------------------
Epoch   15: avg_loss: 0.27494215965270996 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9920922517776489 0.0009337068160597539 0.2549019607843137 0.25396825396825395

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  7 369 128]
	 [  5 125 380]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73214286 0.74509804]
	Accuracy = 0.7386587771203156
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7470    0.7321    0.7395       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7480    0.7451    0.7466       510
	
	                    accuracy                         0.7387      1014
	                   macro avg     0.4983    0.4924    0.4953      1014
	                weighted avg     0.7475    0.7387    0.7430      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.254, 0.255, 0.254, 0.968, 0.732
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.254, 0.968, 0.732
-----------------------------------------------------------------------------------------
Epoch   16: avg_loss: 0.29537540674209595 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9924488067626953 0.0009103641456582601 0.2568627450980392 0.25595238095238093

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  7 368 129]
	 [  1 130 379]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73015873 0.74313725]
	Accuracy = 0.7366863905325444
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7390    0.7302    0.7345       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7461    0.7431    0.7446       510
	
	                    accuracy                         0.7367      1014
	                   macro avg     0.4950    0.4911    0.4930      1014
	                weighted avg     0.7425    0.7367    0.7396      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.256, 0.257, 0.256, 0.966, 0.730
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.256, 0.966, 0.730
-----------------------------------------------------------------------------------------
Epoch   17: avg_loss: 0.3450227677822113 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9918050765991211 0.0008636788048552724 0.2607843137254902 0.25992063492063494

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 368 131]
	 [  0 133 377]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73015873 0.73921569]
	Accuracy = 0.7347140039447732
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7345    0.7302    0.7323       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7421    0.7392    0.7407       510
	
	                    accuracy                         0.7347      1014
	                   macro avg     0.4922    0.4898    0.4910      1014
	                weighted avg     0.7384    0.7347    0.7365      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.260, 0.261, 0.260, 0.972, 0.730
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.260, 0.972, 0.730
-----------------------------------------------------------------------------------------
Epoch   18: avg_loss: 0.3116312225659688 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9901469349861145 0.0009103641456582601 0.2568627450980392 0.25595238095238093

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 370 129]
	 [  0 131 379]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.73412698 0.74313725]
	Accuracy = 0.7386587771203156
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7385    0.7341    0.7363       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7461    0.7431    0.7446       510
	
	                    accuracy                         0.7387      1014
	                   macro avg     0.4949    0.4924    0.4936      1014
	                weighted avg     0.7423    0.7387    0.7405      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.256, 0.257, 0.256, 0.972, 0.734
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.256, 0.972, 0.734
-----------------------------------------------------------------------------------------
Epoch   19: avg_loss: 0.3633532722791036 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9879288673400879 0.0009337068160597539 0.24509803921568626 0.24603174603174602

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 375 124]
	 [  2 123 385]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.74404762 0.75490196]
	Accuracy = 0.7495069033530573
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7530    0.7440    0.7485       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7564    0.7549    0.7556       510
	
	                    accuracy                         0.7495      1014
	                   macro avg     0.5031    0.4996    0.5014      1014
	                weighted avg     0.7547    0.7495    0.7521      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.246, 0.245, 0.246, 0.972, 0.744
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.246, 0.972, 0.744
-----------------------------------------------------------------------------------------
Epoch   20: avg_loss: 0.2711794873078664 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9868361949920654 0.0008870214752567662 0.2411764705882353 0.24206349206349206

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  4 378 122]
	 [  4 119 387]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.75       0.75882353]
	Accuracy = 0.7544378698224852
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7606    0.7500    0.7552       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7603    0.7588    0.7596       510
	
	                    accuracy                         0.7544      1014
	                   macro avg     0.5070    0.5029    0.5049      1014
	                weighted avg     0.7604    0.7544    0.7574      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.242, 0.241, 0.242, 0.968, 0.750
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.242, 0.968, 0.750
-----------------------------------------------------------------------------------------
Epoch   21: avg_loss: 0.2920261025428772 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.986014723777771 0.000770308123249297 0.23137254901960785 0.23214285714285715

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 382 117]
	 [  5 113 392]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.75793651 0.76862745]
	Accuracy = 0.7633136094674556
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7717    0.7579    0.7648       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7701    0.7686    0.7694       510
	
	                    accuracy                         0.7633      1014
	                   macro avg     0.5140    0.5089    0.5114      1014
	                weighted avg     0.7709    0.7633    0.7671      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.232, 0.231, 0.232, 0.966, 0.758
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.232, 0.966, 0.758
-----------------------------------------------------------------------------------------
Epoch   22: avg_loss: 0.296736220518748 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9825102686882019 0.0007002801120448154 0.22549019607843138 0.2261904761904762

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  6 384 114]
	 [  6 109 395]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76190476 0.7745098 ]
	Accuracy = 0.7682445759368837
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7789    0.7619    0.7703       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7760    0.7745    0.7753       510
	
	                    accuracy                         0.7682      1014
	                   macro avg     0.5183    0.5121    0.5152      1014
	                weighted avg     0.7775    0.7682    0.7728      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.226, 0.225, 0.226, 0.960, 0.762
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.226, 0.960, 0.762
-----------------------------------------------------------------------------------------
Epoch   23: avg_loss: 0.28168751299381256 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9809476137161255 0.0006535947712418277 0.22156862745098038 0.2222222222222222

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  8 384 112]
	 [  9 104 397]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76190476 0.77843137]
	Accuracy = 0.7702169625246549
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7869    0.7619    0.7742       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7800    0.7784    0.7792       510
	
	                    accuracy                         0.7702      1014
	                   macro avg     0.5223    0.5134    0.5178      1014
	                weighted avg     0.7834    0.7702    0.7767      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.222, 0.222, 0.222, 0.958, 0.762
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.222, 0.958, 0.762
-----------------------------------------------------------------------------------------
Epoch   24: avg_loss: 0.3096778591473897 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9766391515731812 0.0005602240896358524 0.21372549019607842 0.21428571428571427

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  6 390 108]
	 [  6 103 401]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.77380952 0.78627451]
	Accuracy = 0.7800788954635108
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7911    0.7738    0.7823       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7878    0.7863    0.7870       510
	
	                    accuracy                         0.7801      1014
	                   macro avg     0.5263    0.5200    0.5231      1014
	                weighted avg     0.7894    0.7801    0.7847      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.214, 0.214, 0.214, 0.964, 0.774
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.214, 0.964, 0.774
-----------------------------------------------------------------------------------------
Epoch   25: avg_loss: 0.3090420713027318 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9820745587348938 0.0005368814192343585 0.21176470588235294 0.2123015873015873

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 392 107]
	 [  3 105 402]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.77777778 0.78823529]
	Accuracy = 0.7830374753451677
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7887    0.7778    0.7832       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7898    0.7882    0.7890       510
	
	                    accuracy                         0.7830      1014
	                   macro avg     0.5262    0.5220    0.5241      1014
	                weighted avg     0.7893    0.7830    0.7861      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.212, 0.212, 0.212, 0.972, 0.778
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.212, 0.972, 0.778
-----------------------------------------------------------------------------------------
Epoch   26: avg_loss: 0.2743295182784398 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9824897050857544 0.0005368814192343585 0.21176470588235294 0.2123015873015873

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  6 391 107]
	 [  2 106 402]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.77579365 0.78823529]
	Accuracy = 0.782051282051282
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7867    0.7758    0.7812       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7898    0.7882    0.7890       510
	
	                    accuracy                         0.7821      1014
	                   macro avg     0.5255    0.5213    0.5234      1014
	                weighted avg     0.7883    0.7821    0.7851      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.212, 0.212, 0.212, 0.968, 0.776
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.212, 0.968, 0.776
-----------------------------------------------------------------------------------------
Epoch   27: avg_loss: 0.28900885581970215 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9735275506973267 0.0004901960784313708 0.20784313725490197 0.20833333333333334

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  6 393 105]
	 [  3 103 404]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.7797619  0.79215686]
	Accuracy = 0.7859960552268245
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7923    0.7798    0.7860       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7937    0.7922    0.7929       510
	
	                    accuracy                         0.7860      1014
	                   macro avg     0.5287    0.5240    0.5263      1014
	                weighted avg     0.7930    0.7860    0.7895      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.208, 0.208, 0.208, 0.962, 0.780
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.208, 0.962, 0.780
-----------------------------------------------------------------------------------------
Epoch   28: avg_loss: 0.27703864872455597 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9704418182373047 0.00037348272642390157 0.1980392156862745 0.1984126984126984

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  8 396 100]
	 [  4  97 409]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.78571429 0.80196078]
	Accuracy = 0.7938856015779092
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8032    0.7857    0.7944       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8035    0.8020    0.8027       510
	
	                    accuracy                         0.7939      1014
	                   macro avg     0.5356    0.5292    0.5324      1014
	                weighted avg     0.8034    0.7939    0.7986      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.198, 0.198, 0.198, 0.958, 0.786
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.198, 0.958, 0.786
-----------------------------------------------------------------------------------------
Epoch   29: avg_loss: 0.2747502972682317 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.974726676940918 0.0003968253968253954 0.2 0.2003968253968254

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  8 395 101]
	 [  1 101 408]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.78373016 0.8       ]
	Accuracy = 0.7919132149901381
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7964    0.7837    0.7900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8016    0.8000    0.8008       510
	
	                    accuracy                         0.7919      1014
	                   macro avg     0.5326    0.5279    0.5303      1014
	                weighted avg     0.7990    0.7919    0.7954      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.200, 0.200, 0.200, 0.962, 0.784
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.200, 0.962, 0.784
-----------------------------------------------------------------------------------------
Epoch   30: avg_loss: 0.230059747894605 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.984555721282959 0.00042016806722688926 0.2019607843137255 0.20238095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  8 394 102]
	 [  0 103 407]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.78174603 0.79803922]
	Accuracy = 0.7899408284023669
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7928    0.7817    0.7872       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7996    0.7980    0.7988       510
	
	                    accuracy                         0.7899      1014
	                   macro avg     0.5308    0.5266    0.5287      1014
	                weighted avg     0.7962    0.7899    0.7931      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.202, 0.202, 0.202, 0.966, 0.782
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.202, 0.966, 0.782
-----------------------------------------------------------------------------------------
Epoch   31: avg_loss: 0.24415567020575205 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9875763654708862 0.0004901960784313708 0.20784313725490197 0.20833333333333334

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  7 392 105]
	 [  0 106 404]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.77777778 0.79215686]
	Accuracy = 0.7850098619329389
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7871    0.7778    0.7824       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7937    0.7922    0.7929       510
	
	                    accuracy                         0.7850      1014
	                   macro avg     0.5270    0.5233    0.5251      1014
	                weighted avg     0.7905    0.7850    0.7877      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.208, 0.208, 0.208, 0.972, 0.778
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.208, 0.972, 0.778
-----------------------------------------------------------------------------------------
Epoch   32: avg_loss: 0.20889591177304587 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9861485958099365 0.0006302521008403339 0.2196078431372549 0.22023809523809523

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 388 111]
	 [  0 112 398]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76984127 0.78039216]
	Accuracy = 0.7751479289940828
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7760    0.7698    0.7729       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7819    0.7804    0.7812       510
	
	                    accuracy                         0.7751      1014
	                   macro avg     0.5193    0.5167    0.5180      1014
	                weighted avg     0.7790    0.7751    0.7771      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.220, 0.220, 0.220, 0.972, 0.770
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.220, 0.972, 0.770
-----------------------------------------------------------------------------------------
Epoch   33: avg_loss: 0.25751765072345734 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9844843149185181 0.0007002801120448154 0.22549019607843138 0.2261904761904762

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  4 386 114]
	 [  0 115 395]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76587302 0.7745098 ]
	Accuracy = 0.7702169625246549
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7705    0.7659    0.7682       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7760    0.7745    0.7753       510
	
	                    accuracy                         0.7702      1014
	                   macro avg     0.5155    0.5135    0.5145      1014
	                weighted avg     0.7733    0.7702    0.7717      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.226, 0.225, 0.226, 0.976, 0.766
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.226, 0.976, 0.766
-----------------------------------------------------------------------------------------
Epoch   34: avg_loss: 0.2421268771092097 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9839669466018677 0.0007469654528478031 0.22941176470588234 0.23015873015873015

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 386 116]
	 [  0 117 393]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76587302 0.77058824]
	Accuracy = 0.7682445759368837
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7674    0.7659    0.7666       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7721    0.7706    0.7713       510
	
	                    accuracy                         0.7682      1014
	                   macro avg     0.5132    0.5122    0.5127      1014
	                weighted avg     0.7698    0.7682    0.7690      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.230, 0.229, 0.230, 0.976, 0.766
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.230, 0.976, 0.766
-----------------------------------------------------------------------------------------
Epoch   35: avg_loss: 0.23767143984635672 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9853488206863403 0.0007002801120448154 0.22549019607843138 0.2261904761904762

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 388 114]
	 [  0 115 395]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76984127 0.7745098 ]
	Accuracy = 0.772189349112426
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7714    0.7698    0.7706       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7760    0.7745    0.7753       510
	
	                    accuracy                         0.7722      1014
	                   macro avg     0.5158    0.5148    0.5153      1014
	                weighted avg     0.7737    0.7722    0.7730      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.226, 0.225, 0.226, 0.976, 0.770
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.226, 0.976, 0.770
-----------------------------------------------------------------------------------------
Epoch   36: avg_loss: 0.22668112317721048 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9826576113700867 0.0007236227824463093 0.22745098039215686 0.22817460317460317

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 386 115]
	 [  0 116 394]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76587302 0.77254902]
	Accuracy = 0.7692307692307693
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7689    0.7659    0.7674       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7741    0.7725    0.7733       510
	
	                    accuracy                         0.7692      1014
	                   macro avg     0.5143    0.5128    0.5136      1014
	                weighted avg     0.7715    0.7692    0.7704      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.228, 0.227, 0.228, 0.974, 0.766
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.228, 0.974, 0.766
-----------------------------------------------------------------------------------------
Epoch   37: avg_loss: 0.19711217284202576 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9798805713653564 0.0006769374416433216 0.2235294117647059 0.22420634920634921

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 388 113]
	 [  0 114 396]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76984127 0.77647059]
	Accuracy = 0.7731755424063116
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7729    0.7698    0.7714       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7780    0.7765    0.7772       510
	
	                    accuracy                         0.7732      1014
	                   macro avg     0.5170    0.5154    0.5162      1014
	                weighted avg     0.7755    0.7732    0.7743      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.224, 0.224, 0.224, 0.972, 0.770
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.224, 0.972, 0.770
-----------------------------------------------------------------------------------------
Epoch   38: avg_loss: 0.15797361234823862 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9832982420921326 0.0006769374416433216 0.2235294117647059 0.22420634920634921

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 388 113]
	 [  0 114 396]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.76984127 0.77647059]
	Accuracy = 0.7731755424063116
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7729    0.7698    0.7714       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7780    0.7765    0.7772       510
	
	                    accuracy                         0.7732      1014
	                   macro avg     0.5170    0.5154    0.5162      1014
	                weighted avg     0.7755    0.7732    0.7743      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.224, 0.224, 0.224, 0.970, 0.770
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.224, 0.970, 0.770
-----------------------------------------------------------------------------------------
Epoch   39: avg_loss: 0.23892409602801004 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9857791662216187 0.00060690943043884 0.21764705882352942 0.21825396825396826

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 389 110]
	 [  0 111 399]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.7718254  0.78235294]
	Accuracy = 0.777120315581854
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7780    0.7718    0.7749       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7839    0.7824    0.7831       510
	
	                    accuracy                         0.7771      1014
	                   macro avg     0.5206    0.5181    0.5193      1014
	                weighted avg     0.7810    0.7771    0.7790      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.218, 0.218, 0.218, 0.970, 0.772
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.218, 0.970, 0.772
-----------------------------------------------------------------------------------------
Epoch   40: avg_loss: 0.24614312748114267 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9836143255233765 0.00046685340802987696 0.20588235294117646 0.20634920634920634

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  6 394 104]
	 [  2 103 405]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.78174603 0.79411765]
	Accuracy = 0.7879684418145957
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7928    0.7817    0.7872       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7957    0.7941    0.7949       510
	
	                    accuracy                         0.7880      1014
	                   macro avg     0.5295    0.5253    0.5274      1014
	                weighted avg     0.7942    0.7880    0.7911      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.206, 0.206, 0.206, 0.974, 0.782
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.206, 0.974, 0.782
-----------------------------------------------------------------------------------------
Epoch   41: avg_loss: 0.1715415964523951 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9855416417121887 0.00032679738562091387 0.19411764705882353 0.19444444444444445

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 401  98]
	 [  1  98 411]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79563492 0.80588235]
	Accuracy = 0.8007889546351085
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8036    0.7956    0.7996       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8075    0.8059    0.8067       510
	
	                    accuracy                         0.8008      1014
	                   macro avg     0.5370    0.5338    0.5354      1014
	                weighted avg     0.8055    0.8008    0.8032      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.194, 0.194, 0.194, 0.980, 0.796
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.194, 0.980, 0.796
-----------------------------------------------------------------------------------------
Epoch   42: avg_loss: 0.20479928950468698 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9846956729888916 0.0003968253968253954 0.2 0.2003968253968254

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  5 398 101]
	 [  1 101 408]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.78968254 0.8       ]
	Accuracy = 0.7948717948717948
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7976    0.7897    0.7936       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8016    0.8000    0.8008       510
	
	                    accuracy                         0.7949      1014
	                   macro avg     0.5331    0.5299    0.5315      1014
	                weighted avg     0.7996    0.7949    0.7972      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.200, 0.200, 0.200, 0.980, 0.790
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.200, 0.980, 0.790
-----------------------------------------------------------------------------------------
Epoch   43: avg_loss: 0.188812385002772 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9820536375045776 0.00037348272642390157 0.1980392156862745 0.1984126984126984

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 401 100]
	 [  0 101 409]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79563492 0.80196078]
	Accuracy = 0.7988165680473372
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7988    0.7956    0.7972       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8035    0.8020    0.8027       510
	
	                    accuracy                         0.7988      1014
	                   macro avg     0.5341    0.5325    0.5333      1014
	                weighted avg     0.8012    0.7988    0.8000      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.198, 0.198, 0.198, 0.982, 0.796
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.198, 0.982, 0.796
-----------------------------------------------------------------------------------------
Epoch   44: avg_loss: 0.1854879011710485 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9813261032104492 0.0003501400560224077 0.19607843137254902 0.19642857142857142

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 402  99]
	 [  0 100 410]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79761905 0.80392157]
	Accuracy = 0.8007889546351085
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8008    0.7976    0.7992       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8055    0.8039    0.8047       510
	
	                    accuracy                         0.8008      1014
	                   macro avg     0.5354    0.5338    0.5346      1014
	                weighted avg     0.8032    0.8008    0.8020      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.196, 0.196, 0.196, 0.980, 0.798
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.196, 0.980, 0.798
-----------------------------------------------------------------------------------------
Epoch   45: avg_loss: 0.23960121969381967 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9846335649490356 0.00037348272642390157 0.1980392156862745 0.1984126984126984

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 401 100]
	 [  0 101 409]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79563492 0.80196078]
	Accuracy = 0.7988165680473372
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7988    0.7956    0.7972       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8035    0.8020    0.8027       510
	
	                    accuracy                         0.7988      1014
	                   macro avg     0.5341    0.5325    0.5333      1014
	                weighted avg     0.8012    0.7988    0.8000      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.198, 0.198, 0.198, 0.978, 0.796
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.198, 0.978, 0.796
-----------------------------------------------------------------------------------------
Epoch   46: avg_loss: 0.21171294649442038 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9814662933349609 0.00018674136321195078 0.18235294117647058 0.18253968253968253

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 409  92]
	 [  1  92 417]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.81150794 0.81764706]
	Accuracy = 0.814595660749507
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8164    0.8115    0.8139       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8193    0.8176    0.8184       510
	
	                    accuracy                         0.8146      1014
	                   macro avg     0.5452    0.5431    0.5441      1014
	                weighted avg     0.8178    0.8146    0.8162      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.182, 0.182, 0.183, 0.978, 0.812
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.182, 0.978, 0.812
-----------------------------------------------------------------------------------------
Epoch   47: avg_loss: 0.1914451668659846 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9729077816009521 0.0 0.16666666666666666 0.16666666666666666

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 418  84]
	 [  0  85 425]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82936508 0.83333333]
	Accuracy = 0.8313609467455622
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8310    0.8294    0.8302       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8350    0.8333    0.8342       510
	
	                    accuracy                         0.8314      1014
	                   macro avg     0.5553    0.5542    0.5548      1014
	                weighted avg     0.8330    0.8314    0.8322      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.167, 0.167, 0.167, 0.980, 0.829
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.167, 0.980, 0.829
-----------------------------------------------------------------------------------------
Epoch   48: avg_loss: 0.18488199263811111 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.975490927696228 4.6685340802987696e-05 0.17058823529411765 0.17063492063492064

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 417  86]
	 [  0  87 423]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82738095 0.82941176]
	Accuracy = 0.8284023668639053
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8274    0.8274    0.8274       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8310    0.8294    0.8302       510
	
	                    accuracy                         0.8284      1014
	                   macro avg     0.5528    0.5523    0.5525      1014
	                weighted avg     0.8292    0.8284    0.8288      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.171, 0.171, 0.171, 0.984, 0.827
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.171, 0.984, 0.827
-----------------------------------------------------------------------------------------
Epoch   49: avg_loss: 0.17690499623616537 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9778860807418823 7.002801120448154e-05 0.17254901960784313 0.17261904761904762

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 415  87]
	 [  0  88 422]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.8234127  0.82745098]
	Accuracy = 0.8254437869822485
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8250    0.8234    0.8242       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8291    0.8275    0.8283       510
	
	                    accuracy                         0.8254      1014
	                   macro avg     0.5514    0.5503    0.5508      1014
	                weighted avg     0.8271    0.8254    0.8263      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.173, 0.173, 0.173, 0.982, 0.823
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.173, 0.982, 0.823
-----------------------------------------------------------------------------------------
Epoch   50: avg_loss: 0.1904706358909607 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9818414449691772 2.3342670401493848e-05 0.16862745098039217 0.16865079365079366

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 418  85]
	 [  0  86 424]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82936508 0.83137255]
	Accuracy = 0.8303747534516766
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8294    0.8294    0.8294       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8330    0.8314    0.8322       510
	
	                    accuracy                         0.8304      1014
	                   macro avg     0.5541    0.5536    0.5539      1014
	                weighted avg     0.8312    0.8304    0.8308      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.169, 0.169, 0.169, 0.984, 0.829
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.169, 0.984, 0.829
-----------------------------------------------------------------------------------------
Epoch   51: avg_loss: 0.2020981435974439 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9809747934341431 2.3342670401493848e-05 0.16470588235294117 0.16468253968253968

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 420  83]
	 [  0  84 426]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83333333 0.83529412]
	Accuracy = 0.834319526627219
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8333    0.8333    0.8333       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8369    0.8353    0.8361       510
	
	                    accuracy                         0.8343      1014
	                   macro avg     0.5568    0.5562    0.5565      1014
	                weighted avg     0.8351    0.8343    0.8347      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.165, 0.165, 0.165, 0.990, 0.833
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.165, 0.990, 0.833
-----------------------------------------------------------------------------------------
Epoch   52: avg_loss: 0.22871138403813043 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9772890210151672 0.0003968253968253954 0.13333333333333333 0.13293650793650794

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 436  67]
	 [  0  68 442]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86507937 0.86666667]
	Accuracy = 0.8658777120315582
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8651    0.8651    0.8651       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8684    0.8667    0.8675       510
	
	                    accuracy                         0.8659      1014
	                   macro avg     0.5778    0.5772    0.5775      1014
	                weighted avg     0.8667    0.8659    0.8663      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.133, 0.133, 0.133, 0.990, 0.865
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.133, 0.990, 0.865
-----------------------------------------------------------------------------------------
Epoch   53: avg_loss: 0.11430414393544197 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9849790930747986 9.337068160597539e-05 0.1588235294117647 0.15873015873015872

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 422  80]
	 [  0  81 429]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83730159 0.84117647]
	Accuracy = 0.8392504930966469
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8390    0.8373    0.8381       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8428    0.8412    0.8420       510
	
	                    accuracy                         0.8393      1014
	                   macro avg     0.5606    0.5595    0.5600      1014
	                weighted avg     0.8409    0.8393    0.8401      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.159, 0.159, 0.159, 0.986, 0.837
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.159, 0.986, 0.837
-----------------------------------------------------------------------------------------
Epoch   54: avg_loss: 0.23613602419694266 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9885392189025879 0.00011671335200746924 0.17647058823529413 0.1765873015873016

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 413  89]
	 [  0  90 420]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.81944444 0.82352941]
	Accuracy = 0.8214990138067061
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8211    0.8194    0.8203       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8251    0.8235    0.8243       510
	
	                    accuracy                         0.8215      1014
	                   macro avg     0.5487    0.5477    0.5482      1014
	                weighted avg     0.8231    0.8215    0.8223      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.177, 0.176, 0.177, 0.982, 0.819
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.177, 0.982, 0.819
-----------------------------------------------------------------------------------------
Epoch   55: avg_loss: 0.2623256395260493 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9901118874549866 0.00018674136321195078 0.18235294117647058 0.18253968253968253

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 411  92]
	 [  0  93 417]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.81547619 0.81764706]
	Accuracy = 0.8165680473372781
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8155    0.8155    0.8155       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8193    0.8176    0.8184       510
	
	                    accuracy                         0.8166      1014
	                   macro avg     0.5449    0.5444    0.5446      1014
	                weighted avg     0.8174    0.8166    0.8170      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.182, 0.182, 0.183, 0.988, 0.815
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.182, 0.988, 0.815
-----------------------------------------------------------------------------------------
Epoch   56: avg_loss: 0.24647820989290872 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9927045106887817 0.00032679738562091387 0.19411764705882353 0.19444444444444445

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 405  98]
	 [  0  99 411]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.80357143 0.80588235]
	Accuracy = 0.8047337278106509
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8036    0.8036    0.8036       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8075    0.8059    0.8067       510
	
	                    accuracy                         0.8047      1014
	                   macro avg     0.5370    0.5365    0.5367      1014
	                weighted avg     0.8055    0.8047    0.8051      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.194, 0.194, 0.194, 0.994, 0.804
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.194, 0.994, 0.804
-----------------------------------------------------------------------------------------
Epoch   57: avg_loss: 0.23958899080753326 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9890391230583191 0.00046685340802987696 0.20588235294117646 0.20634920634920634

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 399 104]
	 [  0 105 405]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79166667 0.79411765]
	Accuracy = 0.7928994082840237
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7917    0.7917    0.7917       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7957    0.7941    0.7949       510
	
	                    accuracy                         0.7929      1014
	                   macro avg     0.5291    0.5286    0.5289      1014
	                weighted avg     0.7937    0.7929    0.7933      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.206, 0.206, 0.206, 0.992, 0.792
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.206, 0.992, 0.792
-----------------------------------------------------------------------------------------
Epoch   58: avg_loss: 0.24468822280565897 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9838829040527344 0.0005602240896358524 0.21372549019607842 0.21428571428571427

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 394 108]
	 [  0 109 401]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.78174603 0.78627451]
	Accuracy = 0.7840236686390533
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7833    0.7817    0.7825       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7878    0.7863    0.7870       510
	
	                    accuracy                         0.7840      1014
	                   macro avg     0.5237    0.5227    0.5232      1014
	                weighted avg     0.7856    0.7840    0.7848      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.214, 0.214, 0.214, 0.990, 0.782
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.214, 0.990, 0.782
-----------------------------------------------------------------------------------------
Epoch   59: avg_loss: 0.2101456026236216 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9831403493881226 0.0003968253968253954 0.2 0.2003968253968254

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 401 101]
	 [  0 102 408]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79563492 0.8       ]
	Accuracy = 0.7978303747534516
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7972    0.7956    0.7964       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8016    0.8000    0.8008       510
	
	                    accuracy                         0.7978      1014
	                   macro avg     0.5329    0.5319    0.5324      1014
	                weighted avg     0.7994    0.7978    0.7986      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.200, 0.200, 0.200, 0.984, 0.796
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.200, 0.984, 0.796
-----------------------------------------------------------------------------------------
Epoch   60: avg_loss: 0.3107701539993286 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9802066087722778 0.00042016806722688926 0.2019607843137255 0.20238095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 400 102]
	 [  0 103 407]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79365079 0.79803922]
	Accuracy = 0.7958579881656804
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7952    0.7937    0.7944       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7996    0.7980    0.7988       510
	
	                    accuracy                         0.7959      1014
	                   macro avg     0.5316    0.5306    0.5311      1014
	                weighted avg     0.7974    0.7959    0.7966      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.202, 0.202, 0.202, 0.984, 0.794
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.202, 0.984, 0.794
-----------------------------------------------------------------------------------------
Epoch   61: avg_loss: 0.19978449245293936 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9841086268424988 0.0004435107376283831 0.20392156862745098 0.20436507936507936

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 399 103]
	 [  1 103 406]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.79166667 0.79607843]
	Accuracy = 0.7938856015779092
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.7948    0.7917    0.7932       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.7976    0.7961    0.7969       510
	
	                    accuracy                         0.7939      1014
	                   macro avg     0.5308    0.5292    0.5300      1014
	                weighted avg     0.7962    0.7939    0.7951      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.204, 0.204, 0.204, 0.988, 0.792
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.204, 0.988, 0.792
-----------------------------------------------------------------------------------------
Epoch   62: avg_loss: 0.18066694835821787 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9852240085601807 0.0002801120448179262 0.19019607843137254 0.19047619047619047

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 406  96]
	 [  1  96 413]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.80555556 0.80980392]
	Accuracy = 0.8076923076923077
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8088    0.8056    0.8072       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8114    0.8098    0.8106       510
	
	                    accuracy                         0.8077      1014
	                   macro avg     0.5401    0.5385    0.5393      1014
	                weighted avg     0.8101    0.8077    0.8089      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.190, 0.190, 0.190, 0.982, 0.806
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.190, 0.982, 0.806
-----------------------------------------------------------------------------------------
Epoch   63: avg_loss: 0.16158663481473923 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9876732230186462 2.3342670401493848e-05 0.16862745098039217 0.16865079365079366

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 417  85]
	 [  1  85 424]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82738095 0.83137255]
	Accuracy = 0.8293885601577909
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8307    0.8274    0.8290       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8330    0.8314    0.8322       510
	
	                    accuracy                         0.8294      1014
	                   macro avg     0.5546    0.5529    0.5537      1014
	                weighted avg     0.8318    0.8294    0.8306      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.169, 0.169, 0.169, 0.984, 0.827
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.169, 0.984, 0.827
-----------------------------------------------------------------------------------------
Epoch   64: avg_loss: 0.1443521504600843 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9811075925827026 0.0 0.16666666666666666 0.16666666666666666

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 418  84]
	 [  1  84 425]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82936508 0.83333333]
	Accuracy = 0.8313609467455622
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8327    0.8294    0.8310       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8350    0.8333    0.8342       510
	
	                    accuracy                         0.8314      1014
	                   macro avg     0.5559    0.5542    0.5551      1014
	                weighted avg     0.8338    0.8314    0.8326      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.167, 0.167, 0.167, 0.984, 0.829
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.167, 0.984, 0.829
-----------------------------------------------------------------------------------------
Epoch   65: avg_loss: 0.16095971564451853 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9783845543861389 0.0002801120448179262 0.19019607843137254 0.19047619047619047

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 407  96]
	 [  0  97 413]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.80753968 0.80980392]
	Accuracy = 0.8086785009861933
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8075    0.8075    0.8075       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8114    0.8098    0.8106       510
	
	                    accuracy                         0.8087      1014
	                   macro avg     0.5396    0.5391    0.5394      1014
	                weighted avg     0.8095    0.8087    0.8091      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.190, 0.190, 0.190, 0.988, 0.808
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.190, 0.988, 0.808
-----------------------------------------------------------------------------------------
Epoch   66: avg_loss: 0.22125385204950967 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9858063459396362 0.00018674136321195078 0.18235294117647058 0.18253968253968253

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 411  92]
	 [  0  93 417]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.81547619 0.81764706]
	Accuracy = 0.8165680473372781
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8155    0.8155    0.8155       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8193    0.8176    0.8184       510
	
	                    accuracy                         0.8166      1014
	                   macro avg     0.5449    0.5444    0.5446      1014
	                weighted avg     0.8174    0.8166    0.8170      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.182, 0.182, 0.183, 0.992, 0.815
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.182, 0.992, 0.815
-----------------------------------------------------------------------------------------
Epoch   67: avg_loss: 0.20374765992164612 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9872352480888367 9.337068160597539e-05 0.17450980392156862 0.1746031746031746

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 414  88]
	 [  0  89 421]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82142857 0.8254902 ]
	Accuracy = 0.8234714003944773
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8231    0.8214    0.8222       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8271    0.8255    0.8263       510
	
	                    accuracy                         0.8235      1014
	                   macro avg     0.5501    0.5490    0.5495      1014
	                weighted avg     0.8251    0.8235    0.8243      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.175, 0.175, 0.175, 0.988, 0.821
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.175, 0.988, 0.821
-----------------------------------------------------------------------------------------
Epoch   68: avg_loss: 0.17891021569569907 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9843733310699463 0.00011671335200746924 0.17647058823529413 0.1765873015873016

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 413  89]
	 [  0  90 420]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.81944444 0.82352941]
	Accuracy = 0.8214990138067061
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8211    0.8194    0.8203       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8251    0.8235    0.8243       510
	
	                    accuracy                         0.8215      1014
	                   macro avg     0.5487    0.5477    0.5482      1014
	                weighted avg     0.8231    0.8215    0.8223      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.177, 0.176, 0.177, 0.984, 0.819
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.177, 0.984, 0.819
-----------------------------------------------------------------------------------------
Epoch   69: avg_loss: 0.24116521080334982 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9768628478050232 7.002801120448154e-05 0.17254901960784313 0.17261904761904762

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 415  87]
	 [  1  87 422]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.8234127  0.82745098]
	Accuracy = 0.8254437869822485
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8267    0.8234    0.8250       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8291    0.8275    0.8283       510
	
	                    accuracy                         0.8254      1014
	                   macro avg     0.5519    0.5503    0.5511      1014
	                weighted avg     0.8279    0.8254    0.8267      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.173, 0.173, 0.173, 0.980, 0.823
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.173, 0.980, 0.823
-----------------------------------------------------------------------------------------
Epoch   70: avg_loss: 0.18440495183070502 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.980535626411438 2.3342670401493848e-05 0.16862745098039217 0.16865079365079366

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 416  85]
	 [  1  85 424]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.82539683 0.83137255]
	Accuracy = 0.8284023668639053
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8303    0.8254    0.8279       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8330    0.8314    0.8322       510
	
	                    accuracy                         0.8284      1014
	                   macro avg     0.5544    0.5523    0.5533      1014
	                weighted avg     0.8317    0.8284    0.8300      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.169, 0.169, 0.169, 0.980, 0.825
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.169, 0.980, 0.825
-----------------------------------------------------------------------------------------
Epoch   71: avg_loss: 0.1926767627398173 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9799983501434326 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 427  75]
	 [  0  76 434]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.84722222 0.85098039]
	Accuracy = 0.849112426035503
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8489    0.8472    0.8481       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.5672    0.5661    0.5666      1014
	                weighted avg     0.8508    0.8491    0.8500      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.984, 0.847
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.984, 0.847
-----------------------------------------------------------------------------------------
Epoch   72: avg_loss: 0.22613649566968283 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9783602356910706 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [428  76]
	 [ 77 433]
	Classwise Accuracies
	Labels
	[0.84920635 0.84901961]
	Accuracy = 0.849112426035503
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8475    0.8492    0.8484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.8491    0.8491    0.8491      1014
	                weighted avg     0.8491    0.8491    0.8491      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.986, 0.849
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.986, 0.849
-----------------------------------------------------------------------------------------
Epoch   73: avg_loss: 0.16423186038931212 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9799848794937134 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [429  75]
	 [ 76 434]
	Classwise Accuracies
	Labels
	[0.85119048 0.85098039]
	Accuracy = 0.8510848126232742
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8495    0.8512    0.8503       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8511      1014
	                   macro avg     0.8511    0.8511    0.8511      1014
	                weighted avg     0.8511    0.8511    0.8511      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.984, 0.851
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.984, 0.851
-----------------------------------------------------------------------------------------
Epoch   74: avg_loss: 0.2199019268155098 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9883012771606445 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [429  75]
	 [ 76 434]
	Classwise Accuracies
	Labels
	[0.85119048 0.85098039]
	Accuracy = 0.8510848126232742
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8495    0.8512    0.8503       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8511      1014
	                   macro avg     0.8511    0.8511    0.8511      1014
	                weighted avg     0.8511    0.8511    0.8511      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.978, 0.851
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.978, 0.851
-----------------------------------------------------------------------------------------
Epoch   75: avg_loss: 0.1768422449628512 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9900373220443726 0.0001400560224089631 0.15490196078431373 0.15476190476190477

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 424  78]
	 [  0  79 431]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.84126984 0.84509804]
	Accuracy = 0.8431952662721893
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8429    0.8413    0.8421       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8468    0.8451    0.8459       510
	
	                    accuracy                         0.8432      1014
	                   macro avg     0.5632    0.5621    0.5627      1014
	                weighted avg     0.8449    0.8432    0.8440      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.155, 0.155, 0.155, 0.976, 0.841
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.155, 0.976, 0.841
-----------------------------------------------------------------------------------------
Epoch   76: avg_loss: 0.15855828921000162 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9895467162132263 0.00016339869281045694 0.15294117647058825 0.1527777777777778

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 425  77]
	 [  0  78 432]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.84325397 0.84705882]
	Accuracy = 0.8451676528599605
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8449    0.8433    0.8441       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8487    0.8471    0.8479       510
	
	                    accuracy                         0.8452      1014
	                   macro avg     0.5646    0.5634    0.5640      1014
	                weighted avg     0.8468    0.8452    0.8460      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.153, 0.153, 0.153, 0.976, 0.843
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.153, 0.976, 0.843
-----------------------------------------------------------------------------------------
Epoch   77: avg_loss: 0.19082780927419662 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9802720546722412 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 426  76]
	 [  1  76 433]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.8452381  0.84901961]
	Accuracy = 0.8471400394477318
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8486    0.8452    0.8469       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8471      1014
	                   macro avg     0.5664    0.5648    0.5656      1014
	                weighted avg     0.8497    0.8471    0.8484      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.974, 0.845
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.974, 0.845
-----------------------------------------------------------------------------------------
Epoch   78: avg_loss: 0.22085178891817728 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9656044244766235 0.0003501400560224077 0.13725490196078433 0.13690476190476192

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 434  69]
	 [  0  70 440]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86111111 0.8627451 ]
	Accuracy = 0.8619329388560157
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8611    0.8611    0.8611       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8644    0.8627    0.8636       510
	
	                    accuracy                         0.8619      1014
	                   macro avg     0.5752    0.5746    0.5749      1014
	                weighted avg     0.8628    0.8619    0.8624      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.137, 0.137, 0.137, 0.980, 0.861
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.137, 0.980, 0.861
-----------------------------------------------------------------------------------------
Epoch   79: avg_loss: 0.18404911955197653 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9791667461395264 0.00030345471521942 0.1411764705882353 0.14087301587301587

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 432  71]
	 [  0  72 438]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.85714286 0.85882353]
	Accuracy = 0.8579881656804734
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8571    0.8571    0.8571       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8605    0.8588    0.8597       510
	
	                    accuracy                         0.8580      1014
	                   macro avg     0.5726    0.5720    0.5723      1014
	                weighted avg     0.8588    0.8580    0.8584      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.141, 0.141, 0.141, 0.978, 0.857
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.141, 0.978, 0.857
-----------------------------------------------------------------------------------------
Epoch   80: avg_loss: 0.10246170560518901 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9881182909011841 0.0003501400560224077 0.13725490196078433 0.13690476190476192

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 434  69]
	 [  0  70 440]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86111111 0.8627451 ]
	Accuracy = 0.8619329388560157
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8611    0.8611    0.8611       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8644    0.8627    0.8636       510
	
	                    accuracy                         0.8619      1014
	                   macro avg     0.5752    0.5746    0.5749      1014
	                weighted avg     0.8628    0.8619    0.8624      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.137, 0.137, 0.137, 0.982, 0.861
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.137, 0.982, 0.861
-----------------------------------------------------------------------------------------
Epoch   81: avg_loss: 0.15406657258669534 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9913809299468994 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 436  66]
	 [  0  67 443]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86507937 0.86862745]
	Accuracy = 0.8668639053254438
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8668    0.8651    0.8659       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8669      1014
	                   macro avg     0.5790    0.5779    0.5785      1014
	                weighted avg     0.8686    0.8669    0.8677      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.982, 0.865
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.982, 0.865
-----------------------------------------------------------------------------------------
Epoch   82: avg_loss: 0.15873478104670843 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9859663248062134 0.00046685340802987696 0.12745098039215685 0.12698412698412698

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 438  64]
	 [  0  65 445]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86904762 0.87254902]
	Accuracy = 0.8708086785009862
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8708    0.8690    0.8699       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8743    0.8725    0.8734       510
	
	                    accuracy                         0.8708      1014
	                   macro avg     0.5817    0.5805    0.5811      1014
	                weighted avg     0.8725    0.8708    0.8717      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.127, 0.127, 0.127, 0.984, 0.869
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.127, 0.984, 0.869
-----------------------------------------------------------------------------------------
Epoch   83: avg_loss: 0.15551185856262842 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9764904975891113 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 437  66]
	 [  0  67 443]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86706349 0.86862745]
	Accuracy = 0.8678500986193294
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8671    0.8671    0.8671       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8679      1014
	                   macro avg     0.5791    0.5786    0.5788      1014
	                weighted avg     0.8687    0.8679    0.8683      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.982, 0.867
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.982, 0.867
-----------------------------------------------------------------------------------------
Epoch   84: avg_loss: 0.1483828773101171 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9865791201591492 0.0004901960784313708 0.12549019607843137 0.125

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 440  63]
	 [  0  64 446]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.87301587 0.8745098 ]
	Accuracy = 0.873767258382643
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8730    0.8730    0.8730       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8762    0.8745    0.8754       510
	
	                    accuracy                         0.8738      1014
	                   macro avg     0.5831    0.5825    0.5828      1014
	                weighted avg     0.8746    0.8738    0.8742      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.125, 0.125, 0.125, 0.982, 0.873
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.125, 0.982, 0.873
-----------------------------------------------------------------------------------------
Epoch   85: avg_loss: 0.09615448862314224 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9888383746147156 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 437  66]
	 [  0  67 443]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86706349 0.86862745]
	Accuracy = 0.8678500986193294
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8671    0.8671    0.8671       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8679      1014
	                   macro avg     0.5791    0.5786    0.5788      1014
	                weighted avg     0.8687    0.8679    0.8683      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.988, 0.867
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.988, 0.867
-----------------------------------------------------------------------------------------
Epoch   86: avg_loss: 0.19332579771677652 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9812728762626648 0.0001400560224089631 0.15490196078431373 0.15476190476190477

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 425  78]
	 [  0  79 431]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.84325397 0.84509804]
	Accuracy = 0.8441814595660749
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8433    0.8433    0.8433       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8468    0.8451    0.8459       510
	
	                    accuracy                         0.8442      1014
	                   macro avg     0.5633    0.5628    0.5631      1014
	                weighted avg     0.8450    0.8442    0.8446      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.155, 0.155, 0.155, 0.986, 0.843
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.155, 0.986, 0.843
-----------------------------------------------------------------------------------------
Epoch   87: avg_loss: 0.19878657658894858 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9796969890594482 4.6685340802987696e-05 0.1627450980392157 0.1626984126984127

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 421  82]
	 [  0  83 427]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83531746 0.8372549 ]
	Accuracy = 0.8362919132149902
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8353    0.8353    0.8353       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8389    0.8373    0.8381       510
	
	                    accuracy                         0.8363      1014
	                   macro avg     0.5581    0.5575    0.5578      1014
	                weighted avg     0.8371    0.8363    0.8367      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.163, 0.163, 0.163, 0.986, 0.835
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.163, 0.986, 0.835
-----------------------------------------------------------------------------------------
Epoch   88: avg_loss: 0.0925522968173027 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9771544933319092 0.0003968253968253954 0.13333333333333333 0.13293650793650794

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 436  67]
	 [  0  68 442]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86507937 0.86666667]
	Accuracy = 0.8658777120315582
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8651    0.8651    0.8651       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8684    0.8667    0.8675       510
	
	                    accuracy                         0.8659      1014
	                   macro avg     0.5778    0.5772    0.5775      1014
	                weighted avg     0.8667    0.8659    0.8663      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.133, 0.133, 0.133, 0.986, 0.865
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.133, 0.986, 0.865
-----------------------------------------------------------------------------------------
Epoch   89: avg_loss: 0.18727405245105425 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9636801481246948 0.0005602240896358662 0.11960784313725491 0.11904761904761904

 ../data/dev/Period1.test
	Confusion Matrix
	 [444  60]
	 [ 61 449]
	Classwise Accuracies
	Labels
	[0.88095238 0.88039216]
	Accuracy = 0.8806706114398422
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8792    0.8810    0.8801       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8821    0.8804    0.8813       510
	
	                    accuracy                         0.8807      1014
	                   macro avg     0.8807    0.8807    0.8807      1014
	                weighted avg     0.8807    0.8807    0.8807      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.119, 0.120, 0.119, 0.990, 0.881
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.119, 0.990, 0.881
-----------------------------------------------------------------------------------------
Epoch   90: avg_loss: 0.17029241907099882 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9805312752723694 0.0004901960784313708 0.12549019607843137 0.125

 ../data/dev/Period1.test
	Confusion Matrix
	 [441  63]
	 [ 64 446]
	Classwise Accuracies
	Labels
	[0.875     0.8745098]
	Accuracy = 0.8747534516765286
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8733    0.8750    0.8741       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8762    0.8745    0.8754       510
	
	                    accuracy                         0.8748      1014
	                   macro avg     0.8747    0.8748    0.8748      1014
	                weighted avg     0.8748    0.8748    0.8748      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.125, 0.125, 0.125, 0.992, 0.875
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.125, 0.992, 0.875
-----------------------------------------------------------------------------------------
Epoch   91: avg_loss: 0.19917830576499304 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9844586849212646 0.0004901960784313708 0.12549019607843137 0.125

 ../data/dev/Period1.test
	Confusion Matrix
	 [441  63]
	 [ 64 446]
	Classwise Accuracies
	Labels
	[0.875     0.8745098]
	Accuracy = 0.8747534516765286
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8733    0.8750    0.8741       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8762    0.8745    0.8754       510
	
	                    accuracy                         0.8748      1014
	                   macro avg     0.8747    0.8748    0.8748      1014
	                weighted avg     0.8748    0.8748    0.8748      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.125, 0.125, 0.125, 0.990, 0.875
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.125, 0.990, 0.875
-----------------------------------------------------------------------------------------
Epoch   92: avg_loss: 0.1836204876502355 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9839434623718262 0.0004901960784313708 0.12549019607843137 0.125

 ../data/dev/Period1.test
	Confusion Matrix
	 [441  63]
	 [ 64 446]
	Classwise Accuracies
	Labels
	[0.875     0.8745098]
	Accuracy = 0.8747534516765286
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8733    0.8750    0.8741       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8762    0.8745    0.8754       510
	
	                    accuracy                         0.8748      1014
	                   macro avg     0.8747    0.8748    0.8748      1014
	                weighted avg     0.8748    0.8748    0.8748      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.125, 0.125, 0.125, 0.990, 0.875
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.125, 0.990, 0.875
-----------------------------------------------------------------------------------------
Epoch   93: avg_loss: 0.15903014689683914 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9841996431350708 0.0004435107376283831 0.12941176470588237 0.12896825396825398

 ../data/dev/Period1.test
	Confusion Matrix
	 [439  65]
	 [ 66 444]
	Classwise Accuracies
	Labels
	[0.87103175 0.87058824]
	Accuracy = 0.8708086785009862
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8693    0.8710    0.8702       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8723    0.8706    0.8714       510
	
	                    accuracy                         0.8708      1014
	                   macro avg     0.8708    0.8708    0.8708      1014
	                weighted avg     0.8708    0.8708    0.8708      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.129, 0.129, 0.129, 0.990, 0.871
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.129, 0.990, 0.871
-----------------------------------------------------------------------------------------
Epoch   94: avg_loss: 0.15491674095392227 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9760180711746216 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [438  66]
	 [ 67 443]
	Classwise Accuracies
	Labels
	[0.86904762 0.86862745]
	Accuracy = 0.868836291913215
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8673    0.8690    0.8682       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8688      1014
	                   macro avg     0.8688    0.8688    0.8688      1014
	                weighted avg     0.8688    0.8688    0.8688      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.986, 0.869
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.986, 0.869
-----------------------------------------------------------------------------------------
Epoch   95: avg_loss: 0.13709318389495215 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9733117818832397 0.00046685340802987696 0.12745098039215685 0.12698412698412698

 ../data/dev/Period1.test
	Confusion Matrix
	 [440  64]
	 [ 65 445]
	Classwise Accuracies
	Labels
	[0.87301587 0.87254902]
	Accuracy = 0.8727810650887574
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8713    0.8730    0.8722       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8743    0.8725    0.8734       510
	
	                    accuracy                         0.8728      1014
	                   macro avg     0.8728    0.8728    0.8728      1014
	                weighted avg     0.8728    0.8728    0.8728      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.127, 0.127, 0.127, 0.992, 0.873
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.127, 0.992, 0.873
-----------------------------------------------------------------------------------------
Epoch   96: avg_loss: 0.1957074347883463 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9723689556121826 0.0003968253968253954 0.13333333333333333 0.13293650793650794

 ../data/dev/Period1.test
	Confusion Matrix
	 [437  67]
	 [ 68 442]
	Classwise Accuracies
	Labels
	[0.86706349 0.86666667]
	Accuracy = 0.8668639053254438
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8653    0.8671    0.8662       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8684    0.8667    0.8675       510
	
	                    accuracy                         0.8669      1014
	                   macro avg     0.8669    0.8669    0.8669      1014
	                weighted avg     0.8669    0.8669    0.8669      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.133, 0.133, 0.133, 0.982, 0.867
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.133, 0.982, 0.867
-----------------------------------------------------------------------------------------
Epoch   97: avg_loss: 0.16148821078240871 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9851313829421997 0.0004435107376283831 0.12941176470588237 0.12896825396825398

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 437  65]
	 [  0  66 444]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86706349 0.87058824]
	Accuracy = 0.868836291913215
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8688    0.8671    0.8679       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8723    0.8706    0.8714       510
	
	                    accuracy                         0.8688      1014
	                   macro avg     0.5804    0.5792    0.5798      1014
	                weighted avg     0.8706    0.8688    0.8697      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.129, 0.129, 0.129, 0.982, 0.867
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.129, 0.982, 0.867
-----------------------------------------------------------------------------------------
Epoch   98: avg_loss: 0.1178339384496212 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.972440242767334 7.002801120448154e-05 0.1607843137254902 0.16071428571428573

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 422  81]
	 [  0  82 428]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83730159 0.83921569]
	Accuracy = 0.8382642998027613
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8373    0.8373    0.8373       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8409    0.8392    0.8400       510
	
	                    accuracy                         0.8383      1014
	                   macro avg     0.5594    0.5588    0.5591      1014
	                weighted avg     0.8391    0.8383    0.8387      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.161, 0.161, 0.161, 0.978, 0.837
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.161, 0.978, 0.837
-----------------------------------------------------------------------------------------
Epoch   99: avg_loss: 0.1366215298573176 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9781657457351685 0.00011671335200746924 0.1568627450980392 0.15674603174603174

 ../data/dev/Period1.test
	Confusion Matrix
	 [425  79]
	 [ 80 430]
	Classwise Accuracies
	Labels
	[0.84325397 0.84313725]
	Accuracy = 0.8431952662721893
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8416    0.8433    0.8424       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8448    0.8431    0.8440       510
	
	                    accuracy                         0.8432      1014
	                   macro avg     0.8432    0.8432    0.8432      1014
	                weighted avg     0.8432    0.8432    0.8432      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.157, 0.157, 0.157, 0.986, 0.843
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.157, 0.986, 0.843
-----------------------------------------------------------------------------------------
Epoch  100: avg_loss: 0.22112594296534857 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.984319269657135 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 427  76]
	 [  0  77 433]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.84722222 0.84901961]
	Accuracy = 0.8481262327416174
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8472    0.8472    0.8472       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8481      1014
	                   macro avg     0.5660    0.5654    0.5657      1014
	                weighted avg     0.8490    0.8481    0.8485      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.982, 0.847
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.982, 0.847
-----------------------------------------------------------------------------------------
Epoch  101: avg_loss: 0.11302369832992554 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9858952760696411 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [428  76]
	 [ 77 433]
	Classwise Accuracies
	Labels
	[0.84920635 0.84901961]
	Accuracy = 0.849112426035503
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8475    0.8492    0.8484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.8491    0.8491    0.8491      1014
	                weighted avg     0.8491    0.8491    0.8491      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.984, 0.849
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.984, 0.849
-----------------------------------------------------------------------------------------
Epoch  102: avg_loss: 0.11929501096407573 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9864720702171326 0.00011671335200746924 0.1568627450980392 0.15674603174603174

 ../data/dev/Period1.test
	Confusion Matrix
	 [425  79]
	 [ 80 430]
	Classwise Accuracies
	Labels
	[0.84325397 0.84313725]
	Accuracy = 0.8431952662721893
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8416    0.8433    0.8424       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8448    0.8431    0.8440       510
	
	                    accuracy                         0.8432      1014
	                   macro avg     0.8432    0.8432    0.8432      1014
	                weighted avg     0.8432    0.8432    0.8432      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.157, 0.157, 0.157, 0.986, 0.843
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.157, 0.986, 0.843
-----------------------------------------------------------------------------------------
Epoch  103: avg_loss: 0.18655508756637573 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9703031778335571 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [429  75]
	 [ 76 434]
	Classwise Accuracies
	Labels
	[0.85119048 0.85098039]
	Accuracy = 0.8510848126232742
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8495    0.8512    0.8503       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8511      1014
	                   macro avg     0.8511    0.8511    0.8511      1014
	                weighted avg     0.8511    0.8511    0.8511      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.984, 0.851
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.984, 0.851
-----------------------------------------------------------------------------------------
Epoch  104: avg_loss: 0.11091943333546321 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9714540243148804 0.0005602240896358662 0.11960784313725491 0.11904761904761904

 ../data/dev/Period1.test
	Confusion Matrix
	 [444  60]
	 [ 61 449]
	Classwise Accuracies
	Labels
	[0.88095238 0.88039216]
	Accuracy = 0.8806706114398422
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8792    0.8810    0.8801       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8821    0.8804    0.8813       510
	
	                    accuracy                         0.8807      1014
	                   macro avg     0.8807    0.8807    0.8807      1014
	                weighted avg     0.8807    0.8807    0.8807      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.119, 0.120, 0.119, 0.982, 0.881
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.119, 0.982, 0.881
-----------------------------------------------------------------------------------------
Epoch  105: avg_loss: 0.13371401404341063 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9782097935676575 0.00046685340802987696 0.12745098039215685 0.12698412698412698

 ../data/dev/Period1.test
	Confusion Matrix
	 [440  64]
	 [ 65 445]
	Classwise Accuracies
	Labels
	[0.87301587 0.87254902]
	Accuracy = 0.8727810650887574
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8713    0.8730    0.8722       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8743    0.8725    0.8734       510
	
	                    accuracy                         0.8728      1014
	                   macro avg     0.8728    0.8728    0.8728      1014
	                weighted avg     0.8728    0.8728    0.8728      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.127, 0.127, 0.127, 0.984, 0.873
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.127, 0.984, 0.873
-----------------------------------------------------------------------------------------
Epoch  106: avg_loss: 0.20107328643401465 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9885376691818237 0.00011671335200746924 0.1568627450980392 0.15674603174603174

 ../data/dev/Period1.test
	Confusion Matrix
	 [425  79]
	 [ 80 430]
	Classwise Accuracies
	Labels
	[0.84325397 0.84313725]
	Accuracy = 0.8431952662721893
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8416    0.8433    0.8424       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8448    0.8431    0.8440       510
	
	                    accuracy                         0.8432      1014
	                   macro avg     0.8432    0.8432    0.8432      1014
	                weighted avg     0.8432    0.8432    0.8432      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.157, 0.157, 0.157, 0.986, 0.843
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.157, 0.986, 0.843
-----------------------------------------------------------------------------------------
Epoch  107: avg_loss: 0.16808133572340012 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9905843734741211 0.00016339869281045694 0.15294117647058825 0.1527777777777778

 ../data/dev/Period1.test
	Confusion Matrix
	 [427  77]
	 [ 78 432]
	Classwise Accuracies
	Labels
	[0.84722222 0.84705882]
	Accuracy = 0.8471400394477318
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8455    0.8472    0.8464       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8487    0.8471    0.8479       510
	
	                    accuracy                         0.8471      1014
	                   macro avg     0.8471    0.8471    0.8471      1014
	                weighted avg     0.8471    0.8471    0.8471      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.153, 0.153, 0.153, 0.984, 0.847
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.153, 0.984, 0.847
-----------------------------------------------------------------------------------------
Epoch  108: avg_loss: 0.12413145105044048 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9910776615142822 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [428  76]
	 [ 77 433]
	Classwise Accuracies
	Labels
	[0.84920635 0.84901961]
	Accuracy = 0.849112426035503
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8475    0.8492    0.8484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.8491    0.8491    0.8491      1014
	                weighted avg     0.8491    0.8491    0.8491      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.980, 0.849
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.980, 0.849
-----------------------------------------------------------------------------------------
Epoch  109: avg_loss: 0.1437651813030243 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9837613105773926 7.002801120448154e-05 0.1607843137254902 0.16071428571428573

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 422  81]
	 [  1  81 428]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83730159 0.83921569]
	Accuracy = 0.8382642998027613
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8390    0.8373    0.8381       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8409    0.8392    0.8400       510
	
	                    accuracy                         0.8383      1014
	                   macro avg     0.5599    0.5588    0.5594      1014
	                weighted avg     0.8399    0.8383    0.8391      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.161, 0.161, 0.161, 0.970, 0.837
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.161, 0.970, 0.837
-----------------------------------------------------------------------------------------
Epoch  110: avg_loss: 0.15753675003846487 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9746452569961548 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  3 426  75]
	 [  9  67 434]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.8452381  0.85098039]
	Accuracy = 0.8481262327416174
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8641    0.8452    0.8546       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8481      1014
	                   macro avg     0.5722    0.5654    0.5688      1014
	                weighted avg     0.8583    0.8481    0.8532      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.966, 0.845
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.966, 0.845
-----------------------------------------------------------------------------------------
Epoch  111: avg_loss: 0.12910723810394606 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9857932329177856 0.0005135387488328785 0.12352941176470589 0.12301587301587301

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 441  62]
	 [  1  62 447]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.875      0.87647059]
	Accuracy = 0.8757396449704142
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8767    0.8750    0.8759       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8782    0.8765    0.8773       510
	
	                    accuracy                         0.8757      1014
	                   macro avg     0.5850    0.5838    0.5844      1014
	                weighted avg     0.8775    0.8757    0.8766      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.123, 0.124, 0.123, 0.974, 0.875
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.123, 0.974, 0.875
-----------------------------------------------------------------------------------------
Epoch  112: avg_loss: 0.13869370768467584 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9901328086853027 0.0005135387488328785 0.12352941176470589 0.12301587301587301

 ../data/dev/Period1.test
	Confusion Matrix
	 [442  62]
	 [ 63 447]
	Classwise Accuracies
	Labels
	[0.87698413 0.87647059]
	Accuracy = 0.8767258382642998
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8752    0.8770    0.8761       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8782    0.8765    0.8773       510
	
	                    accuracy                         0.8767      1014
	                   macro avg     0.8767    0.8767    0.8767      1014
	                weighted avg     0.8767    0.8767    0.8767      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.123, 0.124, 0.123, 0.976, 0.877
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.123, 0.976, 0.877
-----------------------------------------------------------------------------------------
Epoch  113: avg_loss: 0.16276823480923971 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9871224761009216 0.0003501400560224077 0.13725490196078433 0.13690476190476192

 ../data/dev/Period1.test
	Confusion Matrix
	 [435  69]
	 [ 70 440]
	Classwise Accuracies
	Labels
	[0.86309524 0.8627451 ]
	Accuracy = 0.8629191321499013
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8614    0.8631    0.8622       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8644    0.8627    0.8636       510
	
	                    accuracy                         0.8629      1014
	                   macro avg     0.8629    0.8629    0.8629      1014
	                weighted avg     0.8629    0.8629    0.8629      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.137, 0.137, 0.137, 0.978, 0.863
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.137, 0.978, 0.863
-----------------------------------------------------------------------------------------
Epoch  114: avg_loss: 0.1232074499130249 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.98260098695755 7.002801120448154e-05 0.1607843137254902 0.16071428571428573

 ../data/dev/Period1.test
	Confusion Matrix
	 [423  81]
	 [ 82 428]
	Classwise Accuracies
	Labels
	[0.83928571 0.83921569]
	Accuracy = 0.8392504930966469
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8376    0.8393    0.8385       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8409    0.8392    0.8400       510
	
	                    accuracy                         0.8393      1014
	                   macro avg     0.8392    0.8393    0.8392      1014
	                weighted avg     0.8393    0.8393    0.8393      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.161, 0.161, 0.161, 0.984, 0.839
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.161, 0.984, 0.839
-----------------------------------------------------------------------------------------
Epoch  115: avg_loss: 0.1231599288682143 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9815188646316528 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [429  75]
	 [ 76 434]
	Classwise Accuracies
	Labels
	[0.85119048 0.85098039]
	Accuracy = 0.8510848126232742
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8495    0.8512    0.8503       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8511      1014
	                   macro avg     0.8511    0.8511    0.8511      1014
	                weighted avg     0.8511    0.8511    0.8511      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.980, 0.851
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.980, 0.851
-----------------------------------------------------------------------------------------
Epoch  116: avg_loss: 0.0835830345749855 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9858179092407227 0.0003968253968253954 0.13333333333333333 0.13293650793650794

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 436  67]
	 [  0  68 442]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86507937 0.86666667]
	Accuracy = 0.8658777120315582
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8651    0.8651    0.8651       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8684    0.8667    0.8675       510
	
	                    accuracy                         0.8659      1014
	                   macro avg     0.5778    0.5772    0.5775      1014
	                weighted avg     0.8667    0.8659    0.8663      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.133, 0.133, 0.133, 0.976, 0.865
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.133, 0.976, 0.865
-----------------------------------------------------------------------------------------
Epoch  117: avg_loss: 0.14824723452329636 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9756804704666138 0.00016339869281045694 0.15294117647058825 0.1527777777777778

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 426  77]
	 [  1  77 432]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.8452381  0.84705882]
	Accuracy = 0.8461538461538461
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8469    0.8452    0.8461       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8487    0.8471    0.8479       510
	
	                    accuracy                         0.8462      1014
	                   macro avg     0.5652    0.5641    0.5647      1014
	                weighted avg     0.8478    0.8462    0.8470      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.153, 0.153, 0.153, 0.974, 0.845
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.153, 0.974, 0.845
-----------------------------------------------------------------------------------------
Epoch  118: avg_loss: 0.09309379880626996 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9701984524726868 0.00011671335200746924 0.1568627450980392 0.15674603174603174

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 423  79]
	 [  3  77 430]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83928571 0.84313725]
	Accuracy = 0.8412228796844181
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8460    0.8393    0.8426       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8448    0.8431    0.8440       510
	
	                    accuracy                         0.8412      1014
	                   macro avg     0.5636    0.5608    0.5622      1014
	                weighted avg     0.8454    0.8412    0.8433      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.157, 0.157, 0.157, 0.970, 0.839
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.157, 0.970, 0.839
-----------------------------------------------------------------------------------------
Epoch  119: avg_loss: 0.1463447151084741 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9780244827270508 0.00025676937441643233 0.1450980392156863 0.14484126984126985

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 430  73]
	 [  1  73 436]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.8531746  0.85490196]
	Accuracy = 0.854043392504931
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8549    0.8532    0.8540       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8566    0.8549    0.8557       510
	
	                    accuracy                         0.8540      1014
	                   macro avg     0.5705    0.5694    0.5699      1014
	                weighted avg     0.8557    0.8540    0.8549      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.145, 0.145, 0.145, 0.980, 0.853
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.145, 0.980, 0.853
-----------------------------------------------------------------------------------------
Epoch  120: avg_loss: 0.07910860826571782 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9684663414955139 0.00037348272642390157 0.13529411764705881 0.1349206349206349

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 435  68]
	 [  0  69 441]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86309524 0.86470588]
	Accuracy = 0.863905325443787
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8631    0.8631    0.8631       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8664    0.8647    0.8656       510
	
	                    accuracy                         0.8639      1014
	                   macro avg     0.5765    0.5759    0.5762      1014
	                weighted avg     0.8648    0.8639    0.8643      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.135, 0.135, 0.135, 0.982, 0.863
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.135, 0.982, 0.863
-----------------------------------------------------------------------------------------
Epoch  121: avg_loss: 0.07560483552515507 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9769043922424316 0.0005368814192343585 0.12156862745098039 0.12103174603174603

 ../data/dev/Period1.test
	Confusion Matrix
	 [443  61]
	 [ 62 448]
	Classwise Accuracies
	Labels
	[0.87896825 0.87843137]
	Accuracy = 0.878698224852071
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8772    0.8790    0.8781       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8802    0.8784    0.8793       510
	
	                    accuracy                         0.8787      1014
	                   macro avg     0.8787    0.8787    0.8787      1014
	                weighted avg     0.8787    0.8787    0.8787      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.121, 0.122, 0.121, 0.986, 0.879
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.121, 0.986, 0.879
-----------------------------------------------------------------------------------------
Epoch  122: avg_loss: 0.18883523593346277 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9864846467971802 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [438  66]
	 [ 67 443]
	Classwise Accuracies
	Labels
	[0.86904762 0.86862745]
	Accuracy = 0.868836291913215
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8673    0.8690    0.8682       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8688      1014
	                   macro avg     0.8688    0.8688    0.8688      1014
	                weighted avg     0.8688    0.8688    0.8688      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.992, 0.869
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.992, 0.869
-----------------------------------------------------------------------------------------
Epoch  123: avg_loss: 0.1759499584635099 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9872004985809326 0.0004435107376283831 0.12941176470588237 0.12896825396825398

 ../data/dev/Period1.test
	Confusion Matrix
	 [439  65]
	 [ 66 444]
	Classwise Accuracies
	Labels
	[0.87103175 0.87058824]
	Accuracy = 0.8708086785009862
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8693    0.8710    0.8702       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8723    0.8706    0.8714       510
	
	                    accuracy                         0.8708      1014
	                   macro avg     0.8708    0.8708    0.8708      1014
	                weighted avg     0.8708    0.8708    0.8708      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.129, 0.129, 0.129, 0.990, 0.871
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.129, 0.990, 0.871
-----------------------------------------------------------------------------------------
Epoch  124: avg_loss: 0.11855826030174892 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9823136329650879 0.0004901960784313708 0.12549019607843137 0.125

 ../data/dev/Period1.test
	Confusion Matrix
	 [441  63]
	 [ 64 446]
	Classwise Accuracies
	Labels
	[0.875     0.8745098]
	Accuracy = 0.8747534516765286
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8733    0.8750    0.8741       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8762    0.8745    0.8754       510
	
	                    accuracy                         0.8748      1014
	                   macro avg     0.8747    0.8748    0.8748      1014
	                weighted avg     0.8748    0.8748    0.8748      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.125, 0.125, 0.125, 0.986, 0.875
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.125, 0.986, 0.875
-----------------------------------------------------------------------------------------
Epoch  125: avg_loss: 0.1413609062631925 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9758223295211792 0.00046685340802987696 0.12745098039215685 0.12698412698412698

 ../data/dev/Period1.test
	Confusion Matrix
	 [440  64]
	 [ 65 445]
	Classwise Accuracies
	Labels
	[0.87301587 0.87254902]
	Accuracy = 0.8727810650887574
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8713    0.8730    0.8722       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8743    0.8725    0.8734       510
	
	                    accuracy                         0.8728      1014
	                   macro avg     0.8728    0.8728    0.8728      1014
	                weighted avg     0.8728    0.8728    0.8728      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.127, 0.127, 0.127, 0.988, 0.873
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.127, 0.988, 0.873
-----------------------------------------------------------------------------------------
Epoch  126: avg_loss: 0.09129490330815315 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.970241904258728 0.0004435107376283831 0.12941176470588237 0.12896825396825398

 ../data/dev/Period1.test
	Confusion Matrix
	 [439  65]
	 [ 66 444]
	Classwise Accuracies
	Labels
	[0.87103175 0.87058824]
	Accuracy = 0.8708086785009862
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8693    0.8710    0.8702       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8723    0.8706    0.8714       510
	
	                    accuracy                         0.8708      1014
	                   macro avg     0.8708    0.8708    0.8708      1014
	                weighted avg     0.8708    0.8708    0.8708      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.129, 0.129, 0.129, 0.988, 0.871
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.129, 0.988, 0.871
-----------------------------------------------------------------------------------------
Epoch  127: avg_loss: 0.10216876367727916 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9654186964035034 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [438  66]
	 [ 67 443]
	Classwise Accuracies
	Labels
	[0.86904762 0.86862745]
	Accuracy = 0.868836291913215
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8673    0.8690    0.8682       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8688      1014
	                   macro avg     0.8688    0.8688    0.8688      1014
	                weighted avg     0.8688    0.8688    0.8688      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.986, 0.869
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.986, 0.869
-----------------------------------------------------------------------------------------
Epoch  128: avg_loss: 0.09058896110703547 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9714148044586182 0.00032679738562091387 0.1392156862745098 0.1388888888888889

 ../data/dev/Period1.test
	Confusion Matrix
	 [434  70]
	 [ 71 439]
	Classwise Accuracies
	Labels
	[0.86111111 0.86078431]
	Accuracy = 0.8609467455621301
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8594    0.8611    0.8603       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8625    0.8608    0.8616       510
	
	                    accuracy                         0.8609      1014
	                   macro avg     0.8609    0.8609    0.8609      1014
	                weighted avg     0.8609    0.8609    0.8609      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.139, 0.139, 0.139, 0.988, 0.861
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.139, 0.988, 0.861
-----------------------------------------------------------------------------------------
Epoch  129: avg_loss: 0.15167217453320822 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9662021398544312 0.0003968253968253954 0.13333333333333333 0.13293650793650794

 ../data/dev/Period1.test
	Confusion Matrix
	 [437  67]
	 [ 68 442]
	Classwise Accuracies
	Labels
	[0.86706349 0.86666667]
	Accuracy = 0.8668639053254438
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8653    0.8671    0.8662       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8684    0.8667    0.8675       510
	
	                    accuracy                         0.8669      1014
	                   macro avg     0.8669    0.8669    0.8669      1014
	                weighted avg     0.8669    0.8669    0.8669      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.133, 0.133, 0.133, 0.982, 0.867
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.133, 0.982, 0.867
-----------------------------------------------------------------------------------------
Epoch  130: avg_loss: 0.05112629756331444 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9693495035171509 0.0005368814192343585 0.12156862745098039 0.12103174603174603

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 442  61]
	 [  0  62 448]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.87698413 0.87843137]
	Accuracy = 0.8777120315581854
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8770    0.8770    0.8770       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8802    0.8784    0.8793       510
	
	                    accuracy                         0.8777      1014
	                   macro avg     0.5857    0.5851    0.5854      1014
	                weighted avg     0.8786    0.8777    0.8781      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.121, 0.122, 0.121, 0.980, 0.877
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.121, 0.980, 0.877
-----------------------------------------------------------------------------------------
Epoch  131: avg_loss: 0.12340150773525238 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9421325325965881 0.00032679738562091387 0.1392156862745098 0.1388888888888889

 ../data/dev/Period1.test
	Confusion Matrix
	 [434  70]
	 [ 71 439]
	Classwise Accuracies
	Labels
	[0.86111111 0.86078431]
	Accuracy = 0.8609467455621301
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8594    0.8611    0.8603       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8625    0.8608    0.8616       510
	
	                    accuracy                         0.8609      1014
	                   macro avg     0.8609    0.8609    0.8609      1014
	                weighted avg     0.8609    0.8609    0.8609      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.139, 0.139, 0.139, 0.982, 0.861
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.139, 0.982, 0.861
-----------------------------------------------------------------------------------------
Epoch  132: avg_loss: 0.04201419154802958 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9659297466278076 0.00023342670401493848 0.14705882352941177 0.14682539682539683

 ../data/dev/Period1.test
	Confusion Matrix
	 [430  74]
	 [ 75 435]
	Classwise Accuracies
	Labels
	[0.8531746  0.85294118]
	Accuracy = 0.8530571992110454
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8515    0.8532    0.8523       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8546    0.8529    0.8538       510
	
	                    accuracy                         0.8531      1014
	                   macro avg     0.8531    0.8531    0.8531      1014
	                weighted avg     0.8531    0.8531    0.8531      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.147, 0.147, 0.147, 0.984, 0.853
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.147, 0.984, 0.853
-----------------------------------------------------------------------------------------
Epoch  133: avg_loss: 0.1325921689470609 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9743339419364929 0.0006302521008403339 0.11372549019607843 0.1130952380952381

 ../data/dev/Period1.test
	Confusion Matrix
	 [447  57]
	 [ 58 452]
	Classwise Accuracies
	Labels
	[0.88690476 0.88627451]
	Accuracy = 0.8865877712031558
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8851    0.8869    0.8860       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8880    0.8863    0.8871       510
	
	                    accuracy                         0.8866      1014
	                   macro avg     0.8866    0.8866    0.8866      1014
	                weighted avg     0.8866    0.8866    0.8866      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.113, 0.114, 0.113, 0.986, 0.887
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.113, 0.986, 0.887
-----------------------------------------------------------------------------------------
Epoch  134: avg_loss: 0.07051002979278564 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9833389520645142 0.0009337068160597678 0.08823529411764706 0.0873015873015873

 ../data/dev/Period1.test
	Confusion Matrix
	 [460  44]
	 [ 45 465]
	Classwise Accuracies
	Labels
	[0.91269841 0.91176471]
	Accuracy = 0.9122287968441815
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.9109    0.9127    0.9118       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.9136    0.9118    0.9127       510
	
	                    accuracy                         0.9122      1014
	                   macro avg     0.9122    0.9122    0.9122      1014
	                weighted avg     0.9122    0.9122    0.9122      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.088, 0.088, 0.087, 0.986, 0.913
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.088, 0.986, 0.913
-----------------------------------------------------------------------------------------
Epoch  135: avg_loss: 0.07588192448019981 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9652578830718994 0.0002801120448179262 0.14313725490196078 0.14285714285714285

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 431  72]
	 [  4  69 437]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.85515873 0.85686275]
	Accuracy = 0.8560157790927022
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8620    0.8552    0.8586       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8585    0.8569    0.8577       510
	
	                    accuracy                         0.8560      1014
	                   macro avg     0.5735    0.5707    0.5721      1014
	                weighted avg     0.8603    0.8560    0.8581      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.143, 0.143, 0.143, 0.984, 0.855
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.143, 0.984, 0.855
-----------------------------------------------------------------------------------------
Epoch  136: avg_loss: 0.10588591669996579 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9630600214004517 0.0003501400560224077 0.13725490196078433 0.13690476190476192

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 434  69]
	 [  4  66 440]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86111111 0.8627451 ]
	Accuracy = 0.8619329388560157
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8680    0.8611    0.8645       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8644    0.8627    0.8636       510
	
	                    accuracy                         0.8619      1014
	                   macro avg     0.5775    0.5746    0.5760      1014
	                weighted avg     0.8662    0.8619    0.8641      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.137, 0.137, 0.137, 0.984, 0.861
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.137, 0.984, 0.861
-----------------------------------------------------------------------------------------
Epoch  137: avg_loss: 0.11998057117064793 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9565504193305969 0.0005135387488328785 0.12352941176470589 0.12301587301587301

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 442  62]
	 [  3  60 447]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.87698413 0.87647059]
	Accuracy = 0.8767258382642998
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8805    0.8770    0.8787       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8782    0.8765    0.8773       510
	
	                    accuracy                         0.8767      1014
	                   macro avg     0.5862    0.5845    0.5854      1014
	                weighted avg     0.8793    0.8767    0.8780      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.123, 0.124, 0.123, 0.986, 0.877
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.123, 0.986, 0.877
-----------------------------------------------------------------------------------------
Epoch  138: avg_loss: 0.07023717400928338 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9690276384353638 0.0007236227824463093 0.10588235294117647 0.10515873015873016

 ../data/dev/Period1.test
	Confusion Matrix
	 [451  53]
	 [ 54 456]
	Classwise Accuracies
	Labels
	[0.89484127 0.89411765]
	Accuracy = 0.8944773175542406
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8931    0.8948    0.8940       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8959    0.8941    0.8950       510
	
	                    accuracy                         0.8945      1014
	                   macro avg     0.8945    0.8945    0.8945      1014
	                weighted avg     0.8945    0.8945    0.8945      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.106, 0.106, 0.105, 0.986, 0.895
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.106, 0.986, 0.895
-----------------------------------------------------------------------------------------
Epoch  139: avg_loss: 0.14523906509081522 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9712346792221069 0.0005602240896358662 0.11960784313725491 0.11904761904761904

 ../data/dev/Period1.test
	Confusion Matrix
	 [444  60]
	 [ 61 449]
	Classwise Accuracies
	Labels
	[0.88095238 0.88039216]
	Accuracy = 0.8806706114398422
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8792    0.8810    0.8801       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8821    0.8804    0.8813       510
	
	                    accuracy                         0.8807      1014
	                   macro avg     0.8807    0.8807    0.8807      1014
	                weighted avg     0.8807    0.8807    0.8807      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.119, 0.120, 0.119, 0.998, 0.881
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.119, 0.998, 0.881
-----------------------------------------------------------------------------------------
Epoch  140: avg_loss: 0.07172317057847977 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9745779633522034 0.0005135387488328785 0.12352941176470589 0.12301587301587301

 ../data/dev/Period1.test
	Confusion Matrix
	 [442  62]
	 [ 63 447]
	Classwise Accuracies
	Labels
	[0.87698413 0.87647059]
	Accuracy = 0.8767258382642998
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8752    0.8770    0.8761       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8782    0.8765    0.8773       510
	
	                    accuracy                         0.8767      1014
	                   macro avg     0.8767    0.8767    0.8767      1014
	                weighted avg     0.8767    0.8767    0.8767      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.123, 0.124, 0.123, 0.998, 0.877
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.123, 0.998, 0.877
-----------------------------------------------------------------------------------------
Epoch  141: avg_loss: 0.027625649546583492 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.95418781042099 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.992, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.992, 0.891
-----------------------------------------------------------------------------------------
Epoch  142: avg_loss: 0.12177992736299832 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9622769951820374 0.0006069094304388539 0.11568627450980393 0.11507936507936507

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 446  58]
	 [  7  52 451]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.88492063 0.88431373]
	Accuracy = 0.8846153846153846
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8956    0.8849    0.8902       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8861    0.8843    0.8852       510
	
	                    accuracy                         0.8846      1014
	                   macro avg     0.5939    0.5897    0.5918      1014
	                weighted avg     0.8908    0.8846    0.8877      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.115, 0.116, 0.115, 0.980, 0.885
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.115, 0.980, 0.885
-----------------------------------------------------------------------------------------
Epoch  143: avg_loss: 0.0937999760111173 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9685677289962769 7.002801120448154e-05 0.1607843137254902 0.16071428571428573

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  2 421  81]
	 [ 16  66 428]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.83531746 0.83921569]
	Accuracy = 0.8372781065088757
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8645    0.8353    0.8496       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8409    0.8392    0.8400       510
	
	                    accuracy                         0.8373      1014
	                   macro avg     0.5684    0.5582    0.5632      1014
	                weighted avg     0.8526    0.8373    0.8448      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.161, 0.161, 0.161, 0.980, 0.835
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.161, 0.980, 0.835
-----------------------------------------------------------------------------------------
Epoch  144: avg_loss: 0.1023695742090543 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9672331213951111 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  1 448  55]
	 [ 18  38 454]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.88888889 0.89019608]
	Accuracy = 0.8895463510848126
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.9218    0.8889    0.9051       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8895      1014
	                   macro avg     0.6046    0.5930    0.5987      1014
	                weighted avg     0.9068    0.8895    0.8980      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.982, 0.889
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.982, 0.889
-----------------------------------------------------------------------------------------
Epoch  145: avg_loss: 0.08019003768761952 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9532914161682129 0.0009337068160597678 0.08823529411764706 0.0873015873015873

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 460  44]
	 [  7  38 465]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.91269841 0.91176471]
	Accuracy = 0.9122287968441815
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.9237    0.9127    0.9182       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.9136    0.9118    0.9127       510
	
	                    accuracy                         0.9122      1014
	                   macro avg     0.6124    0.6082    0.6103      1014
	                weighted avg     0.9186    0.9122    0.9154      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.088, 0.088, 0.087, 0.986, 0.913
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.088, 0.986, 0.913
-----------------------------------------------------------------------------------------
Epoch  146: avg_loss: 0.05786576929191748 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9564442038536072 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.990, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.990, 0.891
-----------------------------------------------------------------------------------------
Epoch  147: avg_loss: 0.10122371340791385 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.974082350730896 0.0005602240896358662 0.11960784313725491 0.11904761904761904

 ../data/dev/Period1.test
	Confusion Matrix
	 [444  60]
	 [ 61 449]
	Classwise Accuracies
	Labels
	[0.88095238 0.88039216]
	Accuracy = 0.8806706114398422
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8792    0.8810    0.8801       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8821    0.8804    0.8813       510
	
	                    accuracy                         0.8807      1014
	                   macro avg     0.8807    0.8807    0.8807      1014
	                weighted avg     0.8807    0.8807    0.8807      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.119, 0.120, 0.119, 0.990, 0.881
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.119, 0.990, 0.881
-----------------------------------------------------------------------------------------
Epoch  148: avg_loss: 0.07714550321300824 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9755357503890991 0.0005835667600373462 0.11764705882352941 0.11706349206349206

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 445  59]
	 [  1  59 450]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.88293651 0.88235294]
	Accuracy = 0.8826429980276134
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8829    0.8829    0.8829       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8841    0.8824    0.8832       510
	
	                    accuracy                         0.8826      1014
	                   macro avg     0.5890    0.5884    0.5887      1014
	                weighted avg     0.8835    0.8826    0.8831      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.117, 0.118, 0.117, 0.992, 0.883
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.117, 0.992, 0.883
-----------------------------------------------------------------------------------------
Epoch  149: avg_loss: 0.15360155453284582 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9727001190185547 0.0007002801120448293 0.10784313725490197 0.10714285714285714

 ../data/dev/Period1.test
	Confusion Matrix
	 [450  54]
	 [ 55 455]
	Classwise Accuracies
	Labels
	[0.89285714 0.89215686]
	Accuracy = 0.8925049309664694
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8911    0.8929    0.8920       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8939    0.8922    0.8930       510
	
	                    accuracy                         0.8925      1014
	                   macro avg     0.8925    0.8925    0.8925      1014
	                weighted avg     0.8925    0.8925    0.8925      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.107, 0.108, 0.107, 0.992, 0.893
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.107, 0.992, 0.893
-----------------------------------------------------------------------------------------
Epoch  150: avg_loss: 0.13028660168250403 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.969049334526062 0.0007236227824463093 0.10588235294117647 0.10515873015873016

 ../data/dev/Period1.test
	Confusion Matrix
	 [451  53]
	 [ 54 456]
	Classwise Accuracies
	Labels
	[0.89484127 0.89411765]
	Accuracy = 0.8944773175542406
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8931    0.8948    0.8940       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8959    0.8941    0.8950       510
	
	                    accuracy                         0.8945      1014
	                   macro avg     0.8945    0.8945    0.8945      1014
	                weighted avg     0.8945    0.8945    0.8945      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.106, 0.106, 0.105, 0.992, 0.895
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.106, 0.992, 0.895
-----------------------------------------------------------------------------------------
Epoch  151: avg_loss: 0.082195150355498 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9627712965011597 0.0006535947712418416 0.11176470588235295 0.1111111111111111

 ../data/dev/Period1.test
	Confusion Matrix
	 [448  56]
	 [ 57 453]
	Classwise Accuracies
	Labels
	[0.88888889 0.88823529]
	Accuracy = 0.888560157790927
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8871    0.8889    0.8880       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8900    0.8882    0.8891       510
	
	                    accuracy                         0.8886      1014
	                   macro avg     0.8886    0.8886    0.8886      1014
	                weighted avg     0.8886    0.8886    0.8886      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.111, 0.112, 0.111, 0.996, 0.889
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.111, 0.996, 0.889
-----------------------------------------------------------------------------------------
Epoch  152: avg_loss: 0.09379063298304875 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9826627969741821 0.00046685340802987696 0.12745098039215685 0.12698412698412698

 ../data/dev/Period1.test
	Confusion Matrix
	 [440  64]
	 [ 65 445]
	Classwise Accuracies
	Labels
	[0.87301587 0.87254902]
	Accuracy = 0.8727810650887574
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8713    0.8730    0.8722       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8743    0.8725    0.8734       510
	
	                    accuracy                         0.8728      1014
	                   macro avg     0.8728    0.8728    0.8728      1014
	                weighted avg     0.8728    0.8728    0.8728      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.127, 0.127, 0.127, 0.988, 0.873
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.127, 0.988, 0.873
-----------------------------------------------------------------------------------------
Epoch  153: avg_loss: 0.08418556675314903 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9790921211242676 0.0005368814192343585 0.12156862745098039 0.12103174603174603

 ../data/dev/Period1.test
	Confusion Matrix
	 [443  61]
	 [ 62 448]
	Classwise Accuracies
	Labels
	[0.87896825 0.87843137]
	Accuracy = 0.878698224852071
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8772    0.8790    0.8781       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8802    0.8784    0.8793       510
	
	                    accuracy                         0.8787      1014
	                   macro avg     0.8787    0.8787    0.8787      1014
	                weighted avg     0.8787    0.8787    0.8787      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.121, 0.122, 0.121, 0.992, 0.879
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.121, 0.992, 0.879
-----------------------------------------------------------------------------------------
Epoch  154: avg_loss: 0.13739080478747687 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9727709293365479 0.0006302521008403339 0.11372549019607843 0.1130952380952381

 ../data/dev/Period1.test
	Confusion Matrix
	 [447  57]
	 [ 58 452]
	Classwise Accuracies
	Labels
	[0.88690476 0.88627451]
	Accuracy = 0.8865877712031558
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8851    0.8869    0.8860       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8880    0.8863    0.8871       510
	
	                    accuracy                         0.8866      1014
	                   macro avg     0.8866    0.8866    0.8866      1014
	                weighted avg     0.8866    0.8866    0.8866      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.113, 0.114, 0.113, 0.990, 0.887
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.113, 0.990, 0.887
-----------------------------------------------------------------------------------------
Epoch  155: avg_loss: 0.13450867931048074 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9712405204772949 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.988, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.988, 0.891
-----------------------------------------------------------------------------------------
Epoch  156: avg_loss: 0.14721849312384924 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9758090972900391 0.0007236227824463093 0.10588235294117647 0.10515873015873016

 ../data/dev/Period1.test
	Confusion Matrix
	 [451  53]
	 [ 54 456]
	Classwise Accuracies
	Labels
	[0.89484127 0.89411765]
	Accuracy = 0.8944773175542406
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8931    0.8948    0.8940       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8959    0.8941    0.8950       510
	
	                    accuracy                         0.8945      1014
	                   macro avg     0.8945    0.8945    0.8945      1014
	                weighted avg     0.8945    0.8945    0.8945      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.106, 0.106, 0.105, 0.992, 0.895
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.106, 0.992, 0.895
-----------------------------------------------------------------------------------------
Epoch  157: avg_loss: 0.11910161624352138 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9738479256629944 0.000746965452847817 0.10392156862745099 0.10317460317460317

 ../data/dev/Period1.test
	Confusion Matrix
	 [452  52]
	 [ 53 457]
	Classwise Accuracies
	Labels
	[0.8968254  0.89607843]
	Accuracy = 0.8964497041420119
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8950    0.8968    0.8959       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8978    0.8961    0.8970       510
	
	                    accuracy                         0.8964      1014
	                   macro avg     0.8964    0.8965    0.8964      1014
	                weighted avg     0.8965    0.8964    0.8965      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.104, 0.104, 0.103, 0.986, 0.897
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.104, 0.986, 0.897
-----------------------------------------------------------------------------------------
Epoch  158: avg_loss: 0.1310748259226481 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9814763069152832 0.0006069094304388539 0.11568627450980393 0.11507936507936507

 ../data/dev/Period1.test
	Confusion Matrix
	 [446  58]
	 [ 59 451]
	Classwise Accuracies
	Labels
	[0.88492063 0.88431373]
	Accuracy = 0.8846153846153846
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8832    0.8849    0.8840       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8861    0.8843    0.8852       510
	
	                    accuracy                         0.8846      1014
	                   macro avg     0.8846    0.8846    0.8846      1014
	                weighted avg     0.8846    0.8846    0.8846      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.115, 0.116, 0.115, 0.988, 0.885
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.115, 0.988, 0.885
-----------------------------------------------------------------------------------------
Epoch  159: avg_loss: 0.07147716358304024 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9862250089645386 0.0006302521008403339 0.11372549019607843 0.1130952380952381

 ../data/dev/Period1.test
	Confusion Matrix
	 [447  57]
	 [ 58 452]
	Classwise Accuracies
	Labels
	[0.88690476 0.88627451]
	Accuracy = 0.8865877712031558
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8851    0.8869    0.8860       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8880    0.8863    0.8871       510
	
	                    accuracy                         0.8866      1014
	                   macro avg     0.8866    0.8866    0.8866      1014
	                weighted avg     0.8866    0.8866    0.8866      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.113, 0.114, 0.113, 0.996, 0.887
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.113, 0.996, 0.887
-----------------------------------------------------------------------------------------
Epoch  160: avg_loss: 0.13418040921290716 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9850798845291138 0.0005835667600373462 0.11764705882352941 0.11706349206349206

 ../data/dev/Period1.test
	Confusion Matrix
	 [445  59]
	 [ 60 450]
	Classwise Accuracies
	Labels
	[0.88293651 0.88235294]
	Accuracy = 0.8826429980276134
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8812    0.8829    0.8821       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8841    0.8824    0.8832       510
	
	                    accuracy                         0.8826      1014
	                   macro avg     0.8826    0.8826    0.8826      1014
	                weighted avg     0.8826    0.8826    0.8826      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.117, 0.118, 0.117, 0.992, 0.883
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.117, 0.992, 0.883
-----------------------------------------------------------------------------------------
Epoch  161: avg_loss: 0.1160437638560931 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.980179488658905 0.0005368814192343585 0.12156862745098039 0.12103174603174603

 ../data/dev/Period1.test
	Confusion Matrix
	 [443  61]
	 [ 62 448]
	Classwise Accuracies
	Labels
	[0.87896825 0.87843137]
	Accuracy = 0.878698224852071
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8772    0.8790    0.8781       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8802    0.8784    0.8793       510
	
	                    accuracy                         0.8787      1014
	                   macro avg     0.8787    0.8787    0.8787      1014
	                weighted avg     0.8787    0.8787    0.8787      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.121, 0.122, 0.121, 0.986, 0.879
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.121, 0.986, 0.879
-----------------------------------------------------------------------------------------
Epoch  162: avg_loss: 0.11900625253717105 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9742803573608398 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 449  55]
	 [  1  55 454]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8909    0.8909    0.8909       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.5943    0.5937    0.5940      1014
	                weighted avg     0.8914    0.8905    0.8910      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.978, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.978, 0.891
-----------------------------------------------------------------------------------------
Epoch  163: avg_loss: 0.13034241398175558 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9517673850059509 0.0005835667600373462 0.11764705882352941 0.11706349206349206

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 445  59]
	 [  5  55 450]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.88293651 0.88235294]
	Accuracy = 0.8826429980276134
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8900    0.8829    0.8865       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8841    0.8824    0.8832       510
	
	                    accuracy                         0.8826      1014
	                   macro avg     0.5914    0.5884    0.5899      1014
	                weighted avg     0.8870    0.8826    0.8848      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.117, 0.118, 0.117, 0.978, 0.883
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.117, 0.978, 0.883
-----------------------------------------------------------------------------------------
Epoch  164: avg_loss: 0.0953364148736 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9595603346824646 0.0008403361344537924 0.09607843137254903 0.09523809523809523

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 456  48]
	 [  1  48 461]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.9047619  0.90392157]
	Accuracy = 0.9043392504930966
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.9048    0.9048    0.9048       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.9057    0.9039    0.9048       510
	
	                    accuracy                         0.9043      1014
	                   macro avg     0.6035    0.6029    0.6032      1014
	                weighted avg     0.9052    0.9043    0.9048      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.096, 0.096, 0.095, 0.982, 0.905
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.096, 0.982, 0.905
-----------------------------------------------------------------------------------------
Epoch  165: avg_loss: 0.12007282550136249 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9728389978408813 0.000770308123249297 0.10196078431372549 0.10119047619047619

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 453  51]
	 [  1  51 458]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89880952 0.89803922]
	Accuracy = 0.8984220907297831
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8988    0.8988    0.8988       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8998    0.8980    0.8989       510
	
	                    accuracy                         0.8984      1014
	                   macro avg     0.5995    0.5989    0.5992      1014
	                weighted avg     0.8993    0.8984    0.8989      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.102, 0.102, 0.101, 0.984, 0.899
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.102, 0.984, 0.899
-----------------------------------------------------------------------------------------
Epoch  166: avg_loss: 0.07658314270277818 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9756966233253479 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 449  55]
	 [  1  55 454]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8909    0.8909    0.8909       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.5943    0.5937    0.5940      1014
	                weighted avg     0.8914    0.8905    0.8910      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.990, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.990, 0.891
-----------------------------------------------------------------------------------------
Epoch  167: avg_loss: 0.09173807579403122 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9768345355987549 0.0006535947712418416 0.11176470588235295 0.1111111111111111

 ../data/dev/Period1.test
	Confusion Matrix
	 [448  56]
	 [ 57 453]
	Classwise Accuracies
	Labels
	[0.88888889 0.88823529]
	Accuracy = 0.888560157790927
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8871    0.8889    0.8880       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8900    0.8882    0.8891       510
	
	                    accuracy                         0.8886      1014
	                   macro avg     0.8886    0.8886    0.8886      1014
	                weighted avg     0.8886    0.8886    0.8886      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.111, 0.112, 0.111, 0.994, 0.889
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.111, 0.994, 0.889
-----------------------------------------------------------------------------------------
Epoch  168: avg_loss: 0.10124050825834274 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9812614321708679 0.0006302521008403339 0.11372549019607843 0.1130952380952381

 ../data/dev/Period1.test
	Confusion Matrix
	 [447  57]
	 [ 58 452]
	Classwise Accuracies
	Labels
	[0.88690476 0.88627451]
	Accuracy = 0.8865877712031558
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8851    0.8869    0.8860       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8880    0.8863    0.8871       510
	
	                    accuracy                         0.8866      1014
	                   macro avg     0.8866    0.8866    0.8866      1014
	                weighted avg     0.8866    0.8866    0.8866      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.113, 0.114, 0.113, 0.994, 0.887
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.113, 0.994, 0.887
-----------------------------------------------------------------------------------------
Epoch  169: avg_loss: 0.15940899401903152 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9759522080421448 0.0006535947712418416 0.11176470588235295 0.1111111111111111

 ../data/dev/Period1.test
	Confusion Matrix
	 [448  56]
	 [ 57 453]
	Classwise Accuracies
	Labels
	[0.88888889 0.88823529]
	Accuracy = 0.888560157790927
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8871    0.8889    0.8880       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8900    0.8882    0.8891       510
	
	                    accuracy                         0.8886      1014
	                   macro avg     0.8886    0.8886    0.8886      1014
	                weighted avg     0.8886    0.8886    0.8886      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.111, 0.112, 0.111, 0.994, 0.889
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.111, 0.994, 0.889
-----------------------------------------------------------------------------------------
Epoch  170: avg_loss: 0.02754259357849757 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9719641804695129 0.000746965452847817 0.10392156862745099 0.10317460317460317

 ../data/dev/Period1.test
	Confusion Matrix
	 [452  52]
	 [ 53 457]
	Classwise Accuracies
	Labels
	[0.8968254  0.89607843]
	Accuracy = 0.8964497041420119
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8950    0.8968    0.8959       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8978    0.8961    0.8970       510
	
	                    accuracy                         0.8964      1014
	                   macro avg     0.8964    0.8965    0.8964      1014
	                weighted avg     0.8965    0.8964    0.8965      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.104, 0.104, 0.103, 0.994, 0.897
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.104, 0.994, 0.897
-----------------------------------------------------------------------------------------
Epoch  171: avg_loss: 0.07608314106861751 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9606055617332458 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.990, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.990, 0.891
-----------------------------------------------------------------------------------------
Epoch  172: avg_loss: 0.14799052849411964 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9619985818862915 0.000770308123249297 0.10196078431372549 0.10119047619047619

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 453  51]
	 [  9  43 458]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89880952 0.89803922]
	Accuracy = 0.8984220907297831
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.9133    0.8988    0.9060       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8998    0.8980    0.8989       510
	
	                    accuracy                         0.8984      1014
	                   macro avg     0.6044    0.5989    0.6016      1014
	                weighted avg     0.9065    0.8984    0.9024      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.102, 0.102, 0.101, 0.982, 0.899
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.102, 0.982, 0.899
-----------------------------------------------------------------------------------------
Epoch  173: avg_loss: 0.07187310109535854 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9739001989364624 0.000770308123249297 0.10196078431372549 0.10119047619047619

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 453  51]
	 [  3  49 458]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89880952 0.89803922]
	Accuracy = 0.8984220907297831
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	                  GetWeather     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.9024    0.8988    0.9006       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8998    0.8980    0.8989       510
	
	                    accuracy                         0.8984      1014
	                   macro avg     0.6007    0.5989    0.5998      1014
	                weighted avg     0.9011    0.8984    0.8998      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.102, 0.102, 0.101, 0.984, 0.899
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.102, 0.984, 0.899
-----------------------------------------------------------------------------------------
Epoch  174: avg_loss: 0.08856705948710442 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9775917530059814 0.0002801120448179262 0.14313725490196078 0.14285714285714285

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 432  72]
	 [  1  72 437]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.85714286 0.85686275]
	Accuracy = 0.8570019723865878
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8571    0.8571    0.8571       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8585    0.8569    0.8577       510
	
	                    accuracy                         0.8570      1014
	                   macro avg     0.5719    0.5713    0.5716      1014
	                weighted avg     0.8578    0.8570    0.8574      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.143, 0.143, 0.143, 0.982, 0.857
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.143, 0.982, 0.857
-----------------------------------------------------------------------------------------
Epoch  175: avg_loss: 0.09397779901822408 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9818418025970459 0.00042016806722688926 0.13137254901960785 0.13095238095238096

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 438  66]
	 [  1  66 443]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.86904762 0.86862745]
	Accuracy = 0.868836291913215
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8690    0.8690    0.8690       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8703    0.8686    0.8695       510
	
	                    accuracy                         0.8688      1014
	                   macro avg     0.5798    0.5792    0.5795      1014
	                weighted avg     0.8697    0.8688    0.8693      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.131, 0.131, 0.131, 0.984, 0.869
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.131, 0.984, 0.869
-----------------------------------------------------------------------------------------
Epoch  176: avg_loss: 0.12012472997109096 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9923302531242371 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.986, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.986, 0.891
-----------------------------------------------------------------------------------------
Epoch  177: avg_loss: 0.22322625666856766 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9951121807098389 0.0007002801120448293 0.10784313725490197 0.10714285714285714

 ../data/dev/Period1.test
	Confusion Matrix
	 [450  54]
	 [ 55 455]
	Classwise Accuracies
	Labels
	[0.89285714 0.89215686]
	Accuracy = 0.8925049309664694
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8911    0.8929    0.8920       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8939    0.8922    0.8930       510
	
	                    accuracy                         0.8925      1014
	                   macro avg     0.8925    0.8925    0.8925      1014
	                weighted avg     0.8925    0.8925    0.8925      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.107, 0.108, 0.107, 0.988, 0.893
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.107, 0.988, 0.893
-----------------------------------------------------------------------------------------
Epoch  178: avg_loss: 0.19430240988731384 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9925048351287842 0.0004901960784313708 0.12549019607843137 0.125

 ../data/dev/Period1.test
	Confusion Matrix
	 [441  63]
	 [ 64 446]
	Classwise Accuracies
	Labels
	[0.875     0.8745098]
	Accuracy = 0.8747534516765286
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8733    0.8750    0.8741       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8762    0.8745    0.8754       510
	
	                    accuracy                         0.8748      1014
	                   macro avg     0.8747    0.8748    0.8748      1014
	                weighted avg     0.8748    0.8748    0.8748      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.125, 0.125, 0.125, 0.988, 0.875
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.125, 0.988, 0.875
-----------------------------------------------------------------------------------------
Epoch  179: avg_loss: 0.08761516213417053 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9926952123641968 0.00032679738562091387 0.1392156862745098 0.1388888888888889

 ../data/dev/Period1.test
	Confusion Matrix
	 [434  70]
	 [ 71 439]
	Classwise Accuracies
	Labels
	[0.86111111 0.86078431]
	Accuracy = 0.8609467455621301
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8594    0.8611    0.8603       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8625    0.8608    0.8616       510
	
	                    accuracy                         0.8609      1014
	                   macro avg     0.8609    0.8609    0.8609      1014
	                weighted avg     0.8609    0.8609    0.8609      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.139, 0.139, 0.139, 0.992, 0.861
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.139, 0.992, 0.861
-----------------------------------------------------------------------------------------
Epoch  180: avg_loss: 0.07609845573703448 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9918780326843262 0.0003501400560224077 0.13725490196078433 0.13690476190476192

 ../data/dev/Period1.test
	Confusion Matrix
	 [435  69]
	 [ 70 440]
	Classwise Accuracies
	Labels
	[0.86309524 0.8627451 ]
	Accuracy = 0.8629191321499013
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8614    0.8631    0.8622       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8644    0.8627    0.8636       510
	
	                    accuracy                         0.8629      1014
	                   macro avg     0.8629    0.8629    0.8629      1014
	                weighted avg     0.8629    0.8629    0.8629      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.137, 0.137, 0.137, 1.000, 0.863
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.137, 1.000, 0.863
-----------------------------------------------------------------------------------------
Epoch  181: avg_loss: 0.11384905378023784 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9912829399108887 0.00021008403361344463 0.14901960784313725 0.1488095238095238

 ../data/dev/Period1.test
	Confusion Matrix
	 [429  75]
	 [ 76 434]
	Classwise Accuracies
	Labels
	[0.85119048 0.85098039]
	Accuracy = 0.8510848126232742
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8495    0.8512    0.8503       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8527    0.8510    0.8518       510
	
	                    accuracy                         0.8511      1014
	                   macro avg     0.8511    0.8511    0.8511      1014
	                weighted avg     0.8511    0.8511    0.8511      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.149, 0.149, 0.149, 0.990, 0.851
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.149, 0.990, 0.851
-----------------------------------------------------------------------------------------
Epoch  182: avg_loss: 0.07749659816424052 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9933031797409058 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [428  76]
	 [ 77 433]
	Classwise Accuracies
	Labels
	[0.84920635 0.84901961]
	Accuracy = 0.849112426035503
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8475    0.8492    0.8484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.8491    0.8491    0.8491      1014
	                weighted avg     0.8491    0.8491    0.8491      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.986, 0.849
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.986, 0.849
-----------------------------------------------------------------------------------------
Epoch  183: avg_loss: 0.11549848690629005 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9888083934783936 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [428  76]
	 [ 77 433]
	Classwise Accuracies
	Labels
	[0.84920635 0.84901961]
	Accuracy = 0.849112426035503
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8475    0.8492    0.8484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.8491    0.8491    0.8491      1014
	                weighted avg     0.8491    0.8491    0.8491      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.984, 0.849
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.984, 0.849
-----------------------------------------------------------------------------------------
Epoch  184: avg_loss: 0.11995992064476013 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9858651161193848 0.00018674136321195078 0.15098039215686274 0.15079365079365079

 ../data/dev/Period1.test
	Confusion Matrix
	 [428  76]
	 [ 77 433]
	Classwise Accuracies
	Labels
	[0.84920635 0.84901961]
	Accuracy = 0.849112426035503
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8475    0.8492    0.8484       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8507    0.8490    0.8499       510
	
	                    accuracy                         0.8491      1014
	                   macro avg     0.8491    0.8491    0.8491      1014
	                weighted avg     0.8491    0.8491    0.8491      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.151, 0.151, 0.151, 0.988, 0.849
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.151, 0.988, 0.849
-----------------------------------------------------------------------------------------
Epoch  185: avg_loss: 0.08813951909542084 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9832772016525269 0.00037348272642390157 0.13529411764705881 0.1349206349206349

 ../data/dev/Period1.test
	Confusion Matrix
	 [436  68]
	 [ 69 441]
	Classwise Accuracies
	Labels
	[0.86507937 0.86470588]
	Accuracy = 0.8648915187376726
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8634    0.8651    0.8642       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8664    0.8647    0.8656       510
	
	                    accuracy                         0.8649      1014
	                   macro avg     0.8649    0.8649    0.8649      1014
	                weighted avg     0.8649    0.8649    0.8649      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.135, 0.135, 0.135, 0.988, 0.865
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.135, 0.988, 0.865
-----------------------------------------------------------------------------------------
Epoch  186: avg_loss: 0.06332770463389654 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9862250089645386 0.0007002801120448293 0.10784313725490197 0.10714285714285714

 ../data/dev/Period1.test
	Confusion Matrix
	 [450  54]
	 [ 55 455]
	Classwise Accuracies
	Labels
	[0.89285714 0.89215686]
	Accuracy = 0.8925049309664694
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8911    0.8929    0.8920       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8939    0.8922    0.8930       510
	
	                    accuracy                         0.8925      1014
	                   macro avg     0.8925    0.8925    0.8925      1014
	                weighted avg     0.8925    0.8925    0.8925      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.107, 0.108, 0.107, 0.988, 0.893
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.107, 0.988, 0.893
-----------------------------------------------------------------------------------------
Epoch  187: avg_loss: 0.16427816054783762 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9820447564125061 0.0006069094304388539 0.11568627450980393 0.11507936507936507

 ../data/dev/Period1.test
	Confusion Matrix
	 [446  58]
	 [ 59 451]
	Classwise Accuracies
	Labels
	[0.88492063 0.88431373]
	Accuracy = 0.8846153846153846
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8832    0.8849    0.8840       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8861    0.8843    0.8852       510
	
	                    accuracy                         0.8846      1014
	                   macro avg     0.8846    0.8846    0.8846      1014
	                weighted avg     0.8846    0.8846    0.8846      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.115, 0.116, 0.115, 0.990, 0.885
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.115, 0.990, 0.885
-----------------------------------------------------------------------------------------
Epoch  188: avg_loss: 0.0896642009417216 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9816302061080933 0.0006069094304388539 0.11568627450980393 0.11507936507936507

 ../data/dev/Period1.test
	Confusion Matrix
	 [446  58]
	 [ 59 451]
	Classwise Accuracies
	Labels
	[0.88492063 0.88431373]
	Accuracy = 0.8846153846153846
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8832    0.8849    0.8840       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8861    0.8843    0.8852       510
	
	                    accuracy                         0.8846      1014
	                   macro avg     0.8846    0.8846    0.8846      1014
	                weighted avg     0.8846    0.8846    0.8846      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.115, 0.116, 0.115, 0.984, 0.885
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.115, 0.984, 0.885
-----------------------------------------------------------------------------------------
Epoch  189: avg_loss: 0.1713977555433909 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9801544547080994 0.0006069094304388539 0.11568627450980393 0.11507936507936507

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 446  58]
	 [  1  58 451]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.88492063 0.88431373]
	Accuracy = 0.8846153846153846
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8849    0.8849    0.8849       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8861    0.8843    0.8852       510
	
	                    accuracy                         0.8846      1014
	                   macro avg     0.5903    0.5897    0.5900      1014
	                weighted avg     0.8855    0.8846    0.8851      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.115, 0.116, 0.115, 0.986, 0.885
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.115, 0.986, 0.885
-----------------------------------------------------------------------------------------
Epoch  190: avg_loss: 0.172055808827281 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9764328598976135 0.0006069094304388539 0.11568627450980393 0.11507936507936507

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 446  58]
	 [  2  57 451]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.88492063 0.88431373]
	Accuracy = 0.8846153846153846
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8867    0.8849    0.8858       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8861    0.8843    0.8852       510
	
	                    accuracy                         0.8846      1014
	                   macro avg     0.5909    0.5897    0.5903      1014
	                weighted avg     0.8864    0.8846    0.8855      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.115, 0.116, 0.115, 0.988, 0.885
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.115, 0.988, 0.885
-----------------------------------------------------------------------------------------
Epoch  191: avg_loss: 0.04162620070079962 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9822595119476318 0.000770308123249297 0.10196078431372549 0.10119047619047619

 ../data/dev/Period1.test
	Confusion Matrix
	 [453  51]
	 [ 52 458]
	Classwise Accuracies
	Labels
	[0.89880952 0.89803922]
	Accuracy = 0.8984220907297831
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8970    0.8988    0.8979       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8998    0.8980    0.8989       510
	
	                    accuracy                         0.8984      1014
	                   macro avg     0.8984    0.8984    0.8984      1014
	                weighted avg     0.8984    0.8984    0.8984      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.102, 0.102, 0.101, 0.992, 0.899
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.102, 0.992, 0.899
-----------------------------------------------------------------------------------------
Epoch  192: avg_loss: 0.10279521842797597 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9798889756202698 0.0008169934640522847 0.09803921568627451 0.09722222222222222

 ../data/dev/Period1.test
	Confusion Matrix
	 [455  49]
	 [ 50 460]
	Classwise Accuracies
	Labels
	[0.90277778 0.90196078]
	Accuracy = 0.9023668639053254
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.9010    0.9028    0.9019       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.9037    0.9020    0.9028       510
	
	                    accuracy                         0.9024      1014
	                   macro avg     0.9024    0.9024    0.9024      1014
	                weighted avg     0.9024    0.9024    0.9024      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.098, 0.098, 0.097, 0.994, 0.903
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.098, 0.994, 0.903
-----------------------------------------------------------------------------------------
Epoch  193: avg_loss: 0.05280307432015737 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9732532501220703 0.0008169934640522847 0.09803921568627451 0.09722222222222222

 ../data/dev/Period1.test
	Confusion Matrix
	 [455  49]
	 [ 50 460]
	Classwise Accuracies
	Labels
	[0.90277778 0.90196078]
	Accuracy = 0.9023668639053254
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.9010    0.9028    0.9019       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.9037    0.9020    0.9028       510
	
	                    accuracy                         0.9024      1014
	                   macro avg     0.9024    0.9024    0.9024      1014
	                weighted avg     0.9024    0.9024    0.9024      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.098, 0.098, 0.097, 0.990, 0.903
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.098, 0.990, 0.903
-----------------------------------------------------------------------------------------
Epoch  194: avg_loss: 0.013899407039086023 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.980221688747406 0.0007236227824463093 0.10588235294117647 0.10515873015873016

 ../data/dev/Period1.test
	Confusion Matrix
	 [451  53]
	 [ 54 456]
	Classwise Accuracies
	Labels
	[0.89484127 0.89411765]
	Accuracy = 0.8944773175542406
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8931    0.8948    0.8940       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8959    0.8941    0.8950       510
	
	                    accuracy                         0.8945      1014
	                   macro avg     0.8945    0.8945    0.8945      1014
	                weighted avg     0.8945    0.8945    0.8945      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.106, 0.106, 0.105, 0.988, 0.895
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.106, 0.988, 0.895
-----------------------------------------------------------------------------------------
Epoch  195: avg_loss: 0.09510010480880737 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9848473072052002 0.0007002801120448293 0.10784313725490197 0.10714285714285714

 ../data/dev/Period1.test
	Confusion Matrix
	 [450  54]
	 [ 55 455]
	Classwise Accuracies
	Labels
	[0.89285714 0.89215686]
	Accuracy = 0.8925049309664694
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8911    0.8929    0.8920       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8939    0.8922    0.8930       510
	
	                    accuracy                         0.8925      1014
	                   macro avg     0.8925    0.8925    0.8925      1014
	                weighted avg     0.8925    0.8925    0.8925      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.107, 0.108, 0.107, 0.988, 0.893
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.107, 0.988, 0.893
-----------------------------------------------------------------------------------------
Epoch  196: avg_loss: 0.1457278529802958 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9790506362915039 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.990, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.990, 0.891
-----------------------------------------------------------------------------------------
Epoch  197: avg_loss: 0.10063264022270839 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9665969610214233 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.988, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.988, 0.891
-----------------------------------------------------------------------------------------
Epoch  198: avg_loss: 0.19466632107893625 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9685161113739014 0.0006769374416433216 0.10980392156862745 0.10912698412698413

 ../data/dev/Period1.test
	Confusion Matrix
	 [449  55]
	 [ 56 454]
	Classwise Accuracies
	Labels
	[0.89087302 0.89019608]
	Accuracy = 0.8905325443786982
	                              precision    recall  f1-score   support
	
	        SearchScreeningEvent     0.8891    0.8909    0.8900       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8919    0.8902    0.8911       510
	
	                    accuracy                         0.8905      1014
	                   macro avg     0.8905    0.8905    0.8905      1014
	                weighted avg     0.8905    0.8905    0.8905      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.109, 0.110, 0.109, 0.988, 0.891
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.109, 0.988, 0.891
-----------------------------------------------------------------------------------------
Epoch  199: avg_loss: 0.07129414131244023 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9800093770027161 0.0007002801120448293 0.10784313725490197 0.10714285714285714

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 450  54]
	 [  1  54 455]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89285714 0.89215686]
	Accuracy = 0.8925049309664694
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8929    0.8929    0.8929       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8939    0.8922    0.8930       510
	
	                    accuracy                         0.8925      1014
	                   macro avg     0.5956    0.5950    0.5953      1014
	                weighted avg     0.8934    0.8925    0.8929      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.107, 0.108, 0.107, 0.984, 0.893
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.107, 0.984, 0.893
-----------------------------------------------------------------------------------------
Epoch  200: avg_loss: 0.1256643459200859 17743
---------------------------------------- Testing ----------------------------------------

test_workspace.labels_in_train 3
avg_representations.shape (1, 3, 200)
Testing:  ../data/dev/Period1.train
Testing:  ../data/dev/Period1.test
Testing:  ../data/dev/Period1.test

offsize, insize 510 504
bestT, bestV, bestFAR, bestFRR 0.9843093752861023 0.0007002801120448293 0.10784313725490197 0.10714285714285714

 ../data/dev/Period1.test
	Confusion Matrix
	 [0 0 0]
	 [  0 450  54]
	 [  1  54 455]
/home/raghab-ankan/code/stream/OOD_IBM/src/utils.py:140: RuntimeWarning: invalid value encountered in true_divide
  classwise_accuracy = (cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]).diagonal()
	Classwise Accuracies
	Labels
	[       nan 0.89285714 0.89215686]
	Accuracy = 0.8925049309664694
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/raghab-ankan/miniconda3/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	                              precision    recall  f1-score   support
	
	          SearchCreativeWork     0.0000    0.0000    0.0000         0
	        SearchScreeningEvent     0.8929    0.8929    0.8929       504
	UNCONFIDENT_INTENT_FROM_SLAD     0.8939    0.8922    0.8930       510
	
	                    accuracy                         0.8925      1014
	                   macro avg     0.5956    0.5950    0.5953      1014
	                weighted avg     0.8934    0.8925    0.8929      1014
	
test(eer, far, frr, ontopic_acc_ideal, ontopic_acc) 0.107, 0.108, 0.107, 0.984, 0.893
Meta-Valid Macro(eer, onacc_ideal, onacc): 0.107, 0.984, 0.893
-----------------------------------------------------------------------------------------
=====Training Finished======
